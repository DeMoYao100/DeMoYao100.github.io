
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
        <title>CrackCtf | Moyao の小屋</title>
        <meta name="author" content="Moyao">
        <meta name="description" content="Write down something interesting I met">
        <meta name="keywords" content="">
        <link rel="icon" href="/images/TEIO.jpg">
        <script src="https://cdn.staticfile.org/instant.page/5.1.0/instantpage.min.js" type="module"></script>
        <script src="https://cdn.staticfile.org/font-awesome/6.1.1/js/all.min.js"></script>
        
        <link rel="stylesheet" href="/css/fonts.min.css">
        <link rel="stylesheet" href="/css/particlex.css">
        
        <script src="https://cdn.staticfile.org/vue/3.2.33/vue.global.prod.min.js"></script>
    <meta name="generator" content="Hexo 6.2.0"></head>
    <body>
        <div id="loading" style="height:100vh;width:100vw;position:fixed;display:flex;z-index:200;justify-content:space-between;background:#fff;transition:opacity 0.3s ease-out"><div style="position:fixed;height:100vh;width:100vw;display:flex;justify-content:center;align-items:center"><div id="loadcontent" style="width:50vmin;height:50vmin;padding:50px;border-radius:50%;display:flex;justify-content:center;align-items:center;border:solid 10px #a3ddfb;text-align:center"><div><h2>LOADING...</h2><p style="word-break:keep-all">加载过慢请开启缓存(浏览器默认开启)</p><div><img alt="loading" src="/loading.gif"></div></div></div></div></div>
        <div id="layout">
            <i data-fa-symbol="calendar-solid" class="fa-solid fa-calendar fa-fw"></i>
            <i data-fa-symbol="bookmark-solid" class="fa-solid fa-bookmark fa-fw"></i>
            <i data-fa-symbol="tags-solid" class="fa-solid fa-tags fa-fw"></i>
            <transition name="into">
                <div v-show="show_page" style="display: -not-none">
                    <div id="menu_show">
                         
<nav id="menu">
    <div class="desktop-menu">
        <a href="/">
            <span class="title">Moyao の小屋</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;about</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;categories</span>
        </a>
        
        <a href="/\tags.md">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;tags</span>
        </a>
        
    </div>
    <div :class="'phone-menu ' + menu_show" id="phone-menu">
        <div class="curtain" @click="menu_show = !menu_show" v-show="menu_show"></div>
        <div :class="'title'" @click="menu_show = !menu_show">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;Moyao の小屋</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="menu_show">
            
            <a href="">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">home</div>
                </div>
            </a>
            
            <a href="about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">about</div>
                </div>
            </a>
            
            <a href="archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">archives</div>
                </div>
            </a>
            
            <a href="categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">categories</div>
                </div>
            </a>
            
            <a href="\tags.md">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">tags</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>
                    </div>
                    <div id="main">
                        
<div class="article">
    <div>
        <h1>CrackCtf </h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <svg class="fa-icon"><use xlink:href="#calendar-solid"></use></svg>
            </span>
            2022/9/10
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <svg class="fa-icon"><use xlink:href="#tags-solid"></use></svg>
            </span>
            
            <span class="tag">
                
                <a href="/tags/ctf/" style="color: #00a596">
                    ctf
                </a>
            </span>
            
            <span class="tag">
                
                <a href="/tags/reverse/" style="color: #00a596">
                    reverse
                </a>
            </span>
            
            <span class="tag">
                
                <a href="/tags/buuctf/" style="color: #03a9f4">
                    buuctf
                </a>
            </span>
            
        </span>
        
    </div>
    <div class="content" v-pre>
        <h1 id="buuctf-CrackCtf"><a href="#buuctf-CrackCtf" class="headerlink" title="buuctf CrackCtf"></a>buuctf CrackCtf</h1><h5 id="Published-2022-x2F-09-x2F-10"><a href="#Published-2022-x2F-09-x2F-10" class="headerlink" title="Published: 2022&#x2F;09&#x2F;10"></a>Published: 2022&#x2F;09&#x2F;10</h5><h5 id="Updated-2022-x2F-09-x2F-10"><a href="#Updated-2022-x2F-09-x2F-10" class="headerlink" title="Updated: 2022&#x2F;09&#x2F;10"></a>Updated: 2022&#x2F;09&#x2F;10</h5><h3 id="PREFACE"><a href="#PREFACE" class="headerlink" title="PREFACE"></a>PREFACE</h3><ul>
<li>I’ve been now learning reverse engineering. I was stuck even when I consulted the write-up. Here I wrote some problems you may encounter.<span id="more"></span></li>
</ul>
<hr>
<h3 id="To-start-with-check-whether-it’s-packed-with-Exeinfo-PE-Luckly-it-isn’t-We-open-it-with-IDA-we-can-find-“plz-input-the-password”-by-“SHIFT-F12”-press-F5-to-go-into-it-and-got-its-code-Complex-it-is-we-have-to-move-on-From-the-first-sight-of-the-code-we-can-know-the-we-need-two-password-before-we-can-have-the-flag-First-we-input-a-string-“Destination”-which-has-SIX-CHARACTERS-and-from-function-atoi-we-know-that-it’s-character-is-all-number-and-the-whole-integer-is-bigger-then-100000-Then-it-add-“-DBApp”-behind-our-“Destination”-and-put-them-into-the-funtcion-“sub-40100A”-then-compare-the-String1-with-a-gibberish-At-least-looks-like-one-So-we-check-sub-40100A-It-lead-us-to-sub-401230-a-complex-function-There-are-tons-of-functions-I-didn’t-konw-before-Unfortunately-we-can-only-search-on-internet-to-look-for-clues-where-to-consult-We-can-find-that-in-function-CryptCreateHash-there-is-a-identifier-with-the-value-0x8004u-we-know-it-is-a-SHA-crypt-Like-we-found-above-Destination-is-a-string-between-“100000”-and-“999999”-So-we-can-use-this-code"><a href="#To-start-with-check-whether-it’s-packed-with-Exeinfo-PE-Luckly-it-isn’t-We-open-it-with-IDA-we-can-find-“plz-input-the-password”-by-“SHIFT-F12”-press-F5-to-go-into-it-and-got-its-code-Complex-it-is-we-have-to-move-on-From-the-first-sight-of-the-code-we-can-know-the-we-need-two-password-before-we-can-have-the-flag-First-we-input-a-string-“Destination”-which-has-SIX-CHARACTERS-and-from-function-atoi-we-know-that-it’s-character-is-all-number-and-the-whole-integer-is-bigger-then-100000-Then-it-add-“-DBApp”-behind-our-“Destination”-and-put-them-into-the-funtcion-“sub-40100A”-then-compare-the-String1-with-a-gibberish-At-least-looks-like-one-So-we-check-sub-40100A-It-lead-us-to-sub-401230-a-complex-function-There-are-tons-of-functions-I-didn’t-konw-before-Unfortunately-we-can-only-search-on-internet-to-look-for-clues-where-to-consult-We-can-find-that-in-function-CryptCreateHash-there-is-a-identifier-with-the-value-0x8004u-we-know-it-is-a-SHA-crypt-Like-we-found-above-Destination-is-a-string-between-“100000”-and-“999999”-So-we-can-use-this-code" class="headerlink" title="To start with, check whether it’s packed with Exeinfo PE. Luckly, it isn’t. We open it with IDA, we can find “plz input the password” by “SHIFT + F12”, press F5 to go into it, and got its code. Complex it is, we have to move on. From the first sight of the code, we can know the we need two password before we can have the flag. First, we input a string “Destination”, which has SIX CHARACTERS, and from function atoi(), we know that it’s character is all number and the whole integer is bigger then 100000. Then, it add “@DBApp” behind our “Destination”, and put them into the funtcion “sub_40100A”, then compare the String1 with a gibberish(At least looks like one). So we check sub_40100A. It lead us to sub_401230, a complex function. There are tons of functions I didn’t konw before. Unfortunately, we can only search on internet to look for clues.(where to consult) We can find that in function CryptCreateHash, there is a identifier with the value 0x8004u, we know it is a SHA crypt. Like we found above, Destination is a string between “100000” and “999999”. So we can use this code:"></a>To start with, check whether it’s packed with Exeinfo PE. Luckly, it isn’t. We open it with IDA, we can find “plz input the password” by “SHIFT + F12”, press F5 to go into it, and got its code. Complex it is, we have to move on. From the first sight of the code, we can know the we need two password before we can have the flag. First, we input a string “Destination”, which has SIX CHARACTERS, and from function atoi(), we know that it’s character is all number and the whole integer is bigger then 100000. Then, it add “@DBApp” behind our “Destination”, and put them into the funtcion “sub_40100A”, then compare the String1 with a gibberish(At least looks like one). So we check sub_40100A. It lead us to sub_401230, a complex function. There are tons of functions I didn’t konw before. Unfortunately, we can only search on internet to look for clues.(<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id">where to consult</a>) We can find that in function CryptCreateHash, there is a identifier with the value 0x8004u, we know it is a SHA crypt. Like we found above, Destination is a string between “100000” and “999999”. So we can use this code:</h3><blockquote>
<p>import hashlib<br>string&#x3D;‘@DBApp’<br>for i in range(100000,999999):<br>    flag&#x3D;str(i)+string<br>    x &#x3D; hashlib.sha1(flag.encode(“utf8”))<br>    y &#x3D; x.hexdigest()<br>    if “6e32d0943418c2c33385bc35a1470250dd8923a9” &#x3D;&#x3D; y:<br>            print(flag)<br>            break</p>
</blockquote>
<h3 id="Then-we-come-to-the-second-part-The-second-password-also-has-6-characters-but-didn’t-give-us-any-other-clue-so-it’s-impossible-to-use-brute-force-method-Sub-401019-isn’t-a-breakthough-we-shall-move-on-The-only-thing-left-for-us-is-sunction-sub-40100F-It’s-the-most-difficult-part-in-this-problem-We-can-know-that-it-output-a-rtf-file-Plus-our-password-has-6-characters-We-can-use-resource-hacker-to-open-file-“AAA”-The-first-6-characters-in-hex-are-what-we-want-Then-we-check-the-function-sub-101420-this-one-is-pretty-easy-we-can-write-our-script-input-the-characters-we-got-in-“AAA”-and-here-we-have-the-second-password-Input-the-two-password-and-we-got-the-flag-an-rtf-file-will-be-generated"><a href="#Then-we-come-to-the-second-part-The-second-password-also-has-6-characters-but-didn’t-give-us-any-other-clue-so-it’s-impossible-to-use-brute-force-method-Sub-401019-isn’t-a-breakthough-we-shall-move-on-The-only-thing-left-for-us-is-sunction-sub-40100F-It’s-the-most-difficult-part-in-this-problem-We-can-know-that-it-output-a-rtf-file-Plus-our-password-has-6-characters-We-can-use-resource-hacker-to-open-file-“AAA”-The-first-6-characters-in-hex-are-what-we-want-Then-we-check-the-function-sub-101420-this-one-is-pretty-easy-we-can-write-our-script-input-the-characters-we-got-in-“AAA”-and-here-we-have-the-second-password-Input-the-two-password-and-we-got-the-flag-an-rtf-file-will-be-generated" class="headerlink" title="Then, we come to the second part. The second password also has 6 characters, but didn’t give us any other clue, so it’s impossible to use brute force method. Sub_401019 isn’t a breakthough, we shall move on. The only thing left for us is sunction sub_40100F(). It’s the most difficult part in this problem. We can know that it output a .rtf file. Plus our password has 6 characters. We can use resource_hacker to open file “AAA”. The first 6 characters in hex are what we want. Then we check the function sub_101420(), this one is pretty easy, we can write our script, input the characters we got in “AAA”, and here we have the second password. Input the two password, and we got the flag(an .rtf file will be generated)."></a>Then, we come to the second part. The second password also has 6 characters, but didn’t give us any other clue, so it’s impossible to use brute force method. Sub_401019 isn’t a breakthough, we shall move on. The only thing left for us is sunction sub_40100F(). It’s the most difficult part in this problem. We can know that it output a .rtf file. Plus our password has 6 characters. We can use resource_hacker to open file “AAA”. The first 6 characters in hex are what we want. Then we check the function sub_101420(), this one is pretty easy, we can write our script, input the characters we got in “AAA”, and here we have the second password. Input the two password, and we got the flag(an .rtf file will be generated).</h3>
    </div>
    
</div>
                         
<footer id="footer">
    <div class="footer-wrap">
        <div>
            © 20xx - 2022 Moyao の小屋
            <span class="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            @Moyao
        </div>
        <div></div>
        <div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo Engine</a> & <a
                target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a></div>
        
    </div>
</footer>
                    </div>
                </div>
            </transition>
            <div id="img_show">
                <img id="img_content" alt="img_show">
            </div>
        </div>
        <script src="https://cdn.staticfile.org/highlight.js/11.5.1/highlight.min.js"></script>
        <script src="/js/particlex.js"></script>
        <script src="/js/showimg.js"></script>
        

    </body>
</html>