
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
        <title>Vm初探 | Moyao の小屋</title>
        <meta name="author" content="Moyao">
        <meta name="description" content="Write down something interesting I met
feel free to mail me if you have something wanted to talk about
mail: &lt;moyaoxue@outlook.com&gt;
">
        <meta name="keywords" content="">
        <link rel="icon" href="/images/head.jpg">
        <script src="https://cdn.staticfile.org/instant.page/5.1.0/instantpage.min.js" type="module"></script>
        <script src="https://cdn.staticfile.org/font-awesome/6.1.1/js/all.min.js"></script>
        
        <link rel="stylesheet" href="/css/fonts.min.css">
        <link rel="stylesheet" href="/css/particlex.css">
        
        <script src="https://cdn.staticfile.org/vue/3.2.33/vue.global.prod.min.js"></script>
    <meta name="generator" content="Hexo 6.2.0"></head>
    <body>
        <div id="loading" style="height:100vh;width:100vw;position:fixed;display:flex;z-index:200;justify-content:space-between;background:#fff;transition:opacity 0.3s ease-out"><div style="position:fixed;height:100vh;width:100vw;display:flex;justify-content:center;align-items:center"><div id="loadcontent" style="width:50vmin;height:50vmin;padding:50px;border-radius:50%;display:flex;justify-content:center;align-items:center;border:solid 10px #a3ddfb;text-align:center"><div><h2>LOADING...</h2><p style="word-break:keep-all">加载过慢请开启缓存(浏览器默认开启)</p><div><img alt="loading" src="/loading.gif"></div></div></div></div></div>
        <div id="layout">
            <i data-fa-symbol="calendar-solid" class="fa-solid fa-calendar fa-fw"></i>
            <i data-fa-symbol="bookmark-solid" class="fa-solid fa-bookmark fa-fw"></i>
            <i data-fa-symbol="tags-solid" class="fa-solid fa-tags fa-fw"></i>
            <transition name="into">
                <div v-show="show_page" style="display: -not-none">
                    <div id="menu_show">
                         
<nav id="menu">
    <div class="desktop-menu">
        <a href="/">
            <span class="title">Moyao の小屋</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;home</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;about</span>
        </a>
        
        <a target="_blank" rel="noopener" href="//tags/re/">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;tags</span>
        </a>
        
    </div>
    <div :class="'phone-menu ' + menu_show" id="phone-menu">
        <div class="curtain" @click="menu_show = !menu_show" v-show="menu_show"></div>
        <div :class="'title'" @click="menu_show = !menu_show">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;Moyao の小屋</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="menu_show">
            
            <a href="">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">home</div>
                </div>
            </a>
            
            <a href="">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">about</div>
                </div>
            </a>
            
            <a href="/tags/re/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">tags</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>
                    </div>
                    <div id="main">
                        
<div class="article">
    <div>
        <h1>Vm初探 </h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <svg class="fa-icon"><use xlink:href="#calendar-solid"></use></svg>
            </span>
            2024/4/8
        </span>
        
        
    </div>
    <div class="content" v-pre>
        <h6 id="PREFACE：最后两个逆向题，其实更像pwn的入门vm，写个orw，最后一题需要用各种方法bruteforce-amp-leak-opcode（由于附件不同这里exp相当于一个思路）"><a href="#PREFACE：最后两个逆向题，其实更像pwn的入门vm，写个orw，最后一题需要用各种方法bruteforce-amp-leak-opcode（由于附件不同这里exp相当于一个思路）" class="headerlink" title="PREFACE：最后两个逆向题，其实更像pwn的入门vm，写个orw，最后一题需要用各种方法bruteforce &amp; leak opcode（由于附件不同这里exp相当于一个思路）"></a>PREFACE：最后两个逆向题，其实更像pwn的入门vm，写个orw，最后一题需要用各种方法bruteforce &amp; leak opcode（由于附件不同这里exp相当于一个思路）</h6><span id="more"></span>

<h5 id="直白的orw"><a href="#直白的orw" class="headerlink" title="直白的orw"></a>直白的orw</h5><p>21.1</p>
<p>（ps.后面看这里有点问题的，偏移其实不对，但是可以通，很奇妙，可能是有什么奇妙巧合？）</p>
<pre><code class="python">
from pwn import *
context(os = &#39;linux&#39;,arch = &#39;amd64&#39;)
# context(log_level=&#39;debug&#39;)
# context(terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])
# p = gdb.debug(&#39;./babyrev_level21.0&#39;,&#39;b *interpret_sys + 156\nb *interpret_sys + 491\nb *interpret_sys + 659&#39;)
p = process([&#39;strace&#39;,&#39;./babyrev_level21.1&#39;])
# p = process(&#39;./babyrev_level21.1&#39;)
def register(name):
    match name:
        case &#39;opcode[1024]&#39;:
            return 64
        case &#39;opcode[1025]&#39;:
            return 1
        case &#39;opcode[1026]&#39;:
            return 16
        case &#39;opcode[1027]&#39;:
            return 4
        case &#39;opcode[1028]&#39;:
            return 8
        case &#39;opcode[1029]&#39;:
            return 32
    print(&#39;err register&#39;)

def interpret_instruction(name):
    match name:
        case &#39;interpret_imm&#39;:
            return 0x200
        case &#39;interpret_add&#39;:
            return 0x400
        case &#39;interpret_stk&#39;:
            return 0x800
        case &#39;interpret_stm&#39;:
            return 0x100
        case &#39;interpret_ldm&#39;:
            return 0x1000
        case &#39;interpret_cmp&#39;:
            return 0x8000
        case &#39;interpret_jmp&#39;:
            return 0x2000
        case &#39;interpret_sys&#39;:
            return 0x4000
    print(&#39;err instruction&#39;)

def interpret_imm(regs,value):
    return interpret_instruction(&#39;interpret_imm&#39;) + register(regs) + (value &lt;&lt; 16)

def interpret_stm():
    # opcode[1025] = offset
    # opcode[1026] = value
    return interpret_instruction(&#39;interpret_stm&#39;) + (register(&#39;opcode[1025]&#39;)) + (register(&#39;opcode[1026]&#39;) &lt;&lt; 16)

def interpret_sys(name):
    match name:
        case &#39;open&#39;:
            return 0x20
        case &#39;read_code&#39;:
            return 0x4
        case &#39;read&#39;:
            return 0x8
        case &#39;write&#39;:
            return 0x2
        case &#39;sleep&#39;:
            return 0x10
        case &#39;exit&#39;:
            return 0x1
    print(&#39;err sys&#39;)

def open():
    # opcode[opcode[1024] + 768] = addr
    # opcode[1024] = fd
    # opcode[1026] = len
    return interpret_sys(&#39;open&#39;) + interpret_instruction(&#39;interpret_sys&#39;) + (register(&#39;opcode[1024]&#39;) &lt;&lt; 16)

def read():
    # opcode[1024] = fd
    # opcode[1025] = ret len
    return interpret_sys(&#39;read&#39;) + interpret_instruction(&#39;interpret_sys&#39;) + (register(&#39;opcode[1025]&#39;) &lt;&lt; 16)

def write():
    # opcode[1024] = fd
    return interpret_sys(&#39;write&#39;) + interpret_instruction(&#39;interpret_sys&#39;) + (register(&#39;opcode[1025]&#39;) &lt;&lt; 16)

def exitPro():
    return interpret_sys(&#39;exit&#39;) + interpret_instruction(&#39;interpret_sys&#39;)

opcode_func = &#39;&#39;&#39;
interpret_imm(&#39;opcode[1025]&#39;,768) # offset
interpret_imm(&#39;opcode[1026]&#39;,ord(&#39;/&#39;)) # value
interpret_stm()
interpret_imm(&#39;opcode[1025]&#39;,769) # offset
interpret_imm(&#39;opcode[1026]&#39;,ord(&#39;f&#39;)) # value
interpret_stm()
interpret_imm(&#39;opcode[1025]&#39;,770) # offset
interpret_imm(&#39;opcode[1026]&#39;,ord(&#39;l&#39;)) # value
interpret_stm()
interpret_imm(&#39;opcode[1025]&#39;,771) # offset
interpret_imm(&#39;opcode[1026]&#39;,ord(&#39;a&#39;)) # value
interpret_stm()
interpret_imm(&#39;opcode[1025]&#39;,772) # offset
interpret_imm(&#39;opcode[1026]&#39;,ord(&#39;g&#39;)) # value
interpret_stm()

interpret_imm(&#39;opcode[1024]&#39;,0) # addr = opcode[0 + 768]
interpret_imm(&#39;opcode[1025]&#39;,0)
interpret_imm(&#39;opcode[1026]&#39;,0)
open()

interpret_imm(&#39;opcode[1026]&#39;,0x50) # len
read()

interpret_imm(&#39;opcode[1024]&#39;,1)
interpret_imm(&#39;opcode[1025]&#39;,0)
interpret_imm(&#39;opcode[1026]&#39;,0x50) # len
write()
exitPro()
&#39;&#39;&#39;
opcode = []
opcode_func = opcode_func.split(&#39;\n&#39;)
# print(opcode_func)
for i in opcode_func:
    if (i == &#39;&#39;):
        continue
    p48 = eval(i)
    opcode.append(p48 &amp; 0xff)
    opcode.append((p48 &amp; 0xff00) &gt;&gt; 8)
    opcode.append((p48 &amp; 0xff0000) &gt;&gt; 16)
opcode+=([0] * (0x300 - len(opcode)))

a = opcode
a = b&#39;&#39;.join([bytes([i]) for i in a])
# print(a)
p.send(a)
p.interactive()
</code></pre>
<h5 id="随机化opcode的orw"><a href="#随机化opcode的orw" class="headerlink" title="随机化opcode的orw"></a>随机化opcode的orw</h5><p>22.0</p>
<p>爆破的思路：</p>
<p>种子一共0xff个，没有尝试直接爆，徒手一步一步做的（注释掉的就是思路），从exit为入口点一步一步推一步一步还原（这里最后的open只有三个可能的值<code>1|8|64</code>，直接手试了）:</p>
<pre><code class="python">
from pwn import *
context(os = &#39;linux&#39;,arch = &#39;amd64&#39;)
# context(log_level=&#39;debug&#39;)
# context(terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])
# p = gdb.debug(&#39;./babyrev_level21.0&#39;,&#39;b *interpret_sys + 156\nb *interpret_sys + 491\nb *interpret_sys + 659&#39;)
# p = process([&#39;strace&#39;,&#39;./babyrev_level22.0&#39;])

# ------------------------------------------------
### sys:16  | exit:1
### interpret_imm:4 | opcode[1024]:8
### sleep:128
### read_code|read_memory:2/32                 opcode[1029]:64   none:4
### add:2
# ------------------------------------------------

## test exit
### sys:16, exit:1
# table = [1,2,4,8,16,32,64,0x80]
# for i in table:
#     for j in table:
#         a = []
#         a.append(5)
#         a.append(j)
#         a.append(i)
#         a += [0] * 0x300
#         a = b&#39;&#39;.join([bytes([i]) for i in a])
#         p = process(&#39;/challenge/babyrev_level22.0&#39;)
#         p.sendafter(b&quot;This time, YOU&#39;RE in control! Please input your yancode: &quot;,a)
#         h = p.recv(4096)
#         print(i)
#         print(j)

## test interpret_imm, opcode | search : &quot;exit code 5&quot;
# table = [1,2,4,8,16,32,64,0x80]
# for i in table:
#     for j in table:
#         a = []
#         a.append(5)
#         a.append(j)
#         a.append(i)
#         a.append(0)
#         a.append(16)
#         a.append(1)
#         a += [0] * 0x250
#         a = b&#39;&#39;.join([bytes([i]) for i in a])
#         p = process(&#39;/challenge/babyrev_level22.0&#39;)
#         p.sendafter(b&quot;This time, YOU&#39;RE in control! Please input your yancode: &quot;,a)
#         h = p.recv(4096)
#         print(i)
#         print(j)

## test sleep 128
# table = [1,2,4,8,16,32,64,0x80]
# for i in table:
#     a = []
#     a.append(0x10)
#     a.append(8)
#     a.append(4) # opcode[1024] = 0
#     a.append(0x10)
#     a.append(i)
#     a.append(1) # sleep
#     a.append(0)
#     a.append(16)
#     a.append(1) # exit
#     a = b&#39;&#39;.join([bytes([i]) for i in a])
#     p = process(&#39;/challenge/babyrev_level22.0&#39;)
#     p.sendafter(b&quot;This time, YOU&#39;RE in control! Please input your yancode: &quot;,a)
#     p.interactive()
#     # print(h)
#     print(i)

# use exit and add can exploit all the regs
## find add first:2
# import time
# table = [1,2,4,8,16,32,64,0x80]
# for j in table:
#     print(j)
#     a = []
#     a.append(3)
#     a.append(8)
#     a.append(4) # opcode[1024] = 3
#     a.append(8)
#     a.append(8)
#     a.append(j) # test add
#     a.append(0)
#     a.append(16)
#     a.append(1) # exit
#     a_byte = b&#39;&#39;.join([bytes([i]) for i in a])
#     p = process(&#39;/challenge/babyrev_level22.0&#39;)
#     p.sendafter(b&quot;This time, YOU&#39;RE in control! Please input your yancode: &quot;,a_byte)
#     time.sleep(0.1)
#     p.kill()

## test ldm
# 32
# table = [1,2,4,8,16,32,64,0x80]
# for j in table:
#     print(j)
#     a = []
#     a.append(3)
#     a.append(8)
#     a.append(4) # opcode[1024] = 10
#     a.append(8)
#     a.append(8)
#     a.append(j) # test ldm
#     a.append(0)
#     a.append(16)
#     a.append(1) # exit
#     a_byte = b&#39;&#39;.join([bytes([i]) for i in a])
#     p = process(&#39;/challenge/babyrev_level22.0&#39;)
#     p.sendafter(b&quot;This time, YOU&#39;RE in control! Please input your yancode: &quot;,a_byte)
#     time.sleep(0.1)
#     p.kill()

## test stm
# 64
# table = [1,2,4,8,16,32,64,0x80]
# for j in table:
#     print(j)
#     a = []
#     a.append(3)
#     a.append(8)
#     a.append(4) # opcode[1024] = 3
#     a.append(8)
#     a.append(1)
#     a.append(j) # test stm opcode[768] = 3;
#     a.append(5)
#     a.append(8)
#     a.append(4) # opcode[1024] = 5 # failed to write
#     a.append(1)
#     a.append(8)
#     a.append(32) # ldm
#     a.append(0)
#     a.append(16)
#     a.append(1) # exit
#     a_byte = b&#39;&#39;.join([bytes([i]) for i in a])
#     p = process(&#39;/challenge/babyrev_level22.0&#39;)
#     p.sendafter(b&quot;This time, YOU&#39;RE in control! Please input your yancode: &quot;,a_byte)
#     time.sleep(0.1)
#     p.kill()

# # # write
# # write:4
# table = [1,2,4,8,16,32,64,0x80]
# for j in table:
#     if (j == 16 or j == 128 or j == 2 or j == 32):
#         continue
#     print(j)
#     a = []
#     a.append(ord(&#39;^&#39;))
#     a.append(8)
#     a.append(4) # opcode[1024] = ord(&#39;^&#39;)
#     a.append(8)
#     a.append(1)
#     a.append(64) # stm opcode[768] = ord(&#39;^&#39;);
#     a.append(1)
#     a.append(1)
#     a.append(4) # opcode[[1]] ++
#     a.append(8)
#     a.append(1)
#     a.append(64) # stm opcode[769] = ord(&#39;^&#39;);
#     a.append(2)
#     a.append(1)
#     a.append(4) # opcode[[1]] ++
#     a.append(8)
#     a.append(1)
#     a.append(64) # stm opcode[769] = ord(&#39;^&#39;);
#     for i in table: # all register = 1
#         if (i == 8 or i == 4 or i == 64):
#             continue
#         a.append(1)
#         a.append(i)
#         a.append(4)
#     a.append(1)
#     a.append(8)
#     a.append(4) # opcode[1024] = 1 # fd = io
#     a.append(1)
#     a.append(j)
#     a.append(1) # write
#     a.append(0)
#     a.append(16)
#     a.append(1) # exit
#     a_byte = b&#39;&#39;.join([bytes([i]) for i in a])
#     p = process(&#39;/challenge/babyrev_level22.0&#39;)
#     p.sendafter(b&quot;This time, YOU&#39;RE in control! Please input your yancode: &quot;,a_byte)
#     time.sleep(0.3)
#     print(p.recv())
#     p.kill()

# ## opcode[1025]
# # 1
# table = [1,2,4,8,16,32,64,0x80]
# tmp_a = []
# tmp_a.append(ord(&#39;^&#39;))
# tmp_a.append(8)
# tmp_a.append(4) # opcode[1024] = ord(&#39;^&#39;)
# tmp_a.append(8)
# tmp_a.append(1)
# tmp_a.append(64) # stm opcode[768] = ord(&#39;^&#39;);
# tmp_a.append(1)
# tmp_a.append(1)
# tmp_a.append(4) # opcode[[1]] ++
# tmp_a.append(8)
# tmp_a.append(1)
# tmp_a.append(64) # stm opcode[769] = ord(&#39;^&#39;);
# tmp_a.append(2)
# tmp_a.append(1)
# tmp_a.append(4) # opcode[[1]] ++
# tmp_a.append(8)
# tmp_a.append(1)
# tmp_a.append(64) # stm opcode[769] = ord(&#39;^&#39;);

# for k in table: # test_register = 1
#     a = tmp_a.copy()
#     # print(a)
#     if (k == 8 or k == 4 or k == 64):
#         continue
#     for i in table: # all register = 0
#         if (i == 8 or i == 4 or i == 64):
#             continue
#         a.append(0)
#         a.append(i)
#         a.append(4)
#     print(k)
#     a.append(2)
#     a.append(k)
#     a.append(4) # one register = 1    
#     a.append(1)
#     a.append(8)
#     a.append(4) # opcode[1024] = 1 # fd = io
#     a.append(1)
#     a.append(4)
#     a.append(1) # write
#     a.append(0)
#     a.append(16)
#     a.append(1) # exit
#     a_byte = b&#39;&#39;.join([bytes([i]) for i in a])
#     p = process(&#39;/challenge/babyrev_level22.0&#39;)
#     p.sendafter(b&quot;This time, YOU&#39;RE in control! Please input your yancode: &quot;,a_byte)
#     time.sleep(0.1)
#     print(p.recv())
#     p.kill()



##  opcode[1025]
# 32
# table = [1,2,4,8,16,32,64,0x80]
# tmp_a = []
# tmp_a.append(ord(&#39;^&#39;))
# tmp_a.append(8)
# tmp_a.append(4) # opcode[1024] = ord(&#39;^&#39;)
# tmp_a.append(8)
# tmp_a.append(1)
# tmp_a.append(64) # stm opcode[768] = ord(&#39;^&#39;);
# tmp_a.append(1)
# tmp_a.append(1)
# tmp_a.append(4) # opcode[[1]] ++
# tmp_a.append(ord(&#39;@&#39;))
# tmp_a.append(8)
# tmp_a.append(4) # opcode[1024] = ord(&#39;^&#39;)
# tmp_a.append(8)
# tmp_a.append(1)
# tmp_a.append(64) # stm opcode[769] = ord(&#39;^&#39;);
# tmp_a.append(2)
# tmp_a.append(1)
# tmp_a.append(4) # opcode[[1]] ++
# tmp_a.append(ord(&#39;#&#39;))
# tmp_a.append(8)
# tmp_a.append(4) # opcode[1024] = ord(&#39;^&#39;)
# tmp_a.append(8)
# tmp_a.append(1)
# tmp_a.append(64) # stm opcode[769] = ord(&#39;^&#39;);

# for k in table: # test opcode[1025]
#     if (k == 1 or k == 8 or k == 64 or k == 4):
#         continue
#     a = tmp_a.copy()
#     # print(a)
#     for i in table: # all register = 0
#         if (i == 8 or i == 4 or i == 64 or i == 1):
#             continue
#         a.append(0)
#         a.append(i)
#         a.append(4)
#     print(k)
#     a.append(1)
#     a.append(k)
#     a.append(4) # opcode[1025] # offset: 1  

#     a.append(1)
#     a.append(1)
#     a.append(4) # opcode[1026] # len: 1  
#     a.append(1)
#     a.append(8)
#     a.append(4) # opcode[1024] = 1 # fd = io
#     a.append(1)
#     a.append(4)
#     a.append(1) # write
#     a.append(0)
#     a.append(16)
#     a.append(1) # exit
#     a_byte = b&#39;&#39;.join([bytes([i]) for i in a])
#     p = process(&#39;/challenge/babyrev_level22.0&#39;)
#     p.sendafter(b&quot;This time, YOU&#39;RE in control! Please input your yancode: &quot;,a_byte)
#     time.sleep(0.1)
#     print(p.recv())
#     p.kill()


# # read
# 32
# table = [1,2,4,8,16,32,64,0x80]
# for k in [2,32]: # test read
#     a = []
#     print(k)
#     a.append(1)
#     a.append(32)
#     a.append(4) # opcode[1025] # offset: 1  

#     a.append(1)
#     a.append(1)
#     a.append(4) # opcode[1026] # len: 1 

#     a.append(0)
#     a.append(8)
#     a.append(4) # opcode[1024] = 0 # fd = io

#     a.append(2)
#     a.append(k)
#     a.append(1) # read

#     a.append(1)
#     a.append(8)
#     a.append(4) # opcode[1024] = 1 # fd = io

#     a.append(1)
#     a.append(4)
#     a.append(1) # write
#     a.append(0)
#     a.append(16)
#     a.append(1) # exit
#     a_byte = b&#39;&#39;.join([bytes([i]) for i in a])
#     p = process(&#39;/challenge/babyrev_level22.0&#39;)
#     p.sendafter(b&quot;This time, YOU&#39;RE in control! Please input your yancode: &quot;,a_byte)
#     time.sleep(0.1)
#     # print(p.recv())
#     p.interactive()
#     p.kill()



# ----------------------------------------------------------------------------------------------------------------------------------- #
#                                                               open -&gt; 
# ----------------------------------------------------------------------------------------------------------------------------------- #
def register(name):
    if (name == &#39;opcode[1024]&#39;):
        return 8
    if (name == &#39;opcode[1025]&#39;):
        return 32
    if (name == &#39;opcode[1026]&#39;):
        return 1
    if (name == &#39;opcode[1027]&#39;):
        return 0
    if (name == &#39;opcode[1028]&#39;):
        return 0
    if (name == &#39;opcode[1029]&#39;):
        return 64
    print(&#39;err register&#39;)

def interpret_instruction(name):
    if (name == &#39;interpret_imm&#39;):
        return 4 &lt;&lt; 16
    if (name == &#39;interpret_add&#39;):
        return 2 &lt;&lt; 16
    if (name == &#39;interpret_stk&#39;):
        return 0
    if (name == &#39;interpret_stm&#39;):
        return 64 &lt;&lt; 16
    if (name == &#39;interpret_ldm&#39;):
        return 32 &lt;&lt; 16
    if (name == &#39;interpret_cmp&#39;):
        return 0
    if (name == &#39;interpret_jmp&#39;):
        return 0
    if (name == &#39;interpret_sys&#39;):
        return 1 &lt;&lt; 16
    print(&#39;err instruction&#39;)

def interpret_imm(regs,value):
    return interpret_instruction(&#39;interpret_imm&#39;) + (register(regs) &lt;&lt; 8) + (value)

def interpret_stm():
    # opcode[1025] = offset
    # opcode[1026] = value
    return interpret_instruction(&#39;interpret_stm&#39;) + (register(&#39;opcode[1025]&#39;) &lt;&lt; 8) + (register(&#39;opcode[1026]&#39;))

def interpret_sys(name):
    if (name == &#39;open&#39;):
        return 8 &lt;&lt; 8
    if (name == &#39;read_code&#39;):
        return 2 &lt;&lt; 8
    if (name == &#39;read&#39;):
        return 32 &lt;&lt; 8
    if (name == &#39;write&#39;):
        return 4 &lt;&lt; 8
    if (name == &#39;sleep&#39;):
        return 128 &lt;&lt; 8
    if (name == &#39;exit&#39;):
        return 16 &lt;&lt; 8
    print(&#39;err sys&#39;)

def open():
    # opcode[opcode[1024] + 768] = addr
    # opcode[1024] = fd
    # opcode[1026] = len
    return interpret_sys(&#39;open&#39;) + interpret_instruction(&#39;interpret_sys&#39;) + (register(&#39;opcode[1024]&#39;) )

def read():
    # opcode[1024] = fd
    # opcode[1025] = ret len
    return interpret_sys(&#39;read&#39;) + interpret_instruction(&#39;interpret_sys&#39;) + (register(&#39;opcode[1025]&#39;) )

def write():
    # opcode[1024] = fd
    return interpret_sys(&#39;write&#39;) + interpret_instruction(&#39;interpret_sys&#39;) + (register(&#39;opcode[1025]&#39;) )

def exitPro():
    return interpret_sys(&#39;exit&#39;) + interpret_instruction(&#39;interpret_sys&#39;)

opcode_func = &#39;&#39;&#39;
interpret_imm(&#39;opcode[1025]&#39;,0) # offset
interpret_imm(&#39;opcode[1026]&#39;,ord(&#39;/&#39;)) # value
interpret_stm()
interpret_imm(&#39;opcode[1025]&#39;,1) # offset
interpret_imm(&#39;opcode[1026]&#39;,ord(&#39;f&#39;)) # value
interpret_stm()
interpret_imm(&#39;opcode[1025]&#39;,2) # offset
interpret_imm(&#39;opcode[1026]&#39;,ord(&#39;l&#39;)) # value
interpret_stm()
interpret_imm(&#39;opcode[1025]&#39;,3) # offset
interpret_imm(&#39;opcode[1026]&#39;,ord(&#39;a&#39;)) # value
interpret_stm()
interpret_imm(&#39;opcode[1025]&#39;,4) # offset
interpret_imm(&#39;opcode[1026]&#39;,ord(&#39;g&#39;)) # value
interpret_stm()

interpret_imm(&#39;opcode[1024]&#39;,0) # addr = opcode[0 + 768]
interpret_imm(&#39;opcode[1025]&#39;,0)
interpret_imm(&#39;opcode[1026]&#39;,0)
open()

interpret_imm(&#39;opcode[1026]&#39;,0x50) # len
read()

interpret_imm(&#39;opcode[1024]&#39;,1)
interpret_imm(&#39;opcode[1025]&#39;,0)
interpret_imm(&#39;opcode[1026]&#39;,0x50) # len
write()
exitPro()
&#39;&#39;&#39;
opcode = []
opcode_func = opcode_func.split(&#39;\n&#39;)
# print(opcode_func)
for i in opcode_func:
    if (i == &#39;&#39;):
        continue
    p48 = eval(i)
    opcode.append(p48 &amp; 0xff)
    opcode.append((p48 &amp; 0xff00) &gt;&gt; 8)
    opcode.append((p48 &amp; 0xff0000) &gt;&gt; 16)
opcode+=([0] * (0x300 - len(opcode)))

a = opcode
# print(a)
a = b&#39;&#39;.join([bytes([i]) for i in a])

p = process(&#39;/challenge/babyrev_level22.0&#39;)
p.sendafter(b&quot;This time, YOU&#39;RE in control! Please input your yancode: &quot;,a)
p.interactive()
p.kill()
</code></pre>

    </div>
    
</div>
                         
<footer id="footer">
    <div class="footer-wrap">
        <div>
            © 20xx - 2024 Moyao の小屋
            <span class="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            @Moyao
        </div>
        <div></div>
        <div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo Engine</a> & <a
                target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a></div>
        
    </div>
</footer>
                    </div>
                </div>
            </transition>
            <div id="img_show">
                <img id="img_content" alt="img_show">
            </div>
        </div>
        <script src="https://cdn.staticfile.org/highlight.js/11.5.1/highlight.min.js"></script>
        <script src="/js/particlex.js"></script>
        <script src="/js/showimg.js"></script>
        

    </body>
</html>