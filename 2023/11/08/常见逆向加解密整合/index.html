<!doctypehtml><html lang=en><meta charset=UTF-8><meta content=width=device-width,initial-scale=1,maximum-scale=2 name=viewport><meta content=#222 name=theme-color><meta content=IE=edge,chrome=1 http-equiv=X-UA-COMPATIBLE><meta content=webkit name=renderer><link href=/assets/favicon.ico rel=icon sizes=32x32 type=image/ico><link href=/assets/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/rss.xml rel=alternate title=rev@天枢 type=application/rss+xml><link href=/atom.xml rel=alternate title=rev@天枢 type=application/atom+xml><link href=https://demoyao100.github.io/feed.json rel=alternate title=rev@天枢 type=application/json><link href=https://lf9-cdn-tos.bytecdntp.com rel=preconnect><link href=https://cdn.jsdelivr.net rel=dns-prefetch><link href=https://unpkg.com rel=dns-prefetch><link href=https://fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext rel=stylesheet><link href=/css/app.css?v=0.3.15 rel=stylesheet><meta content=re name=keywords><link href=https://demoyao100.github.io/2023/11/08/%E5%B8%B8%E8%A7%81%E9%80%86%E5%90%91%E5%8A%A0%E8%A7%A3%E5%AF%86%E6%95%B4%E5%90%88/ rel=canonical><title>常见逆向加解密整合</title><meta content="Hexo 7.0.0" name=generator><body itemscope itemtype=http://schema.org/WebPage><div id=loading><div class=cat><div class=body></div><div class=head><div class=face></div></div><div class=foot><div class=tummy-end></div><div class=bottom></div><div class="legs left"></div><div class="legs right"></div></div><div class=paw><div class="hands left"></div><div class="hands right"></div></div></div></div><div id=container><header id=header itemscope itemtype=http://schema.org/WPHeader><div class=inner><div id=brand><div class=pjax><h1 itemprop="name headline">常见逆向加解密整合</h1><div class=meta><span title="Created: 2023-11-08 20:23:09" class=item><span class=icon><i class="ic i-calendar"></i></span><span class=text>Posted on</span><time itemprop="dateCreated datePublished" datetime=2023-11-08T20:23:09+08:00>2023-11-08</time></span><span title="Symbols count in article" class=item><span class=icon><i class="ic i-pen"></i></span><span class=text>Symbols count in article</span><span>74k</span><span class=text>words</span></span><span title="Reading time" class=item><span class=icon><i class="ic i-clock"></i></span><span class=text>Reading time</span><span>1:08</span></span></div></div></div><nav id=nav><div class=inner><div class=toggle><div aria-label="Toggle navigation bar" class=lines><span class=line></span><span class=line></span><span class=line></span></div></div><ul class=menu><li class="item title"><a href=/ rel=start>Moyao の小屋</a></ul><ul class=right id=rightNav><li class="item theme" @click=changeThemeByBtn><i :class="{'i-sun': !themeStatus,'i-moon': themeStatus}" class=ic></i><li class="item search"><i class="ic i-search"></i></ul></div></nav></div><div class=pjax id=imgs><img src=https://tva4.sinaimg.cn/mw690/6833939bly1gicitcxhpij20zk0m8hdt.jpg></div></header><div id=waves><svg viewbox="0 24 150 28" class=waves preserveaspectratio=none shape-rendering=auto xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><defs><path d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" id=gentle-wave></path></defs><g class=parallax><use x=48 xlink:href=#gentle-wave y=0></use><use x=48 xlink:href=#gentle-wave y=3></use><use x=48 xlink:href=#gentle-wave y=5></use><use x=48 xlink:href=#gentle-wave y=7></use></g></svg></div><main><div class=inner><div class=pjax id=main><div class="article wrap"><div class=breadcrumb itemlistelement itemscope itemtype=https://schema.org/BreadcrumbList><i class="ic i-home"></i><span><a href=/>Home</a></span></div><article class="post block" itemscope itemtype=http://schema.org/Article lang=en><link href=https://demoyao100.github.io/2023/11/08/%E5%B8%B8%E8%A7%81%E9%80%86%E5%90%91%E5%8A%A0%E8%A7%A3%E5%AF%86%E6%95%B4%E5%90%88/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta content=/assets/avatar.jpg itemprop=image><meta content=Moyao itemprop=name><meta content="Hi,I'm Moyaoxue, Write down something interesting I met<br />
Feel free to mail me if you have something wanted to talk about, plz
mail: &amplt;moyaoxue@outlook.com&ampgt;
" itemprop=description></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta content=rev@天枢 itemprop=name></span><div class="body md" itemprop=articleBody><h6 id=preface小做一点整理><a class=anchor href=#preface小做一点整理>#</a> preface：小做一点整理</h6><p><span id=more></span><h2 id=流密码><a class=anchor href=#流密码>#</a> 流密码</h2><h4 id=rc4><a class=anchor href=#rc4>#</a> RC4</h4><p>魔改的点一般就是在里面加别的操作吧，异或之类的<figure class="highlight python"><figcaption data-lang=python></figcaption><table><tr><td data-num=1><td><pre><span class="token keyword">class</span> <span class="token class-name">RC4</span><span class="token punctuation">:</span></pre><tr><td data-num=2><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span></pre><tr><td data-num=3><td><pre>        self<span class="token punctuation">.</span>key <span class="token operator">=</span> key</pre><tr><td data-num=4><td><pre>        self<span class="token punctuation">.</span>S <span class="token operator">=</span> <span class="token number">0</span></pre><tr><td data-num=5><td><pre>        self<span class="token punctuation">.</span>__rc4_init__<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=6><td><pre>    <span class="token keyword">def</span> <span class="token function">__rc4_init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=7><td><pre>        S <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=8><td><pre>        j <span class="token operator">=</span> <span class="token number">0</span></pre><tr><td data-num=9><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=10><td><pre>            j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span></pre><tr><td data-num=11><td><pre>            S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> S<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> S<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span></pre><tr><td data-num=12><td><pre>        self<span class="token punctuation">.</span>S <span class="token operator">=</span> S</pre><tr><td data-num=13><td><pre>    <span class="token keyword">def</span> <span class="token function">rc4_encrypt</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> plain<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">list</span><span class="token punctuation">:</span></pre><tr><td data-num=14><td><pre>        i <span class="token operator">=</span> <span class="token number">0</span></pre><tr><td data-num=15><td><pre>        j <span class="token operator">=</span> <span class="token number">0</span></pre><tr><td data-num=16><td><pre>        cipher <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre><tr><td data-num=17><td><pre>        <span class="token keyword">for</span> p <span class="token keyword">in</span> plain<span class="token punctuation">:</span></pre><tr><td data-num=18><td><pre>            i <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span></pre><tr><td data-num=19><td><pre>            j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> self<span class="token punctuation">.</span>S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span></pre><tr><td data-num=20><td><pre>            self<span class="token punctuation">.</span>S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>S<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>S<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>S<span class="token punctuation">[</span>i<span class="token punctuation">]</span></pre><tr><td data-num=21><td><pre>            k <span class="token operator">=</span> p <span class="token operator">^</span> self<span class="token punctuation">.</span>S<span class="token punctuation">[</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>S<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>S<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">]</span></pre><tr><td data-num=22><td><pre>            cipher<span class="token punctuation">.</span>append<span class="token punctuation">(</span>k<span class="token punctuation">)</span></pre><tr><td data-num=23><td><pre>        <span class="token keyword">return</span> cipher</pre><tr><td data-num=24><td><pre></pre><tr><td data-num=25><td><pre>key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre><tr><td data-num=26><td><pre>data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre><tr><td data-num=27><td><pre>rc4 <span class="token operator">=</span> RC4<span class="token punctuation">(</span>key<span class="token punctuation">)</span></pre><tr><td data-num=28><td><pre>plain <span class="token operator">=</span> rc4<span class="token punctuation">.</span>rc4_encrypt<span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre><tr><td data-num=29><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> plain<span class="token punctuation">:</span></pre><tr><td data-num=30><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>end <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span></pre></table></figure><h4 id=salsa20><a class=anchor href=#salsa20>#</a> Salsa20</h4><p>需要注意 nonce 的初始填充<figure class="highlight python"><figcaption data-lang=python></figcaption><table><tr><td data-num=1><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> Salsa20</pre><tr><td data-num=2><td><pre></pre><tr><td data-num=3><td><pre>key <span class="token operator">=</span> <span class="token string">b'\x07\x05\x0B\x0D\x0F\x0D\x0B\x05\x07\x05\x1B\x1D\x1F\x1D\x1B\x05\x07\x05\x0B\x0D\x0F\x37\x35\x3B\x3D\x3F\x07\x05\x0B\x0D\x0F\x0D'</span></pre><tr><td data-num=4><td><pre>nonce <span class="token operator">=</span> <span class="token string">b'\x00\x00\x00\x00\x00\x00\x00\x00'</span></pre><tr><td data-num=5><td><pre></pre><tr><td data-num=6><td><pre>plaintext <span class="token operator">=</span> <span class="token string">b"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_"</span></pre><tr><td data-num=7><td><pre>cipher <span class="token operator">=</span> Salsa20<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token operator">=</span>key <span class="token punctuation">,</span> nonce<span class="token operator">=</span>nonce<span class="token punctuation">)</span></pre><tr><td data-num=8><td><pre>ciphertext <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span></pre><tr><td data-num=9><td><pre></pre><tr><td data-num=10><td><pre>a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">hex</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> ciphertext<span class="token punctuation">]</span></pre><tr><td data-num=11><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></table></figure><p>完整版<figure class="highlight python"><figcaption data-lang=python></figcaption><table><tr><td data-num=1><td><pre><span class="token keyword">class</span> <span class="token class-name">Salsa</span><span class="token punctuation">:</span></pre><tr><td data-num=2><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> r<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=3><td><pre>        <span class="token keyword">assert</span> r <span class="token operator">>=</span> <span class="token number">0</span></pre><tr><td data-num=4><td><pre>        self<span class="token punctuation">.</span>_r <span class="token operator">=</span> r  <span class="token comment"># number of rounds</span></pre><tr><td data-num=5><td><pre>        self<span class="token punctuation">.</span>_mask <span class="token operator">=</span> <span class="token number">0xffffffff</span>  <span class="token comment"># 32-bit mask</span></pre><tr><td data-num=6><td><pre></pre><tr><td data-num=7><td><pre>    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">32</span><span class="token punctuation">,</span> nonce<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">,</span> block_counter<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=8><td><pre>        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">32</span></pre><tr><td data-num=9><td><pre>        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>nonce<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">8</span></pre><tr><td data-num=10><td><pre>        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>block_counter<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">8</span></pre><tr><td data-num=11><td><pre></pre><tr><td data-num=12><td><pre>        <span class="token comment"># init state</span></pre><tr><td data-num=13><td><pre>        k <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>_littleendian<span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">:</span><span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=14><td><pre>        n <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>_littleendian<span class="token punctuation">(</span>nonce<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">:</span><span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=15><td><pre>        b <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>_littleendian<span class="token punctuation">(</span>block_counter<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">:</span><span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=16><td><pre>        c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x61707865</span><span class="token punctuation">,</span> <span class="token number">0x3320646e</span><span class="token punctuation">,</span> <span class="token number">0x79622d32</span><span class="token punctuation">,</span> <span class="token number">0x6b206574</span><span class="token punctuation">]</span></pre><tr><td data-num=17><td><pre></pre><tr><td data-num=18><td><pre>        s <span class="token operator">=</span> <span class="token punctuation">[</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre><tr><td data-num=19><td><pre>             k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> n<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> n<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre><tr><td data-num=20><td><pre>             b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre><tr><td data-num=21><td><pre>             k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span></pre><tr><td data-num=22><td><pre></pre><tr><td data-num=23><td><pre>        <span class="token comment"># the state</span></pre><tr><td data-num=24><td><pre>        self<span class="token punctuation">.</span>_s <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span></pre><tr><td data-num=25><td><pre></pre><tr><td data-num=26><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_r<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=27><td><pre>            self<span class="token punctuation">.</span>_round<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=28><td><pre></pre><tr><td data-num=29><td><pre>        <span class="token comment"># add initial state to the final one</span></pre><tr><td data-num=30><td><pre>        self<span class="token punctuation">.</span>_s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=31><td><pre></pre><tr><td data-num=32><td><pre>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_s</pre><tr><td data-num=33><td><pre></pre><tr><td data-num=34><td><pre>    <span class="token keyword">def</span> <span class="token function">_littleendian</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=35><td><pre>        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span></pre><tr><td data-num=36><td><pre>        <span class="token keyword">return</span> b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator"><<</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator"><<</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator"><<</span> <span class="token number">24</span><span class="token punctuation">)</span></pre><tr><td data-num=37><td><pre></pre><tr><td data-num=38><td><pre>    <span class="token keyword">def</span> <span class="token function">_round</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=39><td><pre>        <span class="token comment"># quarterround 1</span></pre><tr><td data-num=40><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span></pre><tr><td data-num=41><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span></pre><tr><td data-num=42><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span></pre><tr><td data-num=43><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span></pre><tr><td data-num=44><td><pre></pre><tr><td data-num=45><td><pre>        <span class="token comment"># quarterround 2</span></pre><tr><td data-num=46><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span></pre><tr><td data-num=47><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span></pre><tr><td data-num=48><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span></pre><tr><td data-num=49><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span></pre><tr><td data-num=50><td><pre></pre><tr><td data-num=51><td><pre>        <span class="token comment"># quarterround 3</span></pre><tr><td data-num=52><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span></pre><tr><td data-num=53><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span></pre><tr><td data-num=54><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span></pre><tr><td data-num=55><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span></pre><tr><td data-num=56><td><pre></pre><tr><td data-num=57><td><pre>        <span class="token comment"># quarterround 4</span></pre><tr><td data-num=58><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span></pre><tr><td data-num=59><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span></pre><tr><td data-num=60><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span></pre><tr><td data-num=61><td><pre>        self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> self<span class="token punctuation">.</span>_rotl32<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span></pre><tr><td data-num=62><td><pre></pre><tr><td data-num=63><td><pre>        <span class="token comment"># transpose</span></pre><tr><td data-num=64><td><pre>        self<span class="token punctuation">.</span>_s <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre><tr><td data-num=65><td><pre>                   self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre><tr><td data-num=66><td><pre>                   self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre><tr><td data-num=67><td><pre>                   self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_s<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span></pre><tr><td data-num=68><td><pre></pre><tr><td data-num=69><td><pre>    <span class="token keyword">def</span> <span class="token function">_rotl32</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> w<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=70><td><pre>        <span class="token comment"># rotate left for 32-bits</span></pre><tr><td data-num=71><td><pre>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>w <span class="token operator"><<</span> r<span class="token punctuation">)</span> <span class="token operator">&</span> self<span class="token punctuation">.</span>_mask<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>w <span class="token operator">>></span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> r<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=72><td><pre></pre><tr><td data-num=73><td><pre></pre><tr><td data-num=74><td><pre><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span></pre><tr><td data-num=75><td><pre>    salsa20 <span class="token operator">=</span> Salsa<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=76><td><pre></pre><tr><td data-num=77><td><pre>    <span class="token comment"># vectors = [</span></pre><tr><td data-num=78><td><pre>    <span class="token comment">#    [[0]*32, [3,1,4,1,5,9,2,6], [7,0,0,0,0,0,0,0],     # 这里就是参数！！！</span></pre><tr><td data-num=79><td><pre>    <span class="token comment">#    [ 0xb9a205a3,0x0695e150,0xaa94881a,0xadb7b12c,</span></pre><tr><td data-num=80><td><pre>    <span class="token comment">#      0x798942d4,0x26107016,0x64edb1a4,0x2d27173f,</span></pre><tr><td data-num=81><td><pre>    <span class="token comment">#      0xb1c7f1fa,0x62066edc,0xe035fa23,0xc4496f04,</span></pre><tr><td data-num=82><td><pre>    <span class="token comment">#      0x2131e6b3,0x810bde28,0xf62cb407,0x6bdede3d ] ] ]</span></pre><tr><td data-num=83><td><pre>    vectors <span class="token operator">=</span> <span class="token punctuation">[</span></pre><tr><td data-num=84><td><pre>        <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>  <span class="token comment"># 这里就是参数！！！</span></pre><tr><td data-num=85><td><pre></pre><tr><td data-num=86><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>vectors<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=87><td><pre>        v <span class="token operator">=</span> vectors<span class="token punctuation">[</span>i<span class="token punctuation">]</span></pre><tr><td data-num=88><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"key => </span><span class="token interpolation"><span class="token punctuation">{</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre><tr><td data-num=89><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"nonce => </span><span class="token interpolation"><span class="token punctuation">{</span>v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre><tr><td data-num=90><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"block_counter => </span><span class="token interpolation"><span class="token punctuation">{</span>v<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre><tr><td data-num=91><td><pre>        s <span class="token operator">=</span> salsa20<span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=92><td><pre>        stream_key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre><tr><td data-num=93><td><pre>        <span class="token comment"># for i in s:</span></pre><tr><td data-num=94><td><pre>        <span class="token comment">#   print(hex(i),end = " ")</span></pre><tr><td data-num=95><td><pre></pre><tr><td data-num=96><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=97><td><pre>            stream_key<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&</span> <span class="token number">0xff</span><span class="token punctuation">)</span></pre><tr><td data-num=98><td><pre>            stream_key<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&</span> <span class="token number">0xff00</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span></pre><tr><td data-num=99><td><pre>            stream_key<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&</span> <span class="token number">0xff0000</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span></pre><tr><td data-num=100><td><pre>            stream_key<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&</span> <span class="token number">0xff000000</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span></pre><tr><td data-num=101><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=102><td><pre>        cybertext <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span></pre><tr><td data-num=103><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>stream_key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=104><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>stream_key<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> cybertext<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span></pre></table></figure><h4 id=chacha20><a class=anchor href=#chacha20>#</a> chacha20</h4><figure class="highlight python"><figcaption data-lang=python></figcaption><table><tr><td data-num=1><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> ChaCha20</pre><tr><td data-num=2><td><pre>key <span class="token operator">=</span> <span class="token string">b'\x07\x05\x0B\x0D\x0F\x0D\x0B\x05\x07\x05\x1B\x1D\x1F\x1D\x1B\x05\x07\x05\x0B\x0D\x0F\x37\x35\x3B\x3D\x3F\x07\x05\x0B\x0D\x0F\x0D'</span></pre><tr><td data-num=3><td><pre>plaintext <span class="token operator">=</span> <span class="token string">b"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_"</span></pre><tr><td data-num=4><td><pre>nonce <span class="token operator">=</span> <span class="token string">b'\x00\x00\x00\x00\x00\x00\x00\x00'</span></pre><tr><td data-num=5><td><pre>cipher <span class="token operator">=</span> ChaCha20<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token operator">=</span>key<span class="token punctuation">,</span>nonce<span class="token operator">=</span>nonce<span class="token punctuation">)</span></pre><tr><td data-num=6><td><pre>ciphertext <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span></pre><tr><td data-num=7><td><pre></pre><tr><td data-num=8><td><pre><span class="token comment"># 获取 nonce（用于解密）</span></pre><tr><td data-num=9><td><pre><span class="token comment"># nonce = cipher.nonce</span></pre><tr><td data-num=10><td><pre></pre><tr><td data-num=11><td><pre></pre><tr><td data-num=12><td><pre><span class="token comment"># 解密</span></pre><tr><td data-num=13><td><pre><span class="token comment"># cipher = ChaCha20.new(key=key, nonce=nonce)</span></pre><tr><td data-num=14><td><pre><span class="token comment"># decrypted_text = cipher.decrypt(ciphertext)</span></pre><tr><td data-num=15><td><pre></pre><tr><td data-num=16><td><pre>a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">hex</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> ciphertext<span class="token punctuation">]</span></pre><tr><td data-num=17><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></table></figure><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&LTstdint.h></span></span></pre><tr><td data-num=2><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&LTstring.h></span></span></pre><tr><td data-num=3><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&LTbits/stdc++.h></span></span></pre><tr><td data-num=4><td><pre><span class="token keyword">static</span> <span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">u32t8le</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span> v<span class="token punctuation">,</span> <span class="token keyword">uint8_t</span> p<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=5><td><pre>	p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> v <span class="token operator">&</span> <span class="token number">0xff</span><span class="token punctuation">;</span></pre><tr><td data-num=6><td><pre>	p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>v <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xff</span><span class="token punctuation">;</span></pre><tr><td data-num=7><td><pre>	p<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>v <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xff</span><span class="token punctuation">;</span></pre><tr><td data-num=8><td><pre>	p<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>v <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xff</span><span class="token punctuation">;</span></pre><tr><td data-num=9><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=10><td><pre></pre><tr><td data-num=11><td><pre><span class="token keyword">static</span> <span class="token keyword">inline</span> <span class="token keyword">uint32_t</span> <span class="token function">u8t32le</span><span class="token punctuation">(</span><span class="token keyword">uint8_t</span> p<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=12><td><pre>	<span class="token keyword">uint32_t</span> value <span class="token operator">=</span> p<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=13><td><pre>	</pre><tr><td data-num=14><td><pre>	value <span class="token operator">=</span> <span class="token punctuation">(</span>value <span class="token operator"><<</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> p<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=15><td><pre>	value <span class="token operator">=</span> <span class="token punctuation">(</span>value <span class="token operator"><<</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=16><td><pre>	value <span class="token operator">=</span> <span class="token punctuation">(</span>value <span class="token operator"><<</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=17><td><pre>	</pre><tr><td data-num=18><td><pre>	<span class="token keyword">return</span> value<span class="token punctuation">;</span></pre><tr><td data-num=19><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=20><td><pre></pre><tr><td data-num=21><td><pre><span class="token keyword">static</span> <span class="token keyword">inline</span> <span class="token keyword">uint32_t</span> <span class="token function">rotl32</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=22><td><pre>	<span class="token comment">// http://blog.regehr.org/archives/1063</span></pre><tr><td data-num=23><td><pre>	<span class="token keyword">return</span> <span class="token generic-function"><span class="token function">x</span> <span class="token generic class-name"><span class="token operator"><<</span> n <span class="token operator">|</span> <span class="token punctuation">(</span>x <span class="token operator">>></span></span></span> <span class="token punctuation">(</span><span class="token operator">-</span>n <span class="token operator">&</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=24><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=25><td><pre></pre><tr><td data-num=26><td><pre><span class="token comment">// https://tools.ietf.org/html/rfc7539##section-2.1</span></pre><tr><td data-num=27><td><pre><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">chacha20_quarterround</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span> <span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">,</span> <span class="token keyword">int</span> d<span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=28><td><pre>	x<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">+=</span> x<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">;</span> x<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">rotl32</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=29><td><pre>	x<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">+=</span> x<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">;</span> x<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">rotl32</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=30><td><pre>	x<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">+=</span> x<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">;</span> x<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">rotl32</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=31><td><pre>	x<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">+=</span> x<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">;</span> x<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">rotl32</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=32><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=33><td><pre></pre><tr><td data-num=34><td><pre><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">chacha20_serialize</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span> in<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">uint8_t</span> output<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=35><td><pre>	<span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=36><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=37><td><pre>		<span class="token function">u32t8le</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> output <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator"><<</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=38><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=39><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=40><td><pre></pre><tr><td data-num=41><td><pre><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">chacha20_block</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span> in<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">uint8_t</span> out<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> num_rounds<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//num_rounds 一般为 20 </span></pre><tr><td data-num=42><td><pre>	<span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=43><td><pre>	<span class="token keyword">uint32_t</span> x<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=44><td><pre>	</pre><tr><td data-num=45><td><pre>	<span class="token function">memcpy</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> in<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=46><td><pre>	</pre><tr><td data-num=47><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> num_rounds<span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    </pre><tr><td data-num=48><td><pre>		<span class="token comment">//odd round</span></pre><tr><td data-num=49><td><pre>		<span class="token function">chacha20_quarterround</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=50><td><pre>		<span class="token function">chacha20_quarterround</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=51><td><pre>		<span class="token function">chacha20_quarterround</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=52><td><pre>		<span class="token function">chacha20_quarterround</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=53><td><pre>		<span class="token comment">//even round </span></pre><tr><td data-num=54><td><pre>		<span class="token function">chacha20_quarterround</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=55><td><pre>		<span class="token function">chacha20_quarterround</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=56><td><pre>		<span class="token function">chacha20_quarterround</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=57><td><pre>		<span class="token function">chacha20_quarterround</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=58><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=59><td><pre>	</pre><tr><td data-num=60><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=61><td><pre>		x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=62><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=63><td><pre>	</pre><tr><td data-num=64><td><pre>	<span class="token function">chacha20_serialize</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=65><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=66><td><pre></pre><tr><td data-num=67><td><pre><span class="token comment">// https://tools.ietf.org/html/rfc7539##section-2.3</span></pre><tr><td data-num=68><td><pre><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">chacha20_init_state</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span> s<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">uint8_t</span> key<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">uint32_t</span> counter<span class="token punctuation">,</span> <span class="token keyword">uint8_t</span> nonce<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=69><td><pre>	<span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=70><td><pre>	</pre><tr><td data-num=71><td><pre>	<span class="token comment">// refer: https://dxr.mozilla.org/mozilla-beta/source/security/nss/lib/freebl/chacha20.c</span></pre><tr><td data-num=72><td><pre>	<span class="token comment">// convert magic number to string: "expand 32-byte k"</span></pre><tr><td data-num=73><td><pre>	s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x61707865</span><span class="token punctuation">;</span></pre><tr><td data-num=74><td><pre>	s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x3320646e</span><span class="token punctuation">;</span></pre><tr><td data-num=75><td><pre>	s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x79622d32</span><span class="token punctuation">;</span></pre><tr><td data-num=76><td><pre>	s<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x6b206574</span><span class="token punctuation">;</span></pre><tr><td data-num=77><td><pre>	</pre><tr><td data-num=78><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=79><td><pre>		s<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">u8t32le</span><span class="token punctuation">(</span>key <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=80><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=81><td><pre>	</pre><tr><td data-num=82><td><pre>	s<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> counter<span class="token punctuation">;</span></pre><tr><td data-num=83><td><pre>	</pre><tr><td data-num=84><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=85><td><pre>		s<span class="token punctuation">[</span><span class="token number">13</span> <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">u8t32le</span><span class="token punctuation">(</span>nonce <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=86><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=87><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=88><td><pre></pre><tr><td data-num=89><td><pre><span class="token keyword">void</span> <span class="token function">ChaCha20XOR</span><span class="token punctuation">(</span><span class="token keyword">uint8_t</span> key<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">uint32_t</span> counter<span class="token punctuation">,</span> <span class="token keyword">uint8_t</span> nonce<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">uint8_t</span> <span class="token operator">*</span>in<span class="token punctuation">,</span> <span class="token keyword">uint8_t</span> <span class="token operator">*</span>out<span class="token punctuation">,</span> <span class="token keyword">int</span> inlen<span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=90><td><pre>	<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span></pre><tr><td data-num=91><td><pre>	</pre><tr><td data-num=92><td><pre>	<span class="token keyword">uint32_t</span> s<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=93><td><pre>	<span class="token keyword">uint8_t</span> block<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=94><td><pre>	</pre><tr><td data-num=95><td><pre>	<span class="token function">chacha20_init_state</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> key<span class="token punctuation">,</span> counter<span class="token punctuation">,</span> nonce<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=96><td><pre>	</pre><tr><td data-num=97><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> inlen<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=98><td><pre>		<span class="token function">chacha20_block</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> block<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=99><td><pre>		s<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span></pre><tr><td data-num=100><td><pre>		</pre><tr><td data-num=101><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator"><</span> i <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=102><td><pre>			<span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">>=</span> inlen<span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=103><td><pre>				<span class="token keyword">break</span><span class="token punctuation">;</span></pre><tr><td data-num=104><td><pre>			<span class="token punctuation">}</span></pre><tr><td data-num=105><td><pre>			out<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> in<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">^</span> block<span class="token punctuation">[</span>j <span class="token operator">-</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=106><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=107><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=108><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=109><td><pre></pre><tr><td data-num=110><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=111><td><pre>	<span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=112><td><pre>	</pre><tr><td data-num=113><td><pre>	<span class="token keyword">uint8_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=114><td><pre>		<span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span></pre><tr><td data-num=115><td><pre>		<span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span></pre><tr><td data-num=116><td><pre>		<span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span></pre><tr><td data-num=117><td><pre>		<span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x0f</span><span class="token punctuation">,</span></pre><tr><td data-num=118><td><pre>		<span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span></pre><tr><td data-num=119><td><pre>		<span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span></pre><tr><td data-num=120><td><pre>		<span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x1a</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span></pre><tr><td data-num=121><td><pre>		<span class="token number">0x1c</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x1e</span><span class="token punctuation">,</span> <span class="token number">0x1f</span></pre><tr><td data-num=122><td><pre>	<span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=123><td><pre>	</pre><tr><td data-num=124><td><pre>	<span class="token keyword">uint8_t</span> nonce<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>                <span class="token comment">// 随机数 </span></pre><tr><td data-num=125><td><pre>		<span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span></pre><tr><td data-num=126><td><pre>	<span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=127><td><pre>	</pre><tr><td data-num=128><td><pre>	<span class="token keyword">uint8_t</span> input<span class="token punctuation">[</span><span class="token number">114</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=129><td><pre>		<span class="token number">0x4c</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0x6e</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x6e</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x6c</span></pre><tr><td data-num=130><td><pre>	<span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=131><td><pre>	</pre><tr><td data-num=132><td><pre>	<span class="token keyword">uint8_t</span> encrypt<span class="token punctuation">[</span><span class="token number">114</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=133><td><pre>	<span class="token keyword">uint8_t</span> decrypt<span class="token punctuation">[</span><span class="token number">114</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=134><td><pre>	</pre><tr><td data-num=135><td><pre>	<span class="token keyword">int</span> counter <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre><tr><td data-num=136><td><pre>	</pre><tr><td data-num=137><td><pre>	<span class="token function">ChaCha20XOR</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> counter<span class="token punctuation">,</span> nonce<span class="token punctuation">,</span> input<span class="token punctuation">,</span> encrypt<span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             </pre><tr><td data-num=138><td><pre>	<span class="token function">ChaCha20XOR</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> counter<span class="token punctuation">,</span> nonce<span class="token punctuation">,</span> encrypt<span class="token punctuation">,</span> decrypt<span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=139><td><pre>	</pre><tr><td data-num=140><td><pre>	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nkey:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=141><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> <span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=142><td><pre>		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=143><td><pre>			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=144><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=145><td><pre>		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%02x "</span><span class="token punctuation">,</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=146><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=147><td><pre>	</pre><tr><td data-num=148><td><pre>	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n\nnonce:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=149><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> <span class="token number">12</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=150><td><pre>		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%02x "</span><span class="token punctuation">,</span> nonce<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=151><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=152><td><pre>	</pre><tr><td data-num=153><td><pre>	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n\nplaintext:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=154><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> <span class="token number">114</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=155><td><pre>		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=156><td><pre>			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=157><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=158><td><pre>		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%02x "</span><span class="token punctuation">,</span> input<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=159><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=160><td><pre>	</pre><tr><td data-num=161><td><pre>	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n\nencrypted:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=162><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> <span class="token number">114</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=163><td><pre>		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=164><td><pre>			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=165><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=166><td><pre>		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%02x "</span><span class="token punctuation">,</span> encrypt<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=167><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=168><td><pre>	</pre><tr><td data-num=169><td><pre>	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n\ndecrypted:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=170><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> <span class="token number">114</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=171><td><pre>		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=172><td><pre>			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=173><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=174><td><pre>		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%02x "</span><span class="token punctuation">,</span> decrypt<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=175><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=176><td><pre>	</pre><tr><td data-num=177><td><pre>	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=178><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=179><td><pre><span class="token punctuation">}</span></pre></table></figure><h4 id=zuc><a class=anchor href=#zuc>#</a> ZUC</h4><p>未测试过，没找到合适的标准库<figure class="highlight python"><figcaption data-lang=python></figcaption><table><tr><td data-num=1><td><pre><span class="token keyword">from</span> math <span class="token keyword">import</span> ceil</pre><tr><td data-num=2><td><pre> </pre><tr><td data-num=3><td><pre>S0 <span class="token operator">=</span> <span class="token punctuation">[</span></pre><tr><td data-num=4><td><pre>    <span class="token number">0x3E</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0x5B</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0xCA</span><span class="token punctuation">,</span> <span class="token number">0xE0</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0xD1</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0xB9</span><span class="token punctuation">,</span> <span class="token number">0x6D</span><span class="token punctuation">,</span> <span class="token number">0xCB</span><span class="token punctuation">,</span></pre><tr><td data-num=5><td><pre>    <span class="token number">0x7B</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0xAF</span><span class="token punctuation">,</span> <span class="token number">0x9D</span><span class="token punctuation">,</span> <span class="token number">0x6A</span><span class="token punctuation">,</span> <span class="token number">0xA5</span><span class="token punctuation">,</span> <span class="token number">0xB8</span><span class="token punctuation">,</span> <span class="token number">0x2D</span><span class="token punctuation">,</span> <span class="token number">0xFC</span><span class="token punctuation">,</span> <span class="token number">0x1D</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span></pre><tr><td data-num=6><td><pre>    <span class="token number">0x4D</span><span class="token punctuation">,</span> <span class="token number">0x4E</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0xE4</span><span class="token punctuation">,</span> <span class="token number">0xCE</span><span class="token punctuation">,</span> <span class="token number">0xD9</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0xDD</span><span class="token punctuation">,</span> <span class="token number">0xB6</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x8B</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0x6E</span><span class="token punctuation">,</span> <span class="token number">0xAC</span><span class="token punctuation">,</span></pre><tr><td data-num=7><td><pre>    <span class="token number">0xCD</span><span class="token punctuation">,</span> <span class="token number">0xC1</span><span class="token punctuation">,</span> <span class="token number">0xF8</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0xB5</span><span class="token punctuation">,</span> <span class="token number">0xBD</span><span class="token punctuation">,</span> <span class="token number">0xFD</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0xD4</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span></pre><tr><td data-num=8><td><pre>    <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x7D</span><span class="token punctuation">,</span> <span class="token number">0xB2</span><span class="token punctuation">,</span> <span class="token number">0xA7</span><span class="token punctuation">,</span> <span class="token number">0xCF</span><span class="token punctuation">,</span> <span class="token number">0xED</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0xC5</span><span class="token punctuation">,</span> <span class="token number">0xF3</span><span class="token punctuation">,</span> <span class="token number">0x2C</span><span class="token punctuation">,</span> <span class="token number">0xBB</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x9B</span><span class="token punctuation">,</span></pre><tr><td data-num=9><td><pre>    <span class="token number">0xE3</span><span class="token punctuation">,</span> <span class="token number">0xEF</span><span class="token punctuation">,</span> <span class="token number">0x5E</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x4F</span><span class="token punctuation">,</span> <span class="token number">0x7F</span><span class="token punctuation">,</span> <span class="token number">0x5A</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x5F</span><span class="token punctuation">,</span> <span class="token number">0xBA</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0x1C</span><span class="token punctuation">,</span></pre><tr><td data-num=10><td><pre>    <span class="token number">0x4A</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0xD5</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0xA8</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">,</span> <span class="token number">0x8C</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xD8</span><span class="token punctuation">,</span> <span class="token number">0xAE</span><span class="token punctuation">,</span> <span class="token number">0x2E</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xD3</span><span class="token punctuation">,</span> <span class="token number">0xAD</span><span class="token punctuation">,</span></pre><tr><td data-num=11><td><pre>    <span class="token number">0x3B</span><span class="token punctuation">,</span> <span class="token number">0x4B</span><span class="token punctuation">,</span> <span class="token number">0xDA</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0xEB</span><span class="token punctuation">,</span> <span class="token number">0xC9</span><span class="token punctuation">,</span> <span class="token number">0xDE</span><span class="token punctuation">,</span> <span class="token number">0x9A</span><span class="token punctuation">,</span> <span class="token number">0x8F</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0xD7</span><span class="token punctuation">,</span> <span class="token number">0x3A</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x6F</span><span class="token punctuation">,</span> <span class="token number">0x2F</span><span class="token punctuation">,</span> <span class="token number">0xC8</span><span class="token punctuation">,</span></pre><tr><td data-num=12><td><pre>    <span class="token number">0xB1</span><span class="token punctuation">,</span> <span class="token number">0xB4</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0xF7</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0x7C</span><span class="token punctuation">,</span> <span class="token number">0xCC</span><span class="token punctuation">,</span> <span class="token number">0x3C</span><span class="token punctuation">,</span> <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0xC7</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span></pre><tr><td data-num=13><td><pre>    <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0xBF</span><span class="token punctuation">,</span> <span class="token number">0x7E</span><span class="token punctuation">,</span> <span class="token number">0xF0</span><span class="token punctuation">,</span> <span class="token number">0x0B</span><span class="token punctuation">,</span> <span class="token number">0x2B</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0xA6</span><span class="token punctuation">,</span> <span class="token number">0x4C</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0xFE</span><span class="token punctuation">,</span></pre><tr><td data-num=14><td><pre>    <span class="token number">0xBC</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x8A</span><span class="token punctuation">,</span> <span class="token number">0xB0</span><span class="token punctuation">,</span> <span class="token number">0xA3</span><span class="token punctuation">,</span> <span class="token number">0xFB</span><span class="token punctuation">,</span> <span class="token number">0xC0</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0xF2</span><span class="token punctuation">,</span> <span class="token number">0xE1</span><span class="token punctuation">,</span> <span class="token number">0xE5</span><span class="token punctuation">,</span> <span class="token number">0xE9</span><span class="token punctuation">,</span> <span class="token number">0x5D</span><span class="token punctuation">,</span></pre><tr><td data-num=15><td><pre>    <span class="token number">0xD0</span><span class="token punctuation">,</span> <span class="token number">0xDC</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x5C</span><span class="token punctuation">,</span> <span class="token number">0xEC</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0xF5</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x9C</span><span class="token punctuation">,</span> <span class="token number">0xAA</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span></pre><tr><td data-num=16><td><pre>    <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0xAB</span><span class="token punctuation">,</span> <span class="token number">0xBE</span><span class="token punctuation">,</span> <span class="token number">0x2A</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xE6</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0xA2</span><span class="token punctuation">,</span> <span class="token number">0x6C</span><span class="token punctuation">,</span> <span class="token number">0xC2</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x9F</span><span class="token punctuation">,</span> <span class="token number">0xF1</span><span class="token punctuation">,</span></pre><tr><td data-num=17><td><pre>    <span class="token number">0xF6</span><span class="token punctuation">,</span> <span class="token number">0xFA</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0xD2</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x9E</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x3D</span><span class="token punctuation">,</span> <span class="token number">0xD6</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0xC4</span><span class="token punctuation">,</span> <span class="token number">0xE2</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">,</span></pre><tr><td data-num=18><td><pre>    <span class="token number">0x8E</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0x6B</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x3F</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0xEA</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0xB7</span><span class="token punctuation">,</span> <span class="token number">0xA1</span><span class="token punctuation">,</span> <span class="token number">0xE8</span><span class="token punctuation">,</span> <span class="token number">0xA9</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span></pre><tr><td data-num=19><td><pre>    <span class="token number">0x8D</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x1A</span><span class="token punctuation">,</span> <span class="token number">0xDB</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xB3</span><span class="token punctuation">,</span> <span class="token number">0xA0</span><span class="token punctuation">,</span> <span class="token number">0xF4</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0x7A</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0xDF</span><span class="token punctuation">,</span> <span class="token number">0xEE</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0x60</span></pre><tr><td data-num=20><td><pre><span class="token punctuation">]</span></pre><tr><td data-num=21><td><pre> </pre><tr><td data-num=22><td><pre>S1 <span class="token operator">=</span> <span class="token punctuation">[</span></pre><tr><td data-num=23><td><pre>    <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0xC2</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0x3B</span><span class="token punctuation">,</span> <span class="token number">0xC8</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x9F</span><span class="token punctuation">,</span> <span class="token number">0x3C</span><span class="token punctuation">,</span> <span class="token number">0xDA</span><span class="token punctuation">,</span> <span class="token number">0x5B</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xAA</span><span class="token punctuation">,</span> <span class="token number">0xFD</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span></pre><tr><td data-num=24><td><pre>    <span class="token number">0x8C</span><span class="token punctuation">,</span> <span class="token number">0xC5</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> <span class="token number">0xA6</span><span class="token punctuation">,</span> <span class="token number">0x1A</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0xE3</span><span class="token punctuation">,</span> <span class="token number">0xA8</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span> <span class="token number">0xF8</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span></pre><tr><td data-num=25><td><pre>    <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xD9</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0x3E</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0xA7</span><span class="token punctuation">,</span> <span class="token number">0x8B</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0xE1</span><span class="token punctuation">,</span></pre><tr><td data-num=26><td><pre>    <span class="token number">0x3A</span><span class="token punctuation">,</span> <span class="token number">0xB5</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x2A</span><span class="token punctuation">,</span> <span class="token number">0xC0</span><span class="token punctuation">,</span> <span class="token number">0x6D</span><span class="token punctuation">,</span> <span class="token number">0xB3</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0xBF</span><span class="token punctuation">,</span> <span class="token number">0xDC</span><span class="token punctuation">,</span> <span class="token number">0x0B</span><span class="token punctuation">,</span> <span class="token number">0xFA</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span></pre><tr><td data-num=27><td><pre>    <span class="token number">0xDD</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0xC9</span><span class="token punctuation">,</span> <span class="token number">0xC1</span><span class="token punctuation">,</span> <span class="token number">0xCF</span><span class="token punctuation">,</span> <span class="token number">0xF6</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0xBB</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0xF5</span><span class="token punctuation">,</span> <span class="token number">0xD4</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span></pre><tr><td data-num=28><td><pre>    <span class="token number">0x7F</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span> <span class="token number">0x4C</span><span class="token punctuation">,</span> <span class="token number">0xD2</span><span class="token punctuation">,</span> <span class="token number">0x9C</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">,</span> <span class="token number">0xBC</span><span class="token punctuation">,</span> <span class="token number">0x4F</span><span class="token punctuation">,</span> <span class="token number">0x9A</span><span class="token punctuation">,</span> <span class="token number">0xDF</span><span class="token punctuation">,</span> <span class="token number">0xFE</span><span class="token punctuation">,</span> <span class="token number">0xD6</span><span class="token punctuation">,</span> <span class="token number">0x8D</span><span class="token punctuation">,</span> <span class="token number">0x7A</span><span class="token punctuation">,</span> <span class="token number">0xEB</span><span class="token punctuation">,</span></pre><tr><td data-num=29><td><pre>    <span class="token number">0x2B</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0xD8</span><span class="token punctuation">,</span> <span class="token number">0x5C</span><span class="token punctuation">,</span> <span class="token number">0xA1</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0xFB</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0xD5</span><span class="token punctuation">,</span> <span class="token number">0x7D</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span></pre><tr><td data-num=30><td><pre>    <span class="token number">0xEE</span><span class="token punctuation">,</span> <span class="token number">0xB7</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x3F</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0xB2</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x8E</span><span class="token punctuation">,</span> <span class="token number">0x4E</span><span class="token punctuation">,</span> <span class="token number">0xE5</span><span class="token punctuation">,</span> <span class="token number">0x4B</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x8F</span><span class="token punctuation">,</span> <span class="token number">0x5D</span><span class="token punctuation">,</span> <span class="token number">0xDB</span><span class="token punctuation">,</span> <span class="token number">0xA9</span><span class="token punctuation">,</span></pre><tr><td data-num=31><td><pre>    <span class="token number">0xAD</span><span class="token punctuation">,</span> <span class="token number">0xF1</span><span class="token punctuation">,</span> <span class="token number">0xAE</span><span class="token punctuation">,</span> <span class="token number">0x2E</span><span class="token punctuation">,</span> <span class="token number">0xCB</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0xFC</span><span class="token punctuation">,</span> <span class="token number">0xF4</span><span class="token punctuation">,</span> <span class="token number">0x2D</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0x6E</span><span class="token punctuation">,</span> <span class="token number">0x1D</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0xE8</span><span class="token punctuation">,</span> <span class="token number">0xD1</span><span class="token punctuation">,</span> <span class="token number">0xE9</span><span class="token punctuation">,</span></pre><tr><td data-num=32><td><pre>    <span class="token number">0x4D</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0xA5</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0x5E</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x9E</span><span class="token punctuation">,</span> <span class="token number">0xAB</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0x9D</span><span class="token punctuation">,</span> <span class="token number">0xB9</span><span class="token punctuation">,</span> <span class="token number">0x1C</span><span class="token punctuation">,</span> <span class="token number">0xE0</span><span class="token punctuation">,</span> <span class="token number">0xCD</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x89</span><span class="token punctuation">,</span></pre><tr><td data-num=33><td><pre>    <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xB6</span><span class="token punctuation">,</span> <span class="token number">0xBD</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0xA2</span><span class="token punctuation">,</span> <span class="token number">0x5F</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0xB8</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0xE4</span><span class="token punctuation">,</span></pre><tr><td data-num=34><td><pre>    <span class="token number">0xD0</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0xC7</span><span class="token punctuation">,</span> <span class="token number">0xCE</span><span class="token punctuation">,</span> <span class="token number">0xED</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">,</span> <span class="token number">0xB4</span><span class="token punctuation">,</span> <span class="token number">0x6F</span><span class="token punctuation">,</span> <span class="token number">0xA0</span><span class="token punctuation">,</span> <span class="token number">0xCC</span><span class="token punctuation">,</span> <span class="token number">0xF0</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x4A</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0xDE</span><span class="token punctuation">,</span></pre><tr><td data-num=35><td><pre>    <span class="token number">0xA3</span><span class="token punctuation">,</span> <span class="token number">0xEF</span><span class="token punctuation">,</span> <span class="token number">0xEA</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0xE6</span><span class="token punctuation">,</span> <span class="token number">0x6B</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0xEC</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">,</span> <span class="token number">0x2C</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xF7</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span></pre><tr><td data-num=36><td><pre>    <span class="token number">0x5A</span><span class="token punctuation">,</span> <span class="token number">0x6A</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0xC4</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0xBA</span><span class="token punctuation">,</span> <span class="token number">0x7E</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span></pre><tr><td data-num=37><td><pre>    <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0xB1</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x7C</span><span class="token punctuation">,</span> <span class="token number">0xF3</span><span class="token punctuation">,</span> <span class="token number">0x3D</span><span class="token punctuation">,</span> <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x6C</span><span class="token punctuation">,</span> <span class="token number">0x7B</span><span class="token punctuation">,</span> <span class="token number">0xCA</span><span class="token punctuation">,</span> <span class="token number">0xD3</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span></pre><tr><td data-num=38><td><pre>    <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0xBE</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0x9B</span><span class="token punctuation">,</span> <span class="token number">0x2F</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x8A</span><span class="token punctuation">,</span> <span class="token number">0xD7</span><span class="token punctuation">,</span> <span class="token number">0xB0</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0xAC</span><span class="token punctuation">,</span> <span class="token number">0xAF</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0xE2</span><span class="token punctuation">,</span> <span class="token number">0xF2</span></pre><tr><td data-num=39><td><pre><span class="token punctuation">]</span></pre><tr><td data-num=40><td><pre> </pre><tr><td data-num=41><td><pre>D <span class="token operator">=</span> <span class="token punctuation">[</span></pre><tr><td data-num=42><td><pre>    <span class="token number">0x44D7</span><span class="token punctuation">,</span> <span class="token number">0x26BC</span><span class="token punctuation">,</span> <span class="token number">0x626B</span><span class="token punctuation">,</span> <span class="token number">0x135E</span><span class="token punctuation">,</span> <span class="token number">0x5789</span><span class="token punctuation">,</span> <span class="token number">0x35E2</span><span class="token punctuation">,</span> <span class="token number">0x7135</span><span class="token punctuation">,</span> <span class="token number">0x09AF</span><span class="token punctuation">,</span></pre><tr><td data-num=43><td><pre>    <span class="token number">0x4D78</span><span class="token punctuation">,</span> <span class="token number">0x2F13</span><span class="token punctuation">,</span> <span class="token number">0x6BC4</span><span class="token punctuation">,</span> <span class="token number">0x1AF1</span><span class="token punctuation">,</span> <span class="token number">0x5E26</span><span class="token punctuation">,</span> <span class="token number">0x3C4D</span><span class="token punctuation">,</span> <span class="token number">0x789A</span><span class="token punctuation">,</span> <span class="token number">0x47AC</span></pre><tr><td data-num=44><td><pre><span class="token punctuation">]</span></pre><tr><td data-num=45><td><pre> </pre><tr><td data-num=46><td><pre> </pre><tr><td data-num=47><td><pre><span class="token keyword">def</span> <span class="token function">addition_uint31</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=48><td><pre>    c <span class="token operator">=</span> a <span class="token operator">+</span> b</pre><tr><td data-num=49><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">(</span>c <span class="token operator">&</span> <span class="token number">0x7FFFFFFF</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>c <span class="token operator">>></span> <span class="token number">31</span><span class="token punctuation">)</span></pre><tr><td data-num=50><td><pre> </pre><tr><td data-num=51><td><pre> </pre><tr><td data-num=52><td><pre><span class="token keyword">def</span> <span class="token function">rotl_uint31</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> shift<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=53><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator"><<</span> shift<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>a <span class="token operator">>></span> <span class="token punctuation">(</span><span class="token number">31</span> <span class="token operator">-</span> shift<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0x7FFFFFFF</span></pre><tr><td data-num=54><td><pre> </pre><tr><td data-num=55><td><pre> </pre><tr><td data-num=56><td><pre><span class="token keyword">def</span> <span class="token function">rotl_uint32</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> shift<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=57><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator"><<</span> shift<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>a <span class="token operator">>></span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> shift<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xFFFFFFFF</span></pre><tr><td data-num=58><td><pre> </pre><tr><td data-num=59><td><pre> </pre><tr><td data-num=60><td><pre><span class="token keyword">def</span> <span class="token function">l1</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=61><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">(</span>x <span class="token operator">^</span> rotl_uint32<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">^</span> rotl_uint32<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">^</span> rotl_uint32<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span> <span class="token operator">^</span> rotl_uint32<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=62><td><pre> </pre><tr><td data-num=63><td><pre> </pre><tr><td data-num=64><td><pre><span class="token keyword">def</span> <span class="token function">l2</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=65><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">(</span>x <span class="token operator">^</span> rotl_uint32<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">^</span> rotl_uint32<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span> <span class="token operator">^</span> rotl_uint32<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span> <span class="token operator">^</span> rotl_uint32<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=66><td><pre> </pre><tr><td data-num=67><td><pre> </pre><tr><td data-num=68><td><pre><span class="token keyword">def</span> <span class="token function">make_uint32</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=69><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator"><<</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator"><<</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>c <span class="token operator"><<</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span> d</pre><tr><td data-num=70><td><pre> </pre><tr><td data-num=71><td><pre> </pre><tr><td data-num=72><td><pre><span class="token keyword">def</span> <span class="token function">make_uint31</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=73><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator"><<</span> <span class="token number">23</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0x7fffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator"><<</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0x7fffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span> c</pre><tr><td data-num=74><td><pre> </pre><tr><td data-num=75><td><pre> </pre><tr><td data-num=76><td><pre><span class="token keyword">class</span> <span class="token class-name">ZUC</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=77><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=78><td><pre>        self<span class="token punctuation">.</span>r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span></pre><tr><td data-num=79><td><pre>        self<span class="token punctuation">.</span>lfsr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=80><td><pre>        self<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span></pre><tr><td data-num=81><td><pre>        self<span class="token punctuation">.</span>zuc_init<span class="token punctuation">(</span>key<span class="token punctuation">,</span> iv<span class="token punctuation">)</span></pre><tr><td data-num=82><td><pre> </pre><tr><td data-num=83><td><pre>    <span class="token keyword">def</span> <span class="token function">bit_reorganization</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=84><td><pre>        self<span class="token punctuation">.</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">&</span> <span class="token number">0x7FFF8000</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">&</span> <span class="token number">0xFFFF</span><span class="token punctuation">)</span></pre><tr><td data-num=85><td><pre>        self<span class="token punctuation">.</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">&</span> <span class="token number">0xFFFF</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">15</span><span class="token punctuation">)</span></pre><tr><td data-num=86><td><pre>        self<span class="token punctuation">.</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&</span> <span class="token number">0xFFFF</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">15</span><span class="token punctuation">)</span></pre><tr><td data-num=87><td><pre>        self<span class="token punctuation">.</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&</span> <span class="token number">0xFFFF</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">15</span><span class="token punctuation">)</span></pre><tr><td data-num=88><td><pre> </pre><tr><td data-num=89><td><pre>    <span class="token keyword">def</span> <span class="token function">lfsr_next</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=90><td><pre>        f <span class="token operator">=</span> self<span class="token punctuation">.</span>lfsr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre><tr><td data-num=91><td><pre>        v <span class="token operator">=</span> rotl_uint31<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span></pre><tr><td data-num=92><td><pre>        f <span class="token operator">=</span> addition_uint31<span class="token punctuation">(</span>f<span class="token punctuation">,</span> v<span class="token punctuation">)</span></pre><tr><td data-num=93><td><pre>        v <span class="token operator">=</span> rotl_uint31<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span></pre><tr><td data-num=94><td><pre>        f <span class="token operator">=</span> addition_uint31<span class="token punctuation">(</span>f<span class="token punctuation">,</span> v<span class="token punctuation">)</span></pre><tr><td data-num=95><td><pre>        v <span class="token operator">=</span> rotl_uint31<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span></pre><tr><td data-num=96><td><pre>        f <span class="token operator">=</span> addition_uint31<span class="token punctuation">(</span>f<span class="token punctuation">,</span> v<span class="token punctuation">)</span></pre><tr><td data-num=97><td><pre>        v <span class="token operator">=</span> rotl_uint31<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span></pre><tr><td data-num=98><td><pre>        f <span class="token operator">=</span> addition_uint31<span class="token punctuation">(</span>f<span class="token punctuation">,</span> v<span class="token punctuation">)</span></pre><tr><td data-num=99><td><pre>        v <span class="token operator">=</span> rotl_uint31<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span></pre><tr><td data-num=100><td><pre>        f <span class="token operator">=</span> addition_uint31<span class="token punctuation">(</span>f<span class="token punctuation">,</span> v<span class="token punctuation">)</span></pre><tr><td data-num=101><td><pre>        <span class="token keyword">return</span> f</pre><tr><td data-num=102><td><pre> </pre><tr><td data-num=103><td><pre>    <span class="token keyword">def</span> <span class="token function">lfsr_append</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=104><td><pre>        self<span class="token punctuation">.</span>lfsr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>f<span class="token punctuation">)</span></pre><tr><td data-num=105><td><pre>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">16</span><span class="token punctuation">:</span></pre><tr><td data-num=106><td><pre>            self<span class="token punctuation">.</span>lfsr<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></pre><tr><td data-num=107><td><pre> </pre><tr><td data-num=108><td><pre>    <span class="token keyword">def</span> <span class="token function">lfsr_init</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> u<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=109><td><pre>        self<span class="token punctuation">.</span>lfsr_append<span class="token punctuation">(</span>addition_uint31<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr_next<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> u<span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=110><td><pre> </pre><tr><td data-num=111><td><pre>    <span class="token keyword">def</span> <span class="token function">lfsr_shift</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=112><td><pre>        self<span class="token punctuation">.</span>lfsr_append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lfsr_next<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=113><td><pre> </pre><tr><td data-num=114><td><pre>    <span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=115><td><pre>        W <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> self<span class="token punctuation">.</span>r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>r<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xffffffff</span></pre><tr><td data-num=116><td><pre>        W1 <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xffffffff</span></pre><tr><td data-num=117><td><pre>        W2 <span class="token operator">=</span> self<span class="token punctuation">.</span>r<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> self<span class="token punctuation">.</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span></pre><tr><td data-num=118><td><pre>        u <span class="token operator">=</span> l1<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>W1 <span class="token operator">&</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>W2 <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=119><td><pre>        v <span class="token operator">=</span> l2<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>W2 <span class="token operator">&</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>W1 <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=120><td><pre>        self<span class="token punctuation">.</span>r <span class="token operator">=</span> <span class="token punctuation">[</span>make_uint32<span class="token punctuation">(</span>S0<span class="token punctuation">[</span>u <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span> S1<span class="token punctuation">[</span><span class="token punctuation">(</span>u <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre><tr><td data-num=121><td><pre>                              S0<span class="token punctuation">[</span><span class="token punctuation">(</span>u <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">]</span><span class="token punctuation">,</span> S1<span class="token punctuation">[</span>u <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre><tr><td data-num=122><td><pre>                  make_uint32<span class="token punctuation">(</span>S0<span class="token punctuation">[</span>v <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span> S1<span class="token punctuation">[</span><span class="token punctuation">(</span>v <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre><tr><td data-num=123><td><pre>                              S0<span class="token punctuation">[</span><span class="token punctuation">(</span>v <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">]</span><span class="token punctuation">,</span> S1<span class="token punctuation">[</span>v <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=124><td><pre>        <span class="token keyword">return</span> W</pre><tr><td data-num=125><td><pre> </pre><tr><td data-num=126><td><pre>    <span class="token keyword">def</span> <span class="token function">zuc_init</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=127><td><pre>        <span class="token comment"># Expand key.</span></pre><tr><td data-num=128><td><pre>        self<span class="token punctuation">.</span>lfsr <span class="token operator">=</span> <span class="token punctuation">[</span>make_uint31<span class="token punctuation">(</span>key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> iv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=129><td><pre>        self<span class="token punctuation">.</span>r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span></pre><tr><td data-num=130><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=131><td><pre>            self<span class="token punctuation">.</span>bit_reorganization<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=132><td><pre>            w <span class="token operator">=</span> self<span class="token punctuation">.</span>f<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=133><td><pre>            self<span class="token punctuation">.</span>lfsr_init<span class="token punctuation">(</span>w <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">)</span></pre><tr><td data-num=134><td><pre> </pre><tr><td data-num=135><td><pre>    <span class="token keyword">def</span> <span class="token function">zuc_generate_keystream</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=136><td><pre>        keystream_buffer <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre><tr><td data-num=137><td><pre>        self<span class="token punctuation">.</span>bit_reorganization<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=138><td><pre>        self<span class="token punctuation">.</span>f<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># Discard the output of F.</span></pre><tr><td data-num=139><td><pre> </pre><tr><td data-num=140><td><pre>        <span class="token keyword">def</span> <span class="token function">itor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=141><td><pre>            self<span class="token punctuation">.</span>lfsr_shift<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=142><td><pre>            self<span class="token punctuation">.</span>bit_reorganization<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=143><td><pre>            <span class="token keyword">return</span> self<span class="token punctuation">.</span>f<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">^</span> self<span class="token punctuation">.</span>x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></pre><tr><td data-num=144><td><pre> </pre><tr><td data-num=145><td><pre>        keystream_buffer <span class="token operator">=</span> <span class="token punctuation">[</span>itor<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=146><td><pre>        self<span class="token punctuation">.</span>lfsr_shift<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=147><td><pre>        <span class="token keyword">return</span> keystream_buffer</pre><tr><td data-num=148><td><pre> </pre><tr><td data-num=149><td><pre>    <span class="token keyword">def</span> <span class="token function">zuc_encrypt</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">input</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=150><td><pre>        length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span></pre><tr><td data-num=151><td><pre>        key_stream <span class="token operator">=</span> self<span class="token punctuation">.</span>zuc_generate_keystream<span class="token punctuation">(</span>length<span class="token punctuation">)</span></pre><tr><td data-num=152><td><pre>        <span class="token keyword">return</span> <span class="token punctuation">[</span>inp <span class="token operator">^</span> key_stream<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i<span class="token punctuation">,</span> inp <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=153><td><pre> </pre><tr><td data-num=154><td><pre> </pre><tr><td data-num=155><td><pre><span class="token keyword">if</span> <span class="token string">'__main__'</span> <span class="token operator">==</span> __name__<span class="token punctuation">:</span></pre><tr><td data-num=156><td><pre>    key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">16</span></pre><tr><td data-num=157><td><pre>    iv <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">16</span></pre><tr><td data-num=158><td><pre>    zuc <span class="token operator">=</span> ZUC<span class="token punctuation">(</span>key<span class="token punctuation">,</span> iv<span class="token punctuation">)</span></pre><tr><td data-num=159><td><pre>    <span class="token comment"># 加密过程</span></pre><tr><td data-num=160><td><pre>    out <span class="token operator">=</span> zuc<span class="token punctuation">.</span>zuc_encrypt<span class="token punctuation">(</span><span class="token string">b"i love u"</span><span class="token punctuation">)</span></pre><tr><td data-num=161><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"加密得到的字流"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"%08x"</span> <span class="token operator">%</span> e <span class="token keyword">for</span> e <span class="token keyword">in</span> out<span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=162><td><pre>    <span class="token comment"># 解密过程</span></pre><tr><td data-num=163><td><pre>    zuc2 <span class="token operator">=</span> ZUC<span class="token punctuation">(</span>key<span class="token punctuation">,</span> iv<span class="token punctuation">)</span></pre><tr><td data-num=164><td><pre>    out2 <span class="token operator">=</span> zuc2<span class="token punctuation">.</span>zuc_encrypt<span class="token punctuation">(</span>out<span class="token punctuation">)</span></pre><tr><td data-num=165><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"解密得到的字流"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"%08x"</span> <span class="token operator">%</span> e <span class="token keyword">for</span> e <span class="token keyword">in</span> out2<span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=166><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>out2<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></table></figure><h2 id=分组><a class=anchor href=#分组>#</a> 分组</h2><h3 id=tea><a class=anchor href=#tea>#</a> TEA</h3><h4 id=tea-2><a class=anchor href=#tea-2>#</a> TEA</h4><figure class="highlight c"><figcaption data-lang=c></figcaption><table><tr><td data-num=1><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">uint</span> <span class="token expression"><span class="token keyword">unsigned</span> <span class="token keyword">int</span></span></span></pre><tr><td data-num=2><td><pre><span class="token keyword">void</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>uint <span class="token operator">*</span>v<span class="token punctuation">,</span> uint <span class="token operator">*</span>key<span class="token punctuation">)</span></pre><tr><td data-num=3><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=4><td><pre>	uint l <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> delta <span class="token operator">=</span> <span class="token number">0x9e3779b9</span><span class="token punctuation">;</span></pre><tr><td data-num=5><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator"><=</span> <span class="token number">32</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span></pre><tr><td data-num=6><td><pre>	<span class="token punctuation">{</span></pre><tr><td data-num=7><td><pre>		sum <span class="token operator">+=</span> delta<span class="token punctuation">;</span></pre><tr><td data-num=8><td><pre>		l <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator"><<</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>r <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=9><td><pre>		r <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator"><<</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=10><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=11><td><pre>	v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">;</span></pre><tr><td data-num=12><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=13><td><pre><span class="token keyword">void</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>uint <span class="token operator">*</span>v<span class="token punctuation">,</span> uint <span class="token operator">*</span>key<span class="token punctuation">)</span></pre><tr><td data-num=14><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=15><td><pre>	uint l <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> delta <span class="token operator">=</span> <span class="token number">0x9e3779b9</span><span class="token punctuation">;</span></pre><tr><td data-num=16><td><pre>	sum <span class="token operator">=</span> delta <span class="token operator">*</span> <span class="token number">32</span><span class="token punctuation">;</span></pre><tr><td data-num=17><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator"><=</span> <span class="token number">32</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span></pre><tr><td data-num=18><td><pre>	<span class="token punctuation">{</span></pre><tr><td data-num=19><td><pre>		r <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator"><<</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=20><td><pre>		l <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator"><<</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>r <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=21><td><pre>		sum <span class="token operator">-=</span> delta<span class="token punctuation">;</span></pre><tr><td data-num=22><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=23><td><pre>	v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">;</span></pre><tr><td data-num=24><td><pre><span class="token punctuation">}</span></pre></table></figure><h4 id=xtea><a class=anchor href=#xtea>#</a> XTEA</h4><figure class="highlight c"><figcaption data-lang=c></figcaption><table><tr><td data-num=1><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">uint</span> <span class="token expression"><span class="token keyword">unsigned</span> <span class="token keyword">int</span></span></span></pre><tr><td data-num=2><td><pre><span class="token keyword">void</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>uint <span class="token operator">*</span>v<span class="token punctuation">,</span> uint <span class="token operator">*</span>key<span class="token punctuation">)</span></pre><tr><td data-num=3><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=4><td><pre>	uint l <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> delta <span class="token operator">=</span> <span class="token number">0x9e3779b9</span><span class="token punctuation">;</span></pre><tr><td data-num=5><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator"><=</span> <span class="token number">32</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span></pre><tr><td data-num=6><td><pre>	<span class="token punctuation">{</span></pre><tr><td data-num=7><td><pre>		l <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator"><<</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>r <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> key<span class="token punctuation">[</span>sum <span class="token operator">&</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=8><td><pre>		sum <span class="token operator">+=</span> delta<span class="token punctuation">;</span></pre><tr><td data-num=9><td><pre>		r <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator"><<</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>l <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> l<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token punctuation">(</span>sum <span class="token operator">>></span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=10><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=11><td><pre>	v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">;</span></pre><tr><td data-num=12><td><pre>	v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">;</span></pre><tr><td data-num=13><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=14><td><pre></pre><tr><td data-num=15><td><pre><span class="token keyword">void</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>uint <span class="token operator">*</span>v<span class="token punctuation">,</span> uint <span class="token operator">*</span>key<span class="token punctuation">)</span></pre><tr><td data-num=16><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=17><td><pre>	uint l <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> delta <span class="token operator">=</span> <span class="token number">0x9e3779b9</span><span class="token punctuation">;</span></pre><tr><td data-num=18><td><pre>	sum <span class="token operator">=</span> delta <span class="token operator">*</span> <span class="token number">32</span><span class="token punctuation">;</span></pre><tr><td data-num=19><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator"><=</span> <span class="token number">32</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span></pre><tr><td data-num=20><td><pre>	<span class="token punctuation">{</span></pre><tr><td data-num=21><td><pre>		r <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator"><<</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>l <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> l<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token punctuation">(</span>sum <span class="token operator">>></span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=22><td><pre>		sum <span class="token operator">-=</span> delta<span class="token punctuation">;</span></pre><tr><td data-num=23><td><pre>		l <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator"><<</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>r <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> key<span class="token punctuation">[</span>sum <span class="token operator">&</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=24><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=25><td><pre>	v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">;</span></pre><tr><td data-num=26><td><pre>	v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">;</span></pre><tr><td data-num=27><td><pre><span class="token punctuation">}</span></pre></table></figure><h4 id=xxtea><a class=anchor href=#xxtea>#</a> XXTEA</h4><figure class="highlight c"><figcaption data-lang=c></figcaption><table><tr><td data-num=1><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&LTcstdio></span></span></pre><tr><td data-num=2><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">uint</span> <span class="token expression"><span class="token keyword">unsigned</span> <span class="token keyword">int</span></span></span></pre><tr><td data-num=3><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MX</span> <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">>></span> <span class="token number">5</span> <span class="token operator">^</span> y <span class="token operator"><<</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">3</span> <span class="token operator">^</span> z <span class="token operator"><<</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sum <span class="token operator">^</span> y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">&</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> e<span class="token punctuation">]</span> <span class="token operator">^</span> z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span></pre><tr><td data-num=4><td><pre><span class="token keyword">void</span> <span class="token function">xxtea</span><span class="token punctuation">(</span>uint <span class="token operator">*</span>v<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> uint <span class="token operator">*</span>k<span class="token punctuation">)</span>  </pre><tr><td data-num=5><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=6><td><pre>	uint y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> sum<span class="token punctuation">,</span> i<span class="token punctuation">,</span> t<span class="token punctuation">,</span> e<span class="token punctuation">,</span> delta <span class="token operator">=</span> <span class="token number">0x9e3779b9</span><span class="token punctuation">;</span><span class="token punctuation">;</span></pre><tr><td data-num=7><td><pre>	<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// encrypt</span></pre><tr><td data-num=8><td><pre>	<span class="token punctuation">{</span></pre><tr><td data-num=9><td><pre>		t <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">/</span> n<span class="token punctuation">,</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> v<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=10><td><pre>		<span class="token keyword">while</span> <span class="token punctuation">(</span>t<span class="token operator">--</span><span class="token punctuation">)</span></pre><tr><td data-num=11><td><pre>		<span class="token punctuation">{</span></pre><tr><td data-num=12><td><pre>			sum <span class="token operator">+=</span> delta<span class="token punctuation">,</span> e <span class="token operator">=</span> <span class="token punctuation">(</span>sum <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">3</span><span class="token punctuation">;</span></pre><tr><td data-num=13><td><pre>			<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span></pre><tr><td data-num=14><td><pre>			<span class="token punctuation">{</span></pre><tr><td data-num=15><td><pre>				y <span class="token operator">=</span> v<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=16><td><pre>				z <span class="token operator">=</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> MX<span class="token punctuation">;</span></pre><tr><td data-num=17><td><pre>			<span class="token punctuation">}</span></pre><tr><td data-num=18><td><pre>			y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=19><td><pre>			z <span class="token operator">=</span> v<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> MX<span class="token punctuation">;</span></pre><tr><td data-num=20><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=21><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=22><td><pre>	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator"><</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// decrypt</span></pre><tr><td data-num=23><td><pre>	<span class="token punctuation">{</span></pre><tr><td data-num=24><td><pre>		n <span class="token operator">=</span> <span class="token operator">-</span>n<span class="token punctuation">,</span> t <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">/</span> n<span class="token punctuation">,</span> sum <span class="token operator">=</span> t <span class="token operator">*</span> delta<span class="token punctuation">,</span> y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=25><td><pre>		<span class="token keyword">while</span> <span class="token punctuation">(</span>t<span class="token operator">--</span><span class="token punctuation">)</span></pre><tr><td data-num=26><td><pre>		<span class="token punctuation">{</span></pre><tr><td data-num=27><td><pre>			e <span class="token operator">=</span> <span class="token punctuation">(</span>sum <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">3</span><span class="token punctuation">;</span></pre><tr><td data-num=28><td><pre>			<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span></pre><tr><td data-num=29><td><pre>			<span class="token punctuation">{</span></pre><tr><td data-num=30><td><pre>				z <span class="token operator">=</span> v<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=31><td><pre>				y <span class="token operator">=</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-=</span> MX<span class="token punctuation">;</span></pre><tr><td data-num=32><td><pre>			<span class="token punctuation">}</span></pre><tr><td data-num=33><td><pre>			z <span class="token operator">=</span> v<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=34><td><pre>			y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-=</span> MX<span class="token punctuation">;</span></pre><tr><td data-num=35><td><pre>			sum <span class="token operator">-=</span> delta<span class="token punctuation">;</span></pre><tr><td data-num=36><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=37><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=38><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=39><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=40><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=41><td><pre>	uint v<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=42><td><pre>	<span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// abs(n) = strlen(v)</span></pre><tr><td data-num=43><td><pre>	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"data: %u %u\n"</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=44><td><pre>	<span class="token function">xxtea</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> n<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=45><td><pre>	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"encrypt:%u %u\n"</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=46><td><pre>	<span class="token function">xxtea</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token operator">-</span>n<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=47><td><pre>	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"decrypt: %u %u\n"</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=48><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=49><td><pre><span class="token punctuation">}</span></pre></table></figure><figure class="highlight python"><figcaption data-lang=python></figcaption><table><tr><td data-num=1><td><pre><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span></pre><tr><td data-num=2><td><pre></pre><tr><td data-num=3><td><pre></pre><tr><td data-num=4><td><pre><span class="token keyword">def</span> <span class="token function">MX</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span> y<span class="token punctuation">,</span> total<span class="token punctuation">,</span> key<span class="token punctuation">,</span> p<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=5><td><pre>    temp1 <span class="token operator">=</span> <span class="token punctuation">(</span>z<span class="token punctuation">.</span>value <span class="token operator">>></span> <span class="token number">5</span> <span class="token operator">^</span> y<span class="token punctuation">.</span>value <span class="token operator"><<</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y<span class="token punctuation">.</span>value <span class="token operator">>></span> <span class="token number">3</span> <span class="token operator">^</span> z<span class="token punctuation">.</span>value <span class="token operator"><<</span> <span class="token number">4</span><span class="token punctuation">)</span></pre><tr><td data-num=6><td><pre>    temp2 <span class="token operator">=</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span>value <span class="token operator">^</span> y<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">(</span>p <span class="token operator">&</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> e<span class="token punctuation">.</span>value<span class="token punctuation">]</span> <span class="token operator">^</span> z<span class="token punctuation">.</span>value<span class="token punctuation">)</span></pre><tr><td data-num=7><td><pre></pre><tr><td data-num=8><td><pre>    <span class="token keyword">return</span> c_uint32<span class="token punctuation">(</span>temp1 <span class="token operator">^</span> temp2<span class="token punctuation">)</span></pre><tr><td data-num=9><td><pre></pre><tr><td data-num=10><td><pre></pre><tr><td data-num=11><td><pre><span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> v<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=12><td><pre>    delta <span class="token operator">=</span> <span class="token number">0x9e3779b9</span></pre><tr><td data-num=13><td><pre>    rounds <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">//</span> n</pre><tr><td data-num=14><td><pre></pre><tr><td data-num=15><td><pre>    total <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></pre><tr><td data-num=16><td><pre>    z <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span>v<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=17><td><pre>    e <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></pre><tr><td data-num=18><td><pre></pre><tr><td data-num=19><td><pre>    <span class="token keyword">while</span> rounds <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span></pre><tr><td data-num=20><td><pre>        total<span class="token punctuation">.</span>value <span class="token operator">+=</span> delta</pre><tr><td data-num=21><td><pre>        e<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span>value <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">3</span></pre><tr><td data-num=22><td><pre>        <span class="token keyword">for</span> p <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=23><td><pre>            y <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span>v<span class="token punctuation">[</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=24><td><pre>            v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span>v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">+</span> MX<span class="token punctuation">(</span>z<span class="token punctuation">,</span> y<span class="token punctuation">,</span> total<span class="token punctuation">,</span> key<span class="token punctuation">,</span> p<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span>value</pre><tr><td data-num=25><td><pre>            z<span class="token punctuation">.</span>value <span class="token operator">=</span> v<span class="token punctuation">[</span>p<span class="token punctuation">]</span></pre><tr><td data-num=26><td><pre>        y <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=27><td><pre>        v<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span>v<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> MX<span class="token punctuation">(</span>z<span class="token punctuation">,</span> y<span class="token punctuation">,</span> total<span class="token punctuation">,</span> key<span class="token punctuation">,</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span>value</pre><tr><td data-num=28><td><pre>        z<span class="token punctuation">.</span>value <span class="token operator">=</span> v<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span></pre><tr><td data-num=29><td><pre>        rounds <span class="token operator">-=</span> <span class="token number">1</span></pre><tr><td data-num=30><td><pre></pre><tr><td data-num=31><td><pre>    <span class="token keyword">return</span> v</pre><tr><td data-num=32><td><pre></pre><tr><td data-num=33><td><pre></pre><tr><td data-num=34><td><pre><span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> v<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=35><td><pre>    delta <span class="token operator">=</span> <span class="token number">0x9e3779b9</span></pre><tr><td data-num=36><td><pre>    rounds <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">//</span> n</pre><tr><td data-num=37><td><pre></pre><tr><td data-num=38><td><pre>    total <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span>rounds <span class="token operator">*</span> delta<span class="token punctuation">)</span></pre><tr><td data-num=39><td><pre>    y <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=40><td><pre>    e <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></pre><tr><td data-num=41><td><pre></pre><tr><td data-num=42><td><pre>    <span class="token keyword">while</span> rounds <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span></pre><tr><td data-num=43><td><pre>        e<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span>value <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">3</span></pre><tr><td data-num=44><td><pre>        <span class="token keyword">for</span> p <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=45><td><pre>            z <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span>v<span class="token punctuation">[</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=46><td><pre>            v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">-</span> MX<span class="token punctuation">(</span>z<span class="token punctuation">,</span> y<span class="token punctuation">,</span> total<span class="token punctuation">,</span> key<span class="token punctuation">,</span> p<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value</pre><tr><td data-num=47><td><pre>            y<span class="token punctuation">.</span>value <span class="token operator">=</span> v<span class="token punctuation">[</span>p<span class="token punctuation">]</span></pre><tr><td data-num=48><td><pre>        z <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span>v<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=49><td><pre>        v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> MX<span class="token punctuation">(</span>z<span class="token punctuation">,</span> y<span class="token punctuation">,</span> total<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span>value</pre><tr><td data-num=50><td><pre>        y<span class="token punctuation">.</span>value <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre><tr><td data-num=51><td><pre>        total<span class="token punctuation">.</span>value <span class="token operator">-=</span> delta</pre><tr><td data-num=52><td><pre>        rounds <span class="token operator">-=</span> <span class="token number">1</span></pre><tr><td data-num=53><td><pre></pre><tr><td data-num=54><td><pre>    <span class="token keyword">return</span> v</pre><tr><td data-num=55><td><pre></pre><tr><td data-num=56><td><pre></pre><tr><td data-num=57><td><pre><span class="token comment">#  test</span></pre><tr><td data-num=58><td><pre><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span></pre><tr><td data-num=59><td><pre>    <span class="token comment"># 该算法中每次可加密不只 64bit 的数据，并且加密的轮数由加密数据长度决定</span></pre><tr><td data-num=60><td><pre>    v <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1374278842</span><span class="token punctuation">,</span> <span class="token number">2136006540</span><span class="token punctuation">,</span> <span class="token number">4191056815</span><span class="token punctuation">,</span> <span class="token number">3248881376</span><span class="token punctuation">]</span></pre><tr><td data-num=61><td><pre>    k <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x67452301</span><span class="token punctuation">,</span> <span class="token number">0xefcdab89</span><span class="token punctuation">,</span> <span class="token number">0x98badcfe</span><span class="token punctuation">,</span> <span class="token number">0x10325476</span><span class="token punctuation">]</span></pre><tr><td data-num=62><td><pre>    n <span class="token operator">=</span> <span class="token number">4</span></pre><tr><td data-num=63><td><pre></pre><tr><td data-num=64><td><pre>    res <span class="token operator">=</span> decrypt<span class="token punctuation">(</span>n<span class="token punctuation">,</span> v<span class="token punctuation">,</span> k<span class="token punctuation">)</span></pre><tr><td data-num=65><td><pre>    <span class="token comment"># print("Data is : ", hex(v[0]), hex(v[1]))</span></pre><tr><td data-num=66><td><pre>    <span class="token comment"># res = encrypt(n, v, k)</span></pre><tr><td data-num=67><td><pre>    <span class="token comment"># print("Encrypted data is : ", hex(res[0]), hex(res[1]))</span></pre><tr><td data-num=68><td><pre>    <span class="token comment"># res = decrypt(n, res, k)</span></pre><tr><td data-num=69><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Decrypted data is : "</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=70><td><pre><span class="token triple-quoted-string string">"""</span></pre><tr><td data-num=71><td><pre>Data is :  0x12345678 0x78563412</pre><tr><td data-num=72><td><pre>Encrypted data is :  0xef86c2bb 0x25f31b5e</pre><tr><td data-num=73><td><pre>Decrypted data is :  0x12345678 0x78563412</pre><tr><td data-num=74><td><pre>"""</pre></table></figure><h3 id=其他><a class=anchor href=#其他>#</a> 其他</h3><h4 id=des><a class=anchor href=#des>#</a> DES</h4><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&LTstdio.h></span></span></pre><tr><td data-num=2><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&LTstring.h></span></span></pre><tr><td data-num=3><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&LTstdlib.h></span></span></pre><tr><td data-num=4><td><pre></pre><tr><td data-num=5><td><pre><span class="token keyword">void</span> <span class="token function">encryption</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> plaintext<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> ciphertext<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=6><td><pre><span class="token keyword">void</span> <span class="token function">decryption</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> ciphertext<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> plaintext<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=7><td><pre></pre><tr><td data-num=8><td><pre><span class="token keyword">void</span> <span class="token function">ip_replace</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=9><td><pre><span class="token keyword">void</span> <span class="token function">fp_replace</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=10><td><pre><span class="token keyword">void</span> <span class="token function">byte2Bit</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>out<span class="token punctuation">,</span><span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=11><td><pre><span class="token keyword">void</span> <span class="token function">bit2Byte</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>out<span class="token punctuation">,</span><span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=12><td><pre></pre><tr><td data-num=13><td><pre><span class="token keyword">void</span> <span class="token function">f_func</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> out<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>ki<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=14><td><pre><span class="token keyword">void</span> <span class="token function">get_subkey</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=15><td><pre></pre><tr><td data-num=16><td><pre><span class="token keyword">void</span> <span class="token function">byteXOR</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>a<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>b<span class="token punctuation">,</span><span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=17><td><pre><span class="token keyword">void</span> <span class="token function">e_expand</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=18><td><pre><span class="token keyword">void</span> <span class="token function">s_replace</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=19><td><pre><span class="token keyword">void</span> <span class="token function">p_replace</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=20><td><pre></pre><tr><td data-num=21><td><pre><span class="token keyword">void</span> <span class="token function">pc1_replace</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=22><td><pre><span class="token keyword">void</span> <span class="token function">pc2_replace</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=23><td><pre></pre><tr><td data-num=24><td><pre><span class="token keyword">const</span> <span class="token keyword">char</span> IP_Table<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=25><td><pre>        <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span></pre><tr><td data-num=26><td><pre>        <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span></pre><tr><td data-num=27><td><pre>        <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span></pre><tr><td data-num=28><td><pre>        <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">7</span></pre><tr><td data-num=29><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=30><td><pre></pre><tr><td data-num=31><td><pre><span class="token keyword">const</span> <span class="token keyword">char</span> IPR_Table<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=32><td><pre>        <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span></pre><tr><td data-num=33><td><pre>        <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span></pre><tr><td data-num=34><td><pre>        <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span></pre><tr><td data-num=35><td><pre>        <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">25</span></pre><tr><td data-num=36><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=37><td><pre></pre><tr><td data-num=38><td><pre><span class="token keyword">const</span> <span class="token keyword">char</span> E_Table<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=39><td><pre>        <span class="token number">32</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span></pre><tr><td data-num=40><td><pre>        <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span></pre><tr><td data-num=41><td><pre>        <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span></pre><tr><td data-num=42><td><pre>        <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span>  <span class="token number">1</span></pre><tr><td data-num=43><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=44><td><pre></pre><tr><td data-num=45><td><pre><span class="token keyword">const</span> <span class="token keyword">char</span> P_Table<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=46><td><pre>        <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span></pre><tr><td data-num=47><td><pre>        <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">25</span></pre><tr><td data-num=48><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=49><td><pre></pre><tr><td data-num=50><td><pre><span class="token keyword">const</span> <span class="token keyword">char</span> PC1_Table<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=51><td><pre>        <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span></pre><tr><td data-num=52><td><pre>        <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span></pre><tr><td data-num=53><td><pre>        <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span></pre><tr><td data-num=54><td><pre>        <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span></pre><tr><td data-num=55><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=56><td><pre><span class="token keyword">const</span> <span class="token keyword">char</span> PC2_Table<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=57><td><pre>        <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span></pre><tr><td data-num=58><td><pre>        <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span></pre><tr><td data-num=59><td><pre>        <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span></pre><tr><td data-num=60><td><pre>        <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">32</span></pre><tr><td data-num=61><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=62><td><pre></pre><tr><td data-num=63><td><pre><span class="token keyword">const</span> <span class="token keyword">char</span> LOOP_Table<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=64><td><pre>    <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span></pre><tr><td data-num=65><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=66><td><pre><span class="token keyword">const</span> <span class="token keyword">char</span> S_Box<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=67><td><pre>        <span class="token comment">// S1</span></pre><tr><td data-num=68><td><pre>        <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span></pre><tr><td data-num=69><td><pre>        <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span></pre><tr><td data-num=70><td><pre>        <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span></pre><tr><td data-num=71><td><pre>        <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span></pre><tr><td data-num=72><td><pre>        <span class="token comment">// S2</span></pre><tr><td data-num=73><td><pre>        <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span></pre><tr><td data-num=74><td><pre>        <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span></pre><tr><td data-num=75><td><pre>        <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span></pre><tr><td data-num=76><td><pre>        <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span></pre><tr><td data-num=77><td><pre>        <span class="token comment">// S3</span></pre><tr><td data-num=78><td><pre>        <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span></pre><tr><td data-num=79><td><pre>        <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span></pre><tr><td data-num=80><td><pre>        <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span></pre><tr><td data-num=81><td><pre>        <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span></pre><tr><td data-num=82><td><pre>        <span class="token comment">// S4</span></pre><tr><td data-num=83><td><pre>        <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span></pre><tr><td data-num=84><td><pre>        <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span></pre><tr><td data-num=85><td><pre>        <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span></pre><tr><td data-num=86><td><pre>        <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span></pre><tr><td data-num=87><td><pre>        <span class="token comment">// S5</span></pre><tr><td data-num=88><td><pre>        <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span></pre><tr><td data-num=89><td><pre>        <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span></pre><tr><td data-num=90><td><pre>        <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span></pre><tr><td data-num=91><td><pre>        <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span></pre><tr><td data-num=92><td><pre>        <span class="token comment">// S6</span></pre><tr><td data-num=93><td><pre>        <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span></pre><tr><td data-num=94><td><pre>        <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span></pre><tr><td data-num=95><td><pre>        <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span></pre><tr><td data-num=96><td><pre>        <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span></pre><tr><td data-num=97><td><pre>        <span class="token comment">// S7</span></pre><tr><td data-num=98><td><pre>        <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span></pre><tr><td data-num=99><td><pre>        <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span></pre><tr><td data-num=100><td><pre>        <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span></pre><tr><td data-num=101><td><pre>        <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span></pre><tr><td data-num=102><td><pre>        <span class="token comment">// S8</span></pre><tr><td data-num=103><td><pre>        <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span></pre><tr><td data-num=104><td><pre>        <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span></pre><tr><td data-num=105><td><pre>        <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span></pre><tr><td data-num=106><td><pre>        <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span></pre><tr><td data-num=107><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=108><td><pre></pre><tr><td data-num=109><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">char</span> subkey<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=110><td><pre></pre><tr><td data-num=111><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">char</span> result<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span><span class="token number">0xe4</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=112><td><pre></pre><tr><td data-num=113><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=114><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=115><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"DE3_En1C"</span><span class="token punctuation">;</span></pre><tr><td data-num=116><td><pre></pre><tr><td data-num=117><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> plaintext<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=118><td><pre>	<span class="token comment">//HarDd3s?</span></pre><tr><td data-num=119><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> ciphertext<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=120><td><pre>    <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=121><td><pre></pre><tr><td data-num=122><td><pre>	<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"give me a string to encrypt:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=123><td><pre></pre><tr><td data-num=124><td><pre>	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=125><td><pre></pre><tr><td data-num=126><td><pre>	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>plaintext<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=127><td><pre>		<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=128><td><pre>		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span></pre><tr><td data-num=129><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=130><td><pre></pre><tr><td data-num=131><td><pre></pre><tr><td data-num=132><td><pre>    <span class="token comment">//to generate 16 round subkey</span></pre><tr><td data-num=133><td><pre>    <span class="token function">get_subkey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=134><td><pre></pre><tr><td data-num=135><td><pre>    <span class="token comment">//to encrypt plaintext</span></pre><tr><td data-num=136><td><pre>    <span class="token function">encryption</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=137><td><pre></pre><tr><td data-num=138><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator"><</span><span class="token number">8</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=139><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span>result<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=140><td><pre>			<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Wrong!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=141><td><pre>		    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=142><td><pre>			<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span></pre><tr><td data-num=143><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=144><td><pre>    <span class="token punctuation">}</span></pre><tr><td data-num=145><td><pre>	<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"G00d Job!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=146><td><pre>	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=147><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=148><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=149><td><pre></pre><tr><td data-num=150><td><pre><span class="token keyword">void</span> <span class="token function">encryption</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> plaintext<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> ciphertext<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=151><td><pre>    <span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=152><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> array_plaintext<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=153><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> f_result<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=154><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> left_array<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=155><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> right_array<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=156><td><pre></pre><tr><td data-num=157><td><pre>    <span class="token function">byte2Bit</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span>array_plaintext<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=158><td><pre>    <span class="token function">ip_replace</span><span class="token punctuation">(</span>array_plaintext<span class="token punctuation">,</span>array_plaintext<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=159><td><pre></pre><tr><td data-num=160><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>left_array<span class="token punctuation">,</span>array_plaintext<span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=161><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>right_array<span class="token punctuation">,</span>array_plaintext<span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=162><td><pre></pre><tr><td data-num=163><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator"><</span><span class="token number">15</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=164><td><pre>        <span class="token function">f_func</span><span class="token punctuation">(</span>right_array<span class="token punctuation">,</span>f_result<span class="token punctuation">,</span><span class="token operator">&</span>subkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=165><td><pre>        <span class="token function">byteXOR</span><span class="token punctuation">(</span>f_result<span class="token punctuation">,</span>left_array<span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=166><td><pre>        <span class="token function">memcpy</span><span class="token punctuation">(</span>left_array<span class="token punctuation">,</span>right_array<span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=167><td><pre>        <span class="token function">memcpy</span><span class="token punctuation">(</span>right_array<span class="token punctuation">,</span>f_result<span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=168><td><pre>    <span class="token punctuation">}</span></pre><tr><td data-num=169><td><pre></pre><tr><td data-num=170><td><pre>    <span class="token function">f_func</span><span class="token punctuation">(</span>right_array<span class="token punctuation">,</span>f_result<span class="token punctuation">,</span><span class="token operator">&</span>subkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=171><td><pre>    <span class="token function">byteXOR</span><span class="token punctuation">(</span>left_array<span class="token punctuation">,</span>f_result<span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=172><td><pre></pre><tr><td data-num=173><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>array_plaintext<span class="token punctuation">,</span>left_array<span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=174><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>array_plaintext<span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">,</span>right_array<span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=175><td><pre></pre><tr><td data-num=176><td><pre>    <span class="token function">fp_replace</span><span class="token punctuation">(</span>array_plaintext<span class="token punctuation">,</span>array_plaintext<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=177><td><pre>    <span class="token function">bit2Byte</span><span class="token punctuation">(</span>array_plaintext<span class="token punctuation">,</span>ciphertext<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=178><td><pre></pre><tr><td data-num=179><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=180><td><pre></pre><tr><td data-num=181><td><pre></pre><tr><td data-num=182><td><pre><span class="token keyword">void</span> <span class="token function">byte2Bit</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>out<span class="token punctuation">,</span><span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=183><td><pre>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span></pre><tr><td data-num=184><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token generic-function"><span class="token function">i</span><span class="token generic class-name"><span class="token operator"><</span>len<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></span></span></pre><tr><td data-num=185><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator"><</span><span class="token number">8</span><span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=186><td><pre>            out<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">8</span><span class="token operator">+</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>></span><span class="token punctuation">(</span><span class="token number">7</span><span class="token operator">-</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&</span><span class="token number">0x1</span><span class="token punctuation">;</span></pre><tr><td data-num=187><td><pre>            <span class="token punctuation">}</span></pre><tr><td data-num=188><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=189><td><pre></pre><tr><td data-num=190><td><pre><span class="token keyword">void</span> <span class="token function">bit2Byte</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>out<span class="token punctuation">,</span><span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=191><td><pre>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span></pre><tr><td data-num=192><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> temp<span class="token punctuation">;</span></pre><tr><td data-num=193><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator"><</span>len<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=194><td><pre>        temp <span class="token operator">=</span> in<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">&</span><span class="token number">0x1</span><span class="token punctuation">;</span></pre><tr><td data-num=195><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator"><</span><span class="token number">8</span><span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=196><td><pre>            temp <span class="token operator">=</span> temp<span class="token operator"><<</span><span class="token number">1</span><span class="token punctuation">;</span></pre><tr><td data-num=197><td><pre>            temp <span class="token operator">=</span> temp<span class="token operator">+</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">8</span><span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">&</span><span class="token number">0x1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=198><td><pre>        <span class="token punctuation">}</span></pre><tr><td data-num=199><td><pre>        out<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>temp<span class="token punctuation">;</span></pre><tr><td data-num=200><td><pre>    <span class="token punctuation">}</span></pre><tr><td data-num=201><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=202><td><pre></pre><tr><td data-num=203><td><pre><span class="token comment">//change the input 64 bit data to 64 bytes array, use ip table to replace 64 bytes array</span></pre><tr><td data-num=204><td><pre><span class="token keyword">void</span> <span class="token function">ip_replace</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>out<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=205><td><pre>    <span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=206><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> temp<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=207><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span>in<span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=208><td><pre>    <span class="token comment">//use ip table to replace 64 bytes(bit) array</span></pre><tr><td data-num=209><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator"><</span><span class="token number">64</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=210><td><pre>        out<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span>IP_Table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=211><td><pre>        <span class="token comment">//printf("%x ",out[i]);</span></pre><tr><td data-num=212><td><pre>    <span class="token punctuation">}</span></pre><tr><td data-num=213><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=214><td><pre></pre><tr><td data-num=215><td><pre><span class="token keyword">void</span> <span class="token function">fp_replace</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> out<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=216><td><pre>    <span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=217><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> temp<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=218><td><pre></pre><tr><td data-num=219><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span>in<span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=220><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator"><</span><span class="token number">64</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></pre><tr><td data-num=221><td><pre>        out<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span>IPR_Table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=222><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=223><td><pre></pre><tr><td data-num=224><td><pre><span class="token keyword">void</span> <span class="token function">e_expand</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> in<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>out<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=225><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> temp<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=226><td><pre>    <span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=227><td><pre></pre><tr><td data-num=228><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span>in<span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=229><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator"><</span><span class="token number">48</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></pre><tr><td data-num=230><td><pre>        out<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span>E_Table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=231><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=232><td><pre></pre><tr><td data-num=233><td><pre><span class="token keyword">void</span> <span class="token function">s_replace</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>out<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=234><td><pre>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span></pre><tr><td data-num=235><td><pre>    <span class="token keyword">int</span> raw<span class="token punctuation">,</span>col<span class="token punctuation">;</span></pre><tr><td data-num=236><td><pre>    <span class="token keyword">char</span> temp<span class="token punctuation">;</span></pre><tr><td data-num=237><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator"><</span><span class="token number">8</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=238><td><pre>        raw <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator"><<</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">6</span><span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&</span><span class="token number">0x3</span><span class="token punctuation">;</span></pre><tr><td data-num=239><td><pre>        col <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">6</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator"><<</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">6</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator"><<</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">6</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator"><<</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">6</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&</span><span class="token number">0xF</span><span class="token punctuation">;</span></pre><tr><td data-num=240><td><pre>        temp <span class="token operator">=</span> S_Box<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>raw<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token operator">&</span><span class="token number">0xF</span><span class="token punctuation">;</span></pre><tr><td data-num=241><td><pre>        out<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>temp<span class="token operator">>></span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">&</span><span class="token number">0x1</span><span class="token punctuation">;</span></pre><tr><td data-num=242><td><pre>        out<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>temp<span class="token operator">>></span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&</span><span class="token number">0x1</span><span class="token punctuation">;</span></pre><tr><td data-num=243><td><pre>        out<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>temp<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&</span><span class="token number">0x1</span><span class="token punctuation">;</span></pre><tr><td data-num=244><td><pre>        out<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token operator">&</span><span class="token number">0x1</span><span class="token punctuation">;</span></pre><tr><td data-num=245><td><pre>        j<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">;</span></pre><tr><td data-num=246><td><pre>    <span class="token punctuation">}</span></pre><tr><td data-num=247><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=248><td><pre></pre><tr><td data-num=249><td><pre><span class="token keyword">void</span> <span class="token function">p_replace</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> out<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=250><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> temp<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=251><td><pre>    <span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=252><td><pre></pre><tr><td data-num=253><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span>in<span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=254><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator"><</span><span class="token number">32</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=255><td><pre>        out<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span>P_Table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=256><td><pre>    <span class="token punctuation">}</span></pre><tr><td data-num=257><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=258><td><pre></pre><tr><td data-num=259><td><pre><span class="token keyword">void</span> <span class="token function">byteXOR</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>a<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>b<span class="token punctuation">,</span><span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=260><td><pre>    <span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=261><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator"><</span>len<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=262><td><pre>        a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&</span><span class="token number">0x1</span><span class="token punctuation">;</span></pre><tr><td data-num=263><td><pre>    <span class="token punctuation">}</span></pre><tr><td data-num=264><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=265><td><pre></pre><tr><td data-num=266><td><pre><span class="token keyword">void</span> <span class="token function">f_func</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> out<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> ki<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=267><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> expand_result<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=268><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> replace_result<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=269><td><pre></pre><tr><td data-num=270><td><pre>    <span class="token function">e_expand</span><span class="token punctuation">(</span>in<span class="token punctuation">,</span>expand_result<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=271><td><pre>    <span class="token function">byteXOR</span><span class="token punctuation">(</span>expand_result<span class="token punctuation">,</span>ki<span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=272><td><pre>    <span class="token function">s_replace</span><span class="token punctuation">(</span>expand_result<span class="token punctuation">,</span>replace_result<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=273><td><pre>    <span class="token function">p_replace</span><span class="token punctuation">(</span>replace_result<span class="token punctuation">,</span>replace_result<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=274><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>out<span class="token punctuation">,</span>replace_result<span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=275><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=276><td><pre></pre><tr><td data-num=277><td><pre><span class="token keyword">void</span> <span class="token function">pc1_replace</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span> out<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=278><td><pre>    <span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=279><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator"><</span><span class="token number">56</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></pre><tr><td data-num=280><td><pre>        out<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>in<span class="token punctuation">[</span>PC1_Table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=281><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=282><td><pre></pre><tr><td data-num=283><td><pre><span class="token keyword">void</span> <span class="token function">pc2_replace</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>out<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=284><td><pre>    <span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=285><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator"><</span><span class="token number">48</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></pre><tr><td data-num=286><td><pre>        out<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> in<span class="token punctuation">[</span>PC2_Table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=287><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=288><td><pre></pre><tr><td data-num=289><td><pre><span class="token keyword">void</span> <span class="token function">shift_left</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>in<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>out<span class="token punctuation">,</span><span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=290><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> temp<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=291><td><pre>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span></pre><tr><td data-num=292><td><pre></pre><tr><td data-num=293><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span>in<span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=294><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span>len<span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator"><</span><span class="token number">28</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></pre><tr><td data-num=295><td><pre>        out<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=296><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator"><</span>len<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></pre><tr><td data-num=297><td><pre>        out<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=298><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=299><td><pre><span class="token comment">//use user's input key to generate 16 subkey</span></pre><tr><td data-num=300><td><pre><span class="token keyword">void</span> <span class="token function">get_subkey</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=301><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> key_temp<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=302><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> pc1_result<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=303><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> pc2_result<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=304><td><pre>    <span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=305><td><pre></pre><tr><td data-num=306><td><pre>    <span class="token function">byte2Bit</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>key_temp<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=307><td><pre>    <span class="token function">pc1_replace</span><span class="token punctuation">(</span>key_temp<span class="token punctuation">,</span>pc1_result<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=308><td><pre></pre><tr><td data-num=309><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator"><</span><span class="token number">16</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=310><td><pre>        <span class="token function">shift_left</span><span class="token punctuation">(</span>pc1_result<span class="token punctuation">,</span>pc1_result<span class="token punctuation">,</span>LOOP_Table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=311><td><pre>        <span class="token function">shift_left</span><span class="token punctuation">(</span>pc1_result<span class="token operator">+</span><span class="token number">28</span><span class="token punctuation">,</span>pc1_result<span class="token operator">+</span><span class="token number">28</span><span class="token punctuation">,</span>LOOP_Table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=312><td><pre>        <span class="token function">pc2_replace</span><span class="token punctuation">(</span>pc1_result<span class="token punctuation">,</span>pc2_result<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=313><td><pre>        <span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token operator">&</span>subkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>pc2_result<span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=314><td><pre>    <span class="token punctuation">}</span></pre><tr><td data-num=315><td><pre><span class="token punctuation">}</span></pre></table></figure><h4 id=aes><a class=anchor href=#aes>#</a> AES</h4><figure class="highlight c"><figcaption data-lang=c></figcaption><table><tr><td data-num=1><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&LTstdio.h></span></span></pre><tr><td data-num=2><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&LTstdint.h></span></span></pre><tr><td data-num=3><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&LTmemory.h></span></span></pre><tr><td data-num=4><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=5><td><pre><span class="token keyword">typedef</span> <span class="token keyword">enum</span> <span class="token punctuation">{</span></pre><tr><td data-num=6><td><pre>	AES_CYPHER_128<span class="token punctuation">,</span></pre><tr><td data-num=7><td><pre>	AES_CYPHER_192<span class="token punctuation">,</span></pre><tr><td data-num=8><td><pre>	AES_CYPHER_256<span class="token punctuation">,</span></pre><tr><td data-num=9><td><pre><span class="token punctuation">}</span> AES_CYPHER_T<span class="token punctuation">;</span></pre><tr><td data-num=10><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=11><td><pre><span class="token comment">/*</span></pre><tr><td data-num=12><td><pre>* Encryption Rounds</pre><tr><td data-num=13><td><pre>*/</pre><tr><td data-num=14><td><pre><span class="token keyword">int</span> g_aes_key_bits<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=15><td><pre>	<span class="token comment">/* AES_CYPHER_128 */</span> <span class="token number">128</span><span class="token punctuation">,</span></pre><tr><td data-num=16><td><pre>	<span class="token comment">/* AES_CYPHER_192 */</span> <span class="token number">192</span><span class="token punctuation">,</span></pre><tr><td data-num=17><td><pre>	<span class="token comment">/* AES_CYPHER_256 */</span> <span class="token number">256</span><span class="token punctuation">,</span></pre><tr><td data-num=18><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=19><td><pre><span class="token keyword">int</span> g_aes_rounds<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=20><td><pre>	<span class="token comment">/* AES_CYPHER_128 */</span>  <span class="token number">10</span><span class="token punctuation">,</span></pre><tr><td data-num=21><td><pre>	<span class="token comment">/* AES_CYPHER_192 */</span>  <span class="token number">12</span><span class="token punctuation">,</span></pre><tr><td data-num=22><td><pre>	<span class="token comment">/* AES_CYPHER_256 */</span>  <span class="token number">14</span><span class="token punctuation">,</span></pre><tr><td data-num=23><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=24><td><pre><span class="token keyword">int</span> g_aes_nk<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=25><td><pre>	<span class="token comment">/* AES_CYPHER_128 */</span>  <span class="token number">4</span><span class="token punctuation">,</span></pre><tr><td data-num=26><td><pre>	<span class="token comment">/* AES_CYPHER_192 */</span>  <span class="token number">6</span><span class="token punctuation">,</span></pre><tr><td data-num=27><td><pre>	<span class="token comment">/* AES_CYPHER_256 */</span>  <span class="token number">8</span><span class="token punctuation">,</span></pre><tr><td data-num=28><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=29><td><pre><span class="token keyword">int</span> g_aes_nb<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=30><td><pre>	<span class="token comment">/* AES_CYPHER_128 */</span>  <span class="token number">4</span><span class="token punctuation">,</span></pre><tr><td data-num=31><td><pre>	<span class="token comment">/* AES_CYPHER_192 */</span>  <span class="token number">4</span><span class="token punctuation">,</span></pre><tr><td data-num=32><td><pre>	<span class="token comment">/* AES_CYPHER_256 */</span>  <span class="token number">4</span><span class="token punctuation">,</span></pre><tr><td data-num=33><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=34><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=35><td><pre><span class="token comment">/*</span></pre><tr><td data-num=36><td><pre>* aes Rcon:</pre><tr><td data-num=37><td><pre>*</pre><tr><td data-num=38><td><pre>* WARNING: Rcon is designed starting from 1 to 15, not 0 to 14.</pre><tr><td data-num=39><td><pre>*          FIPS-197 Page 9: "note that i starts at 1, not 0"</pre><tr><td data-num=40><td><pre>*</pre><tr><td data-num=41><td><pre>* i    |   0     1     2     3     4     5     6     7     8     9    10    11    12    13    14</pre><tr><td data-num=42><td><pre>* -----+------------------------------------------------------------------------------------------</pre><tr><td data-num=43><td><pre>*      | [01]  [02]  [04]  [08]  [10]  [20]  [40]  [80]  [1b]  [36]  [6c]  [d8]  [ab]  [4d]  [9a]</pre><tr><td data-num=44><td><pre>* RCON | [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]</pre><tr><td data-num=45><td><pre>*      | [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]</pre><tr><td data-num=46><td><pre>*      | [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]</pre><tr><td data-num=47><td><pre>*/</pre><tr><td data-num=48><td><pre><span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">uint32_t</span> g_aes_rcon<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=49><td><pre>	<span class="token number">0x01000000</span><span class="token punctuation">,</span> <span class="token number">0x02000000</span><span class="token punctuation">,</span> <span class="token number">0x04000000</span><span class="token punctuation">,</span> <span class="token number">0x08000000</span><span class="token punctuation">,</span> <span class="token number">0x10000000</span><span class="token punctuation">,</span> <span class="token number">0x20000000</span><span class="token punctuation">,</span> <span class="token number">0x40000000</span><span class="token punctuation">,</span> <span class="token number">0x80000000</span><span class="token punctuation">,</span></pre><tr><td data-num=50><td><pre>	<span class="token number">0x1b000000</span><span class="token punctuation">,</span> <span class="token number">0x36000000</span><span class="token punctuation">,</span> <span class="token number">0x6c000000</span><span class="token punctuation">,</span> <span class="token number">0xd8000000</span><span class="token punctuation">,</span> <span class="token number">0xab000000</span><span class="token punctuation">,</span> <span class="token number">0xed000000</span><span class="token punctuation">,</span> <span class="token number">0x9a000000</span></pre><tr><td data-num=51><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=52><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=53><td><pre><span class="token comment">/*</span></pre><tr><td data-num=54><td><pre>* aes sbox and invert-sbox</pre><tr><td data-num=55><td><pre>*/</pre><tr><td data-num=56><td><pre><span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">uint8_t</span> g_aes_sbox<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=57><td><pre>	<span class="token comment">/* 0     1     2     3     4     5     6     7     8     9     A     B     C     D     E     F  */</span></pre><tr><td data-num=58><td><pre>	<span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x7c</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0x7b</span><span class="token punctuation">,</span> <span class="token number">0xf2</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0x2b</span><span class="token punctuation">,</span> <span class="token number">0xfe</span><span class="token punctuation">,</span> <span class="token number">0xd7</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span></pre><tr><td data-num=59><td><pre>	<span class="token number">0xca</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0xc9</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xa2</span><span class="token punctuation">,</span> <span class="token number">0xaf</span><span class="token punctuation">,</span> <span class="token number">0x9c</span><span class="token punctuation">,</span> <span class="token number">0xa4</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xc0</span><span class="token punctuation">,</span></pre><tr><td data-num=60><td><pre>	<span class="token number">0xb7</span><span class="token punctuation">,</span> <span class="token number">0xfd</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0xe5</span><span class="token punctuation">,</span> <span class="token number">0xf1</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span></pre><tr><td data-num=61><td><pre>	<span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0xc7</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0xc3</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xe2</span><span class="token punctuation">,</span> <span class="token number">0xeb</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0xb2</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span></pre><tr><td data-num=62><td><pre>	<span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x1a</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x6e</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0xa0</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">,</span> <span class="token number">0xd6</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xe3</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span></pre><tr><td data-num=63><td><pre>	<span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0xd1</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0xed</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0xfc</span><span class="token punctuation">,</span> <span class="token number">0xb1</span><span class="token punctuation">,</span> <span class="token number">0x5b</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0xcf</span><span class="token punctuation">,</span></pre><tr><td data-num=64><td><pre>	<span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x7f</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x3c</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0xa8</span><span class="token punctuation">,</span></pre><tr><td data-num=65><td><pre>	<span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x8f</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0xf5</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0xb6</span><span class="token punctuation">,</span> <span class="token number">0xda</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0xf3</span><span class="token punctuation">,</span> <span class="token number">0xd2</span><span class="token punctuation">,</span></pre><tr><td data-num=66><td><pre>	<span class="token number">0xcd</span><span class="token punctuation">,</span> <span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0xec</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0xc4</span><span class="token punctuation">,</span> <span class="token number">0xa7</span><span class="token punctuation">,</span> <span class="token number">0x7e</span><span class="token punctuation">,</span> <span class="token number">0x3d</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span></pre><tr><td data-num=67><td><pre>	<span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x2a</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0xb8</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0xde</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0xdb</span><span class="token punctuation">,</span></pre><tr><td data-num=68><td><pre>	<span class="token number">0xe0</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0x5c</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0xac</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span></pre><tr><td data-num=69><td><pre>	<span class="token number">0xe7</span><span class="token punctuation">,</span> <span class="token number">0xc8</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x6d</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0xd5</span><span class="token punctuation">,</span> <span class="token number">0x4e</span><span class="token punctuation">,</span> <span class="token number">0xa9</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0xf4</span><span class="token punctuation">,</span> <span class="token number">0xea</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span></pre><tr><td data-num=70><td><pre>	<span class="token number">0xba</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x2e</span><span class="token punctuation">,</span> <span class="token number">0x1c</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0xb4</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0xdd</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x1f</span><span class="token punctuation">,</span> <span class="token number">0x4b</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x8b</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span></pre><tr><td data-num=71><td><pre>	<span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x3e</span><span class="token punctuation">,</span> <span class="token number">0xb5</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0xb9</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0xc1</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x9e</span><span class="token punctuation">,</span></pre><tr><td data-num=72><td><pre>	<span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0xf8</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x8e</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x9b</span><span class="token punctuation">,</span> <span class="token number">0x1e</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0xe9</span><span class="token punctuation">,</span> <span class="token number">0xce</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0xdf</span><span class="token punctuation">,</span></pre><tr><td data-num=73><td><pre>	<span class="token number">0x8c</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0xe6</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span> <span class="token number">0x0f</span><span class="token punctuation">,</span> <span class="token number">0xb0</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0x16</span></pre><tr><td data-num=74><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=75><td><pre><span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">uint8_t</span> g_inv_sbox<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=76><td><pre>	<span class="token comment">/* 0     1     2     3     4     5     6     7     8     9     A     B     C     D     E     F  */</span></pre><tr><td data-num=77><td><pre>	<span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd5</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9e</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xf3</span><span class="token punctuation">,</span> <span class="token number">0xd7</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span></pre><tr><td data-num=78><td><pre>	<span class="token number">0x7c</span><span class="token punctuation">,</span> <span class="token number">0xe3</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0x9b</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0x8e</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0xc4</span><span class="token punctuation">,</span> <span class="token number">0xde</span><span class="token punctuation">,</span> <span class="token number">0xe9</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span></pre><tr><td data-num=79><td><pre>	<span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x7b</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0x3d</span><span class="token punctuation">,</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xc3</span><span class="token punctuation">,</span> <span class="token number">0x4e</span><span class="token punctuation">,</span></pre><tr><td data-num=80><td><pre>	<span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x2e</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0xb2</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x5b</span><span class="token punctuation">,</span> <span class="token number">0xa2</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x6d</span><span class="token punctuation">,</span> <span class="token number">0x8b</span><span class="token punctuation">,</span> <span class="token number">0xd1</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span></pre><tr><td data-num=81><td><pre>	<span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xf8</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xa4</span><span class="token punctuation">,</span> <span class="token number">0x5c</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0xb6</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span></pre><tr><td data-num=82><td><pre>	<span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0xfd</span><span class="token punctuation">,</span> <span class="token number">0xed</span><span class="token punctuation">,</span> <span class="token number">0xb9</span><span class="token punctuation">,</span> <span class="token number">0xda</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0xa7</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span></pre><tr><td data-num=83><td><pre>	<span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x8c</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0xb8</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span></pre><tr><td data-num=84><td><pre>	<span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x1e</span><span class="token punctuation">,</span> <span class="token number">0x8f</span><span class="token punctuation">,</span> <span class="token number">0xca</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0x0f</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0xc1</span><span class="token punctuation">,</span> <span class="token number">0xaf</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span></pre><tr><td data-num=85><td><pre>	<span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0xea</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0xf2</span><span class="token punctuation">,</span> <span class="token number">0xcf</span><span class="token punctuation">,</span> <span class="token number">0xce</span><span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0xb4</span><span class="token punctuation">,</span> <span class="token number">0xe6</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span></pre><tr><td data-num=86><td><pre>	<span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0xac</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0xe7</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0xe2</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0x1c</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0xdf</span><span class="token punctuation">,</span> <span class="token number">0x6e</span><span class="token punctuation">,</span></pre><tr><td data-num=87><td><pre>	<span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0xf1</span><span class="token punctuation">,</span> <span class="token number">0x1a</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0xb7</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span></pre><tr><td data-num=88><td><pre>	<span class="token number">0xfc</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x3e</span><span class="token punctuation">,</span> <span class="token number">0x4b</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0xd2</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0xdb</span><span class="token punctuation">,</span> <span class="token number">0xc0</span><span class="token punctuation">,</span> <span class="token number">0xfe</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0xcd</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0xf4</span><span class="token punctuation">,</span></pre><tr><td data-num=89><td><pre>	<span class="token number">0x1f</span><span class="token punctuation">,</span> <span class="token number">0xdd</span><span class="token punctuation">,</span> <span class="token number">0xa8</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0xc7</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0xb1</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xec</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span></pre><tr><td data-num=90><td><pre>	<span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x7f</span><span class="token punctuation">,</span> <span class="token number">0xa9</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0xb5</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span> <span class="token number">0xe5</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0xc9</span><span class="token punctuation">,</span> <span class="token number">0x9c</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span></pre><tr><td data-num=91><td><pre>	<span class="token number">0xa0</span><span class="token punctuation">,</span> <span class="token number">0xe0</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0x2a</span><span class="token punctuation">,</span> <span class="token number">0xf5</span><span class="token punctuation">,</span> <span class="token number">0xb0</span><span class="token punctuation">,</span> <span class="token number">0xc8</span><span class="token punctuation">,</span> <span class="token number">0xeb</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0x3c</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span></pre><tr><td data-num=92><td><pre>	<span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0x2b</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x7e</span><span class="token punctuation">,</span> <span class="token number">0xba</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0xd6</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token number">0x7d</span></pre><tr><td data-num=93><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=94><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=95><td><pre><span class="token class-name">uint8_t</span> <span class="token function">aes_sub_sbox</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> val<span class="token punctuation">)</span></pre><tr><td data-num=96><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=97><td><pre>	<span class="token keyword">return</span> g_aes_sbox<span class="token punctuation">[</span>val<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=98><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=99><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=100><td><pre><span class="token class-name">uint32_t</span> <span class="token function">aes_sub_dword</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span> val<span class="token punctuation">)</span></pre><tr><td data-num=101><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=102><td><pre>	<span class="token class-name">uint32_t</span> tmp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=103><td><pre></pre><tr><td data-num=104><td><pre>	tmp <span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token punctuation">)</span><span class="token function">aes_sub_sbox</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val <span class="token operator">>></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=105><td><pre>	tmp <span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token punctuation">)</span><span class="token function">aes_sub_sbox</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">8</span><span class="token punctuation">;</span></pre><tr><td data-num=106><td><pre>	tmp <span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token punctuation">)</span><span class="token function">aes_sub_sbox</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">16</span><span class="token punctuation">;</span></pre><tr><td data-num=107><td><pre>	tmp <span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token punctuation">)</span><span class="token function">aes_sub_sbox</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">24</span><span class="token punctuation">;</span></pre><tr><td data-num=108><td><pre></pre><tr><td data-num=109><td><pre>	<span class="token keyword">return</span> tmp<span class="token punctuation">;</span></pre><tr><td data-num=110><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=111><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=112><td><pre><span class="token class-name">uint32_t</span> <span class="token function">aes_rot_dword</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span> val<span class="token punctuation">)</span></pre><tr><td data-num=113><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=114><td><pre>	<span class="token class-name">uint32_t</span> tmp <span class="token operator">=</span> val<span class="token punctuation">;</span></pre><tr><td data-num=115><td><pre></pre><tr><td data-num=116><td><pre>	<span class="token keyword">return</span> <span class="token punctuation">(</span>val <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tmp <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=117><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=118><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=119><td><pre><span class="token class-name">uint32_t</span> <span class="token function">aes_swap_dword</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span> val<span class="token punctuation">)</span></pre><tr><td data-num=120><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=121><td><pre>	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val <span class="token operator">&</span> <span class="token number">0x000000FF</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span></pre><tr><td data-num=122><td><pre>		<span class="token punctuation">(</span><span class="token punctuation">(</span>val <span class="token operator">&</span> <span class="token number">0x0000FF00</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span></pre><tr><td data-num=123><td><pre>		<span class="token punctuation">(</span><span class="token punctuation">(</span>val <span class="token operator">&</span> <span class="token number">0x00FF0000</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span></pre><tr><td data-num=124><td><pre>		<span class="token punctuation">(</span><span class="token punctuation">(</span>val <span class="token operator">&</span> <span class="token number">0xFF000000</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=125><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=126><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=127><td><pre><span class="token comment">/*</span></pre><tr><td data-num=128><td><pre>* nr: number of rounds</pre><tr><td data-num=129><td><pre>* nb: number of columns comprising the state, nb = 4 dwords (16 bytes)</pre><tr><td data-num=130><td><pre>* nk: number of 32-bit words comprising cipher key, nk = 4, 6, 8 (KeyLength/(4*8))</pre><tr><td data-num=131><td><pre>*/</pre><tr><td data-num=132><td><pre><span class="token keyword">void</span> <span class="token function">aes_key_expansion</span><span class="token punctuation">(</span>AES_CYPHER_T mode<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>key<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>round<span class="token punctuation">)</span></pre><tr><td data-num=133><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=134><td><pre>	<span class="token class-name">uint32_t</span> <span class="token operator">*</span>w <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">uint32_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>round<span class="token punctuation">;</span></pre><tr><td data-num=135><td><pre>	<span class="token class-name">uint32_t</span>  t<span class="token punctuation">;</span></pre><tr><td data-num=136><td><pre>	<span class="token keyword">int</span>      i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=137><td><pre></pre><tr><td data-num=138><td><pre>	<span class="token keyword">do</span> <span class="token punctuation">{</span></pre><tr><td data-num=139><td><pre>		w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&</span>key<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=140><td><pre>	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">++</span>i <span class="token operator"><</span> g_aes_nk<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=141><td><pre></pre><tr><td data-num=142><td><pre>	<span class="token keyword">do</span> <span class="token punctuation">{</span></pre><tr><td data-num=143><td><pre>		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">%</span> g_aes_nk<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=144><td><pre>			t <span class="token operator">=</span> <span class="token function">aes_rot_dword</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=145><td><pre>			t <span class="token operator">=</span> <span class="token function">aes_sub_dword</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=146><td><pre>			t <span class="token operator">=</span> t <span class="token operator">^</span> <span class="token function">aes_swap_dword</span><span class="token punctuation">(</span>g_aes_rcon<span class="token punctuation">[</span>i <span class="token operator">/</span> g_aes_nk<span class="token punctuation">[</span>mode<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=147><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=148><td><pre>		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>g_aes_nk<span class="token punctuation">[</span>mode<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">6</span> <span class="token operator">&&</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> g_aes_nk<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=149><td><pre>			t <span class="token operator">=</span> <span class="token function">aes_sub_dword</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=150><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=151><td><pre>		<span class="token keyword">else</span> <span class="token punctuation">{</span></pre><tr><td data-num=152><td><pre>			t <span class="token operator">=</span> w<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=153><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=154><td><pre>		w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> w<span class="token punctuation">[</span>i <span class="token operator">-</span> g_aes_nk<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">^</span> t<span class="token punctuation">;</span></pre><tr><td data-num=155><td><pre>	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">++</span>i <span class="token operator"><</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>g_aes_rounds<span class="token punctuation">[</span>mode<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=156><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=157><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=158><td><pre><span class="token keyword">void</span> <span class="token function">aes_add_round_key</span><span class="token punctuation">(</span>AES_CYPHER_T mode<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>state<span class="token punctuation">,</span></pre><tr><td data-num=159><td><pre>	<span class="token class-name">uint8_t</span> <span class="token operator">*</span>round<span class="token punctuation">,</span> <span class="token keyword">int</span> nr<span class="token punctuation">)</span></pre><tr><td data-num=160><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=161><td><pre>	<span class="token class-name">uint32_t</span> <span class="token operator">*</span>w <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">uint32_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>round<span class="token punctuation">;</span></pre><tr><td data-num=162><td><pre>	<span class="token class-name">uint32_t</span> <span class="token operator">*</span>s <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">uint32_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>state<span class="token punctuation">;</span></pre><tr><td data-num=163><td><pre>	<span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=164><td><pre></pre><tr><td data-num=165><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=166><td><pre>		s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> w<span class="token punctuation">[</span>nr <span class="token operator">*</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span> <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=167><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=168><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=169><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=170><td><pre><span class="token keyword">void</span> <span class="token function">aes_sub_bytes</span><span class="token punctuation">(</span>AES_CYPHER_T mode<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>state<span class="token punctuation">)</span></pre><tr><td data-num=171><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=172><td><pre>	<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span></pre><tr><td data-num=173><td><pre></pre><tr><td data-num=174><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=175><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=176><td><pre>			state<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">aes_sub_sbox</span><span class="token punctuation">(</span>state<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=177><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=178><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=179><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=180><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=181><td><pre><span class="token keyword">void</span> <span class="token function">aes_shift_rows</span><span class="token punctuation">(</span>AES_CYPHER_T mode<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>state<span class="token punctuation">)</span></pre><tr><td data-num=182><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=183><td><pre>	<span class="token class-name">uint8_t</span> <span class="token operator">*</span>s <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>state<span class="token punctuation">;</span></pre><tr><td data-num=184><td><pre>	<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> r<span class="token punctuation">;</span></pre><tr><td data-num=185><td><pre></pre><tr><td data-num=186><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator"><</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=187><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> i<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=188><td><pre>			<span class="token class-name">uint8_t</span> tmp <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=189><td><pre>			<span class="token keyword">for</span> <span class="token punctuation">(</span>r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator"><</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> r<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=190><td><pre>				s<span class="token punctuation">[</span>i <span class="token operator">+</span> r <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token punctuation">(</span>r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=191><td><pre>			<span class="token punctuation">}</span></pre><tr><td data-num=192><td><pre>			s<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token punctuation">(</span>g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span></pre><tr><td data-num=193><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=194><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=195><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=196><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=197><td><pre><span class="token class-name">uint8_t</span> <span class="token function">aes_xtime</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> x<span class="token punctuation">)</span></pre><tr><td data-num=198><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=199><td><pre>	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator"><<</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">>></span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0x1b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=200><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=201><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=202><td><pre><span class="token class-name">uint8_t</span> <span class="token function">aes_xtimes</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> ts<span class="token punctuation">)</span></pre><tr><td data-num=203><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=204><td><pre>	<span class="token keyword">while</span> <span class="token punctuation">(</span>ts<span class="token operator">--</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=205><td><pre>		x <span class="token operator">=</span> <span class="token function">aes_xtime</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=206><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=207><td><pre></pre><tr><td data-num=208><td><pre>	<span class="token keyword">return</span> x<span class="token punctuation">;</span></pre><tr><td data-num=209><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=210><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=211><td><pre><span class="token class-name">uint8_t</span> <span class="token function">aes_mul</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> x<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> y<span class="token punctuation">)</span></pre><tr><td data-num=212><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=213><td><pre>	<span class="token comment">/*</span></pre><tr><td data-num=214><td><pre>	* encrypt: y has only 2 bits: can be 1, 2 or 3</pre><tr><td data-num=215><td><pre>	* decrypt: y could be any value of 9, b, d, or e</pre><tr><td data-num=216><td><pre>	*/</pre><tr><td data-num=217><td><pre></pre><tr><td data-num=218><td><pre>	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">aes_xtimes</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span></pre><tr><td data-num=219><td><pre>		<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">aes_xtimes</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span></pre><tr><td data-num=220><td><pre>		<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">aes_xtimes</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span></pre><tr><td data-num=221><td><pre>		<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">aes_xtimes</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span></pre><tr><td data-num=222><td><pre>		<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">aes_xtimes</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span></pre><tr><td data-num=223><td><pre>		<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">aes_xtimes</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span></pre><tr><td data-num=224><td><pre>		<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">aes_xtimes</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span></pre><tr><td data-num=225><td><pre>		<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">aes_xtimes</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=226><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=227><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=228><td><pre><span class="token keyword">void</span> <span class="token function">aes_mix_columns</span><span class="token punctuation">(</span>AES_CYPHER_T mode<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>state<span class="token punctuation">)</span></pre><tr><td data-num=229><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=230><td><pre>	<span class="token class-name">uint8_t</span> y<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=231><td><pre>	<span class="token class-name">uint8_t</span> s<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=232><td><pre>	<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> r<span class="token punctuation">;</span></pre><tr><td data-num=233><td><pre></pre><tr><td data-num=234><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=235><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator"><</span> <span class="token number">4</span><span class="token punctuation">;</span> r<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=236><td><pre>			s<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=237><td><pre>			<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=238><td><pre>				s<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token function">aes_mul</span><span class="token punctuation">(</span>state<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>r <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=239><td><pre>			<span class="token punctuation">}</span></pre><tr><td data-num=240><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=241><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator"><</span> <span class="token number">4</span><span class="token punctuation">;</span> r<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=242><td><pre>			state<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> r<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=243><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=244><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=245><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=246><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=247><td><pre><span class="token keyword">int</span> <span class="token function">aes_encrypt</span><span class="token punctuation">(</span>AES_CYPHER_T mode<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>data<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>key<span class="token punctuation">)</span></pre><tr><td data-num=248><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=249><td><pre>	<span class="token class-name">uint8_t</span> w<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">/* round key */</span></pre><tr><td data-num=250><td><pre>	<span class="token class-name">uint8_t</span> s<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">/* state */</span></pre><tr><td data-num=251><td><pre></pre><tr><td data-num=252><td><pre>	<span class="token keyword">int</span> nr<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span></pre><tr><td data-num=253><td><pre></pre><tr><td data-num=254><td><pre>	<span class="token comment">/* key expansion */</span></pre><tr><td data-num=255><td><pre>	<span class="token function">aes_key_expansion</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> key<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=256><td><pre></pre><tr><td data-num=257><td><pre>	<span class="token comment">/* start data cypher loop over input buffer */</span></pre><tr><td data-num=258><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> len<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">4</span> <span class="token operator">*</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=259><td><pre></pre><tr><td data-num=260><td><pre>		<span class="token comment">/* init state from user buffer (plaintext) */</span></pre><tr><td data-num=261><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> <span class="token number">4</span> <span class="token operator">*</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span></pre><tr><td data-num=262><td><pre>			s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=263><td><pre></pre><tr><td data-num=264><td><pre>		<span class="token comment">/* start AES cypher loop over all AES rounds */</span></pre><tr><td data-num=265><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>nr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> nr <span class="token operator"><=</span> g_aes_rounds<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> nr<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=266><td><pre></pre><tr><td data-num=267><td><pre>			<span class="token keyword">if</span> <span class="token punctuation">(</span>nr <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=268><td><pre></pre><tr><td data-num=269><td><pre>				<span class="token comment">/* do SubBytes */</span></pre><tr><td data-num=270><td><pre>				<span class="token function">aes_sub_bytes</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=271><td><pre></pre><tr><td data-num=272><td><pre>				<span class="token comment">/* do ShiftRows */</span></pre><tr><td data-num=273><td><pre>				<span class="token function">aes_shift_rows</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=274><td><pre></pre><tr><td data-num=275><td><pre>				<span class="token keyword">if</span> <span class="token punctuation">(</span>nr <span class="token operator"><</span> g_aes_rounds<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=276><td><pre>					<span class="token comment">/* do MixColumns */</span></pre><tr><td data-num=277><td><pre>					<span class="token function">aes_mix_columns</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=278><td><pre>				<span class="token punctuation">}</span></pre><tr><td data-num=279><td><pre>			<span class="token punctuation">}</span></pre><tr><td data-num=280><td><pre></pre><tr><td data-num=281><td><pre>			<span class="token comment">/* do AddRoundKey */</span></pre><tr><td data-num=282><td><pre>			<span class="token function">aes_add_round_key</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">,</span> w<span class="token punctuation">,</span> nr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=283><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=284><td><pre></pre><tr><td data-num=285><td><pre>		<span class="token comment">/* save state (cypher) to user buffer */</span></pre><tr><td data-num=286><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> <span class="token number">4</span> <span class="token operator">*</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span></pre><tr><td data-num=287><td><pre>			data<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=288><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=289><td><pre></pre><tr><td data-num=290><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=291><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=292><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=293><td><pre><span class="token keyword">int</span> <span class="token function">aes_encrypt_ecb</span><span class="token punctuation">(</span>AES_CYPHER_T mode<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>data<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>key<span class="token punctuation">)</span></pre><tr><td data-num=294><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=295><td><pre>	<span class="token keyword">return</span> <span class="token function">aes_encrypt</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> data<span class="token punctuation">,</span> len<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=296><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=297><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=298><td><pre><span class="token keyword">int</span> <span class="token function">aes_encrypt_cbc</span><span class="token punctuation">(</span>AES_CYPHER_T mode<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>data<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>key<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>iv<span class="token punctuation">)</span></pre><tr><td data-num=299><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=300><td><pre>	<span class="token class-name">uint8_t</span> w<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">/* round key */</span></pre><tr><td data-num=301><td><pre>	<span class="token class-name">uint8_t</span> s<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">/* state */</span></pre><tr><td data-num=302><td><pre>	<span class="token class-name">uint8_t</span> v<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">/* iv */</span></pre><tr><td data-num=303><td><pre></pre><tr><td data-num=304><td><pre>	<span class="token keyword">int</span> nr<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span></pre><tr><td data-num=305><td><pre></pre><tr><td data-num=306><td><pre></pre><tr><td data-num=307><td><pre>	<span class="token comment">/* key expansion */</span></pre><tr><td data-num=308><td><pre>	<span class="token function">aes_key_expansion</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> key<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=309><td><pre></pre><tr><td data-num=310><td><pre>	<span class="token function">memcpy</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=311><td><pre></pre><tr><td data-num=312><td><pre>	<span class="token comment">/* start data cypher loop over input buffer */</span></pre><tr><td data-num=313><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> len<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">4</span> <span class="token operator">*</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=314><td><pre></pre><tr><td data-num=315><td><pre>		<span class="token comment">/* init state from user buffer (plaintext) */</span></pre><tr><td data-num=316><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> <span class="token number">4</span> <span class="token operator">*</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span></pre><tr><td data-num=317><td><pre>			s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">^</span> v<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=318><td><pre></pre><tr><td data-num=319><td><pre>		<span class="token comment">/* start AES cypher loop over all AES rounds */</span></pre><tr><td data-num=320><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>nr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> nr <span class="token operator"><=</span> g_aes_rounds<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> nr<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=321><td><pre></pre><tr><td data-num=322><td><pre>			<span class="token keyword">if</span> <span class="token punctuation">(</span>nr <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=323><td><pre></pre><tr><td data-num=324><td><pre>				<span class="token comment">/* do SubBytes */</span></pre><tr><td data-num=325><td><pre>				<span class="token function">aes_sub_bytes</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=326><td><pre></pre><tr><td data-num=327><td><pre>				<span class="token comment">/* do ShiftRows */</span></pre><tr><td data-num=328><td><pre>				<span class="token function">aes_shift_rows</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=329><td><pre></pre><tr><td data-num=330><td><pre>				<span class="token keyword">if</span> <span class="token punctuation">(</span>nr <span class="token operator"><</span> g_aes_rounds<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=331><td><pre>					<span class="token comment">/* do MixColumns */</span></pre><tr><td data-num=332><td><pre>					<span class="token function">aes_mix_columns</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=333><td><pre>				<span class="token punctuation">}</span></pre><tr><td data-num=334><td><pre>			<span class="token punctuation">}</span></pre><tr><td data-num=335><td><pre></pre><tr><td data-num=336><td><pre>			<span class="token comment">/* do AddRoundKey */</span></pre><tr><td data-num=337><td><pre>			<span class="token function">aes_add_round_key</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">,</span> w<span class="token punctuation">,</span> nr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=338><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=339><td><pre></pre><tr><td data-num=340><td><pre>		<span class="token comment">/* save state (cypher) to user buffer */</span></pre><tr><td data-num=341><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> <span class="token number">4</span> <span class="token operator">*</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span></pre><tr><td data-num=342><td><pre>			data<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=343><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=344><td><pre></pre><tr><td data-num=345><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=346><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=347><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=348><td><pre><span class="token keyword">void</span> <span class="token function">inv_shift_rows</span><span class="token punctuation">(</span>AES_CYPHER_T mode<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>state<span class="token punctuation">)</span></pre><tr><td data-num=349><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=350><td><pre>	<span class="token class-name">uint8_t</span> <span class="token operator">*</span>s <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>state<span class="token punctuation">;</span></pre><tr><td data-num=351><td><pre>	<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> r<span class="token punctuation">;</span></pre><tr><td data-num=352><td><pre></pre><tr><td data-num=353><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator"><</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=354><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span> <span class="token operator">-</span> i<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=355><td><pre>			<span class="token class-name">uint8_t</span> tmp <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=356><td><pre>			<span class="token keyword">for</span> <span class="token punctuation">(</span>r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator"><</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> r<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=357><td><pre>				s<span class="token punctuation">[</span>i <span class="token operator">+</span> r <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token punctuation">(</span>r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=358><td><pre>			<span class="token punctuation">}</span></pre><tr><td data-num=359><td><pre>			s<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token punctuation">(</span>g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span></pre><tr><td data-num=360><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=361><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=362><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=363><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=364><td><pre><span class="token class-name">uint8_t</span> <span class="token function">inv_sub_sbox</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> val<span class="token punctuation">)</span></pre><tr><td data-num=365><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=366><td><pre>	<span class="token keyword">return</span> g_inv_sbox<span class="token punctuation">[</span>val<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=367><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=368><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=369><td><pre><span class="token keyword">void</span> <span class="token function">inv_sub_bytes</span><span class="token punctuation">(</span>AES_CYPHER_T mode<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>state<span class="token punctuation">)</span></pre><tr><td data-num=370><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=371><td><pre>	<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span></pre><tr><td data-num=372><td><pre></pre><tr><td data-num=373><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=374><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=375><td><pre>			state<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">inv_sub_sbox</span><span class="token punctuation">(</span>state<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=376><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=377><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=378><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=379><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=380><td><pre><span class="token keyword">void</span> <span class="token function">inv_mix_columns</span><span class="token punctuation">(</span>AES_CYPHER_T mode<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>state<span class="token punctuation">)</span></pre><tr><td data-num=381><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=382><td><pre>	<span class="token class-name">uint8_t</span> y<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span>  <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span></pre><tr><td data-num=383><td><pre>		<span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span>  <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x0e</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=384><td><pre>	<span class="token class-name">uint8_t</span> s<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=385><td><pre>	<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> r<span class="token punctuation">;</span></pre><tr><td data-num=386><td><pre></pre><tr><td data-num=387><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=388><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator"><</span> <span class="token number">4</span><span class="token punctuation">;</span> r<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=389><td><pre>			s<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=390><td><pre>			<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=391><td><pre>				s<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token function">aes_mul</span><span class="token punctuation">(</span>state<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>r <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=392><td><pre>			<span class="token punctuation">}</span></pre><tr><td data-num=393><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=394><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator"><</span> <span class="token number">4</span><span class="token punctuation">;</span> r<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=395><td><pre>			state<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> r<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=396><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=397><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=398><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=399><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=400><td><pre><span class="token keyword">int</span> <span class="token function">aes_decrypt</span><span class="token punctuation">(</span>AES_CYPHER_T mode<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>data<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>key<span class="token punctuation">)</span></pre><tr><td data-num=401><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=402><td><pre>	<span class="token class-name">uint8_t</span> w<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">/* round key */</span></pre><tr><td data-num=403><td><pre>	<span class="token class-name">uint8_t</span> s<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">/* state */</span></pre><tr><td data-num=404><td><pre></pre><tr><td data-num=405><td><pre>	<span class="token keyword">int</span> nr<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span></pre><tr><td data-num=406><td><pre></pre><tr><td data-num=407><td><pre>	<span class="token comment">/* key expansion */</span></pre><tr><td data-num=408><td><pre>	<span class="token function">aes_key_expansion</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> key<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=409><td><pre></pre><tr><td data-num=410><td><pre>	<span class="token comment">/* start data cypher loop over input buffer */</span></pre><tr><td data-num=411><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> len<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">4</span> <span class="token operator">*</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=412><td><pre></pre><tr><td data-num=413><td><pre>		<span class="token comment">/* init state from user buffer (cyphertext) */</span></pre><tr><td data-num=414><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> <span class="token number">4</span> <span class="token operator">*</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span></pre><tr><td data-num=415><td><pre>			s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=416><td><pre></pre><tr><td data-num=417><td><pre>		<span class="token comment">/* start AES cypher loop over all AES rounds */</span></pre><tr><td data-num=418><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>nr <span class="token operator">=</span> g_aes_rounds<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> nr <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> nr<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=419><td><pre></pre><tr><td data-num=420><td><pre>			<span class="token comment">/* do AddRoundKey */</span></pre><tr><td data-num=421><td><pre>			<span class="token function">aes_add_round_key</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">,</span> w<span class="token punctuation">,</span> nr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=422><td><pre></pre><tr><td data-num=423><td><pre>			<span class="token keyword">if</span> <span class="token punctuation">(</span>nr <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=424><td><pre></pre><tr><td data-num=425><td><pre>				<span class="token keyword">if</span> <span class="token punctuation">(</span>nr <span class="token operator"><</span> g_aes_rounds<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=426><td><pre>					<span class="token comment">/* do MixColumns */</span></pre><tr><td data-num=427><td><pre>					<span class="token function">inv_mix_columns</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=428><td><pre>				<span class="token punctuation">}</span></pre><tr><td data-num=429><td><pre></pre><tr><td data-num=430><td><pre>				<span class="token comment">/* do ShiftRows */</span></pre><tr><td data-num=431><td><pre>				<span class="token function">inv_shift_rows</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=432><td><pre></pre><tr><td data-num=433><td><pre>				<span class="token comment">/* do SubBytes */</span></pre><tr><td data-num=434><td><pre>				<span class="token function">inv_sub_bytes</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=435><td><pre>			<span class="token punctuation">}</span></pre><tr><td data-num=436><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=437><td><pre></pre><tr><td data-num=438><td><pre>		<span class="token comment">/* save state (cypher) to user buffer */</span></pre><tr><td data-num=439><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> <span class="token number">4</span> <span class="token operator">*</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span></pre><tr><td data-num=440><td><pre>			data<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=441><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=442><td><pre></pre><tr><td data-num=443><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=444><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=445><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=446><td><pre><span class="token keyword">int</span> <span class="token function">aes_decrypt_ecb</span><span class="token punctuation">(</span>AES_CYPHER_T mode<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>data<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>key<span class="token punctuation">)</span></pre><tr><td data-num=447><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=448><td><pre>	<span class="token keyword">return</span> <span class="token function">aes_decrypt</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> data<span class="token punctuation">,</span> len<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=449><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=450><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=451><td><pre><span class="token keyword">int</span> <span class="token function">aes_decrypt_cbc</span><span class="token punctuation">(</span>AES_CYPHER_T mode<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>data<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>key<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>iv<span class="token punctuation">)</span></pre><tr><td data-num=452><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=453><td><pre>	<span class="token class-name">uint8_t</span> w<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">/* round key */</span></pre><tr><td data-num=454><td><pre>	<span class="token class-name">uint8_t</span> s<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">/* state */</span></pre><tr><td data-num=455><td><pre>	<span class="token class-name">uint8_t</span> v<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">/* iv */</span></pre><tr><td data-num=456><td><pre></pre><tr><td data-num=457><td><pre></pre><tr><td data-num=458><td><pre>	<span class="token keyword">int</span> nr<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span></pre><tr><td data-num=459><td><pre></pre><tr><td data-num=460><td><pre>	<span class="token comment">/* key expansion */</span></pre><tr><td data-num=461><td><pre>	<span class="token function">aes_key_expansion</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> key<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=462><td><pre></pre><tr><td data-num=463><td><pre>	<span class="token function">memcpy</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=464><td><pre></pre><tr><td data-num=465><td><pre>	<span class="token comment">/* start data cypher loop over input buffer */</span></pre><tr><td data-num=466><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> len<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">4</span> <span class="token operator">*</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=467><td><pre></pre><tr><td data-num=468><td><pre></pre><tr><td data-num=469><td><pre>		<span class="token comment">/* init state from user buffer (cyphertext) */</span></pre><tr><td data-num=470><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> <span class="token number">4</span> <span class="token operator">*</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span></pre><tr><td data-num=471><td><pre>			s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=472><td><pre></pre><tr><td data-num=473><td><pre>		<span class="token comment">/* start AES cypher loop over all AES rounds */</span></pre><tr><td data-num=474><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>nr <span class="token operator">=</span> g_aes_rounds<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> nr <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> nr<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=475><td><pre></pre><tr><td data-num=476><td><pre>			<span class="token comment">/* do AddRoundKey */</span></pre><tr><td data-num=477><td><pre>			<span class="token function">aes_add_round_key</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">,</span> w<span class="token punctuation">,</span> nr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=478><td><pre></pre><tr><td data-num=479><td><pre>			<span class="token keyword">if</span> <span class="token punctuation">(</span>nr <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=480><td><pre></pre><tr><td data-num=481><td><pre>				<span class="token keyword">if</span> <span class="token punctuation">(</span>nr <span class="token operator"><</span> g_aes_rounds<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=482><td><pre>					<span class="token comment">/* do MixColumns */</span></pre><tr><td data-num=483><td><pre>					<span class="token function">inv_mix_columns</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=484><td><pre>				<span class="token punctuation">}</span></pre><tr><td data-num=485><td><pre></pre><tr><td data-num=486><td><pre>				<span class="token comment">/* do ShiftRows */</span></pre><tr><td data-num=487><td><pre>				<span class="token function">inv_shift_rows</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=488><td><pre></pre><tr><td data-num=489><td><pre>				<span class="token comment">/* do SubBytes */</span></pre><tr><td data-num=490><td><pre>				<span class="token function">inv_sub_bytes</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=491><td><pre>			<span class="token punctuation">}</span></pre><tr><td data-num=492><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=493><td><pre></pre><tr><td data-num=494><td><pre>		<span class="token comment">/* save state (cypher) to user buffer */</span></pre><tr><td data-num=495><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> <span class="token number">4</span> <span class="token operator">*</span> g_aes_nb<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=496><td><pre>			<span class="token class-name">uint8_t</span> p <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">^</span> v<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=497><td><pre>			v<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=498><td><pre>			data<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> p<span class="token punctuation">;</span></pre><tr><td data-num=499><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=500><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=501><td><pre></pre><tr><td data-num=502><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=503><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=504><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=505><td><pre><span class="token keyword">void</span> <span class="token function">aes_cypher_128_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=506><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=507><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">1</span></span></span></pre><tr><td data-num=508><td><pre>	<span class="token class-name">uint8_t</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span></pre><tr><td data-num=509><td><pre>		<span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0xdd</span><span class="token punctuation">,</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0xff</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=510><td><pre>	<span class="token class-name">uint8_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span></pre><tr><td data-num=511><td><pre>		<span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x0f</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=512><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span></pre><tr><td data-num=513><td><pre>	<span class="token class-name">uint8_t</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0xa8</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span></pre><tr><td data-num=514><td><pre>		<span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0xa2</span><span class="token punctuation">,</span> <span class="token number">0xe0</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0x34</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=515><td><pre>	<span class="token class-name">uint8_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x2b</span><span class="token punctuation">,</span> <span class="token number">0x7e</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0xd2</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span></pre><tr><td data-num=516><td><pre>		<span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0xcf</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">,</span> <span class="token number">0x3c</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=517><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span></pre><tr><td data-num=518><td><pre></pre><tr><td data-num=519><td><pre>	<span class="token function">aes_encrypt</span><span class="token punctuation">(</span>AES_CYPHER_128<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=520><td><pre></pre><tr><td data-num=521><td><pre>	<span class="token function">aes_decrypt</span><span class="token punctuation">(</span>AES_CYPHER_128<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=522><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=523><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=524><td><pre><span class="token keyword">void</span> <span class="token function">aes_cypher_192_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=525><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=526><td><pre>	<span class="token class-name">uint8_t</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span></pre><tr><td data-num=527><td><pre>		<span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0xdd</span><span class="token punctuation">,</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0xff</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=528><td><pre>	<span class="token class-name">uint8_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span></pre><tr><td data-num=529><td><pre>		<span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x0f</span><span class="token punctuation">,</span></pre><tr><td data-num=530><td><pre>		<span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0x17</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=531><td><pre></pre><tr><td data-num=532><td><pre>	<span class="token function">aes_encrypt</span><span class="token punctuation">(</span>AES_CYPHER_192<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=533><td><pre></pre><tr><td data-num=534><td><pre>	<span class="token function">aes_decrypt</span><span class="token punctuation">(</span>AES_CYPHER_192<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=535><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=536><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=537><td><pre><span class="token keyword">void</span> <span class="token function">aes_cypher_256_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=538><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=539><td><pre>	<span class="token class-name">uint8_t</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span></pre><tr><td data-num=540><td><pre>		<span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0xdd</span><span class="token punctuation">,</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0xff</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=541><td><pre>	<span class="token class-name">uint8_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span></pre><tr><td data-num=542><td><pre>		<span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x0f</span><span class="token punctuation">,</span></pre><tr><td data-num=543><td><pre>		<span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span></pre><tr><td data-num=544><td><pre>		<span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x1a</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x1c</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x1e</span><span class="token punctuation">,</span> <span class="token number">0x1f</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=545><td><pre></pre><tr><td data-num=546><td><pre>	<span class="token function">aes_encrypt</span><span class="token punctuation">(</span>AES_CYPHER_256<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=547><td><pre></pre><tr><td data-num=548><td><pre>	<span class="token function">aes_decrypt</span><span class="token punctuation">(</span>AES_CYPHER_256<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=549><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=550><td><pre><span class="token comment">/****************************************************************************************************************/</span></pre><tr><td data-num=551><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=552><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=553><td><pre>	<span class="token comment">// 数据</span></pre><tr><td data-num=554><td><pre>	<span class="token class-name">uint8_t</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">204</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">,</span> <span class="token number">217</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">169</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">219</span><span class="token punctuation">,</span> <span class="token number">206</span><span class="token punctuation">,</span> <span class="token number">216</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">206</span><span class="token punctuation">,</span> <span class="token number">138</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=555><td><pre>	<span class="token comment">// 密钥</span></pre><tr><td data-num=556><td><pre>	<span class="token class-name">uint8_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">104</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">106</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">112</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=557><td><pre>	<span class="token comment">// 向量</span></pre><tr><td data-num=558><td><pre>	<span class="token comment">//uint8_t iv[] = {};</span></pre><tr><td data-num=559><td><pre>	<span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=560><td><pre>	<span class="token punctuation">{</span></pre><tr><td data-num=561><td><pre>	<span class="token comment">//ECB</span></pre><tr><td data-num=562><td><pre>	<span class="token keyword">case</span> <span class="token number">16</span><span class="token operator">:</span><span class="token function">aes_decrypt</span><span class="token punctuation">(</span>AES_CYPHER_128<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span></pre><tr><td data-num=563><td><pre>	<span class="token keyword">case</span> <span class="token number">24</span><span class="token operator">:</span><span class="token function">aes_decrypt</span><span class="token punctuation">(</span>AES_CYPHER_192<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span></pre><tr><td data-num=564><td><pre>	<span class="token keyword">case</span> <span class="token number">32</span><span class="token operator">:</span><span class="token function">aes_decrypt</span><span class="token punctuation">(</span>AES_CYPHER_256<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span></pre><tr><td data-num=565><td><pre>	<span class="token comment">//CBC</span></pre><tr><td data-num=566><td><pre>	<span class="token comment">/*</span></pre><tr><td data-num=567><td><pre>	case 16:aes_decrypt_cbc(AES_CYPHER_128, buf, sizeof(buf), key, iv); break;</pre><tr><td data-num=568><td><pre>	case 24:aes_decrypt_cbc(AES_CYPHER_192, buf, sizeof(buf), key, iv); break;</pre><tr><td data-num=569><td><pre>	case 32:aes_decrypt_cbc(AES_CYPHER_256, buf, sizeof(buf), key, iv); break;</pre><tr><td data-num=570><td><pre>	*/</pre><tr><td data-num=571><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=572><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre><tr><td data-num=573><td><pre>	<span class="token punctuation">{</span></pre><tr><td data-num=574><td><pre>		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span> buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=575><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=576><td><pre>	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=577><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=578><td><pre><span class="token punctuation">}</span></pre></table></figure><figure class="highlight python"><figcaption data-lang=python></figcaption><table><tr><td data-num=1><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES</pre><tr><td data-num=2><td><pre><span class="token keyword">from</span> binascii <span class="token keyword">import</span> b2a_hex<span class="token punctuation">,</span> a2b_hex</pre><tr><td data-num=3><td><pre></pre><tr><td data-num=4><td><pre><span class="token keyword">def</span> <span class="token function">add_to_16</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=5><td><pre>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">:</span></pre><tr><td data-num=6><td><pre>        add <span class="token operator">=</span> <span class="token number">16</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span></pre><tr><td data-num=7><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre><tr><td data-num=8><td><pre>        add <span class="token operator">=</span> <span class="token number">0</span></pre><tr><td data-num=9><td><pre>    text <span class="token operator">=</span> text <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">'\0'</span> <span class="token operator">*</span> add<span class="token punctuation">)</span></pre><tr><td data-num=10><td><pre>    <span class="token keyword">return</span> text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span></pre><tr><td data-num=11><td><pre></pre><tr><td data-num=12><td><pre><span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=13><td><pre>    key <span class="token operator">=</span> <span class="token string">'\x4D\x4C\x57\x4E\x46\x7C\x19\x0A\x4D\x4C\x57\x4E\x46\x7C\x7B\x67'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span></pre><tr><td data-num=14><td><pre>    mode <span class="token operator">=</span> AES<span class="token punctuation">.</span>MODE_ECB</pre><tr><td data-num=15><td><pre>    text <span class="token operator">=</span> add_to_16<span class="token punctuation">(</span>text<span class="token punctuation">)</span></pre><tr><td data-num=16><td><pre>    cryptos <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> mode<span class="token punctuation">)</span></pre><tr><td data-num=17><td><pre>    cipher_text <span class="token operator">=</span> cryptos<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>text<span class="token punctuation">)</span></pre><tr><td data-num=18><td><pre>    <span class="token keyword">return</span> cipher_text</pre><tr><td data-num=19><td><pre></pre><tr><td data-num=20><td><pre><span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=21><td><pre>    key <span class="token operator">=</span> <span class="token string">'\x4D\x4C\x57\x4E\x46\x7C\x19\x0A\x4D\x4C\x57\x4E\x46\x7C\x7B\x67'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span></pre><tr><td data-num=22><td><pre>    mode <span class="token operator">=</span> AES<span class="token punctuation">.</span>MODE_ECB</pre><tr><td data-num=23><td><pre>    cryptor <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> mode<span class="token punctuation">)</span></pre><tr><td data-num=24><td><pre>    plain_text <span class="token operator">=</span> cryptor<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>a2b_hex<span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=25><td><pre>    <span class="token keyword">return</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span>plain_text<span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">'\0'</span><span class="token punctuation">)</span></pre><tr><td data-num=26><td><pre></pre><tr><td data-num=27><td><pre>data <span class="token operator">=</span> <span class="token string">b'\x96\x7f\x37\x7c\x26\x30\x03\xeb\x61\x6d\xa3\xda\x0c\x77\x3e\x7c\xdf\x18\x5d\x4e\xd9\xbe\x0a\x5c\x02\x36\x87\x37\xb4\x2f\xb1\x9f'</span></pre><tr><td data-num=28><td><pre>data <span class="token operator">=</span> b2a_hex<span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre><tr><td data-num=29><td><pre>ans <span class="token operator">=</span> decrypt<span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre><tr><td data-num=30><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span></pre></table></figure><h4 id=rc5><a class=anchor href=#rc5>#</a> RC5</h4><h4 id=rc6><a class=anchor href=#rc6>#</a> RC6</h4><h4 id=sm4><a class=anchor href=#sm4>#</a> SM4</h4><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&LTstring.h></span></span></pre><tr><td data-num=2><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&LTstdio.h></span></span></pre><tr><td data-num=3><td><pre></pre><tr><td data-num=4><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">GET_ULONG_BE</span></span></pre><tr><td data-num=5><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">GET_ULONG_BE</span><span class="token expression"><span class="token punctuation">(</span>n<span class="token punctuation">,</span>b<span class="token punctuation">,</span>i<span class="token punctuation">)</span> </span><span class="token punctuation">\</span></span></pre><tr><td data-num=6><td><pre>	<span class="token expression"><span class="token punctuation">{</span> </span><span class="token punctuation">\</span></pre><tr><td data-num=7><td><pre>		<span class="token expression"><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token operator"><<</span> <span class="token number">24</span> <span class="token punctuation">)</span> </span><span class="token punctuation">\</span></pre><tr><td data-num=8><td><pre>		      <span class="token expression"><span class="token operator">|</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator"><<</span> <span class="token number">16</span> <span class="token punctuation">)</span> </span><span class="token punctuation">\</span></pre><tr><td data-num=9><td><pre>		      <span class="token expression"><span class="token operator">|</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator"><<</span> <span class="token number">8</span> <span class="token punctuation">)</span> </span><span class="token punctuation">\</span></pre><tr><td data-num=10><td><pre>		      <span class="token expression"><span class="token operator">|</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span></pre><tr><td data-num=11><td><pre>	<span class="token expression"><span class="token punctuation">}</span></span></pre><tr><td data-num=12><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span></pre><tr><td data-num=13><td><pre></pre><tr><td data-num=14><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">PUT_ULONG_BE</span></span></pre><tr><td data-num=15><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">PUT_ULONG_BE</span><span class="token expression"><span class="token punctuation">(</span>n<span class="token punctuation">,</span>b<span class="token punctuation">,</span>i<span class="token punctuation">)</span> </span><span class="token punctuation">\</span></span></pre><tr><td data-num=16><td><pre>	<span class="token expression"><span class="token punctuation">{</span> </span><span class="token punctuation">\</span></pre><tr><td data-num=17><td><pre>		<span class="token expression"><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">24</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span></pre><tr><td data-num=18><td><pre>		<span class="token expression"><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">16</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span></pre><tr><td data-num=19><td><pre>		<span class="token expression"><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">8</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span></pre><tr><td data-num=20><td><pre>		<span class="token expression"><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span></pre><tr><td data-num=21><td><pre>	<span class="token expression"><span class="token punctuation">}</span></span></pre><tr><td data-num=22><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span></pre><tr><td data-num=23><td><pre></pre><tr><td data-num=24><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SHL</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xFFFFFFFF</span><span class="token punctuation">)</span> <span class="token operator"><<</span> n<span class="token punctuation">)</span></span></span></pre><tr><td data-num=25><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ROTL</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">SHL</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span></pre><tr><td data-num=26><td><pre></pre><tr><td data-num=27><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SWAP</span><span class="token expression"><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> t <span class="token operator">=</span> a<span class="token punctuation">;</span> a <span class="token operator">=</span> b<span class="token punctuation">;</span> b <span class="token operator">=</span> t<span class="token punctuation">;</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></span></span></pre><tr><td data-num=28><td><pre></pre><tr><td data-num=29><td><pre><span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> SboxTable<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=30><td><pre>	<span class="token punctuation">{</span><span class="token number">0xd6</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0xe9</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0xb7</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0xb6</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0xfb</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">}</span><span class="token punctuation">,</span></pre><tr><td data-num=31><td><pre>	<span class="token punctuation">{</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x9a</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0xbe</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0xc3</span><span class="token punctuation">,</span><span class="token number">0xaa</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x86</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">}</span><span class="token punctuation">,</span></pre><tr><td data-num=32><td><pre>	<span class="token punctuation">{</span><span class="token number">0x9c</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0xf4</span><span class="token punctuation">,</span><span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x7a</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0xed</span><span class="token punctuation">,</span><span class="token number">0xcf</span><span class="token punctuation">,</span><span class="token number">0xac</span><span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">}</span><span class="token punctuation">,</span></pre><tr><td data-num=33><td><pre>	<span class="token punctuation">{</span><span class="token number">0xe4</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0xa9</span><span class="token punctuation">,</span><span class="token number">0xc9</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0xe8</span><span class="token punctuation">,</span><span class="token number">0x95</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0xdf</span><span class="token punctuation">,</span><span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0xfa</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0x8f</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0xa6</span><span class="token punctuation">}</span><span class="token punctuation">,</span></pre><tr><td data-num=34><td><pre>	<span class="token punctuation">{</span><span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0xa7</span><span class="token punctuation">,</span><span class="token number">0xfc</span><span class="token punctuation">,</span><span class="token number">0xf3</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0xe6</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">}</span><span class="token punctuation">,</span></pre><tr><td data-num=35><td><pre>	<span class="token punctuation">{</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0x6b</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0xb2</span><span class="token punctuation">,</span><span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0xda</span><span class="token punctuation">,</span><span class="token number">0x8b</span><span class="token punctuation">,</span><span class="token number">0xf8</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x9d</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">}</span><span class="token punctuation">,</span></pre><tr><td data-num=36><td><pre>	<span class="token punctuation">{</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x5e</span><span class="token punctuation">,</span><span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0xd1</span><span class="token punctuation">,</span><span class="token number">0xa2</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">}</span><span class="token punctuation">,</span></pre><tr><td data-num=37><td><pre>	<span class="token punctuation">{</span><span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0xe7</span><span class="token punctuation">,</span><span class="token number">0xa0</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xc8</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">}</span><span class="token punctuation">,</span></pre><tr><td data-num=38><td><pre>	<span class="token punctuation">{</span><span class="token number">0xea</span><span class="token punctuation">,</span><span class="token number">0xbf</span><span class="token punctuation">,</span><span class="token number">0x8a</span><span class="token punctuation">,</span><span class="token number">0xd2</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0xc7</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0xb5</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0xf7</span><span class="token punctuation">,</span><span class="token number">0xf2</span><span class="token punctuation">,</span><span class="token number">0xce</span><span class="token punctuation">,</span><span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0xa1</span><span class="token punctuation">}</span><span class="token punctuation">,</span></pre><tr><td data-num=39><td><pre>	<span class="token punctuation">{</span><span class="token number">0xe0</span><span class="token punctuation">,</span><span class="token number">0xae</span><span class="token punctuation">,</span><span class="token number">0x5d</span><span class="token punctuation">,</span><span class="token number">0xa4</span><span class="token punctuation">,</span><span class="token number">0x9b</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x55</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0x93</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0xf5</span><span class="token punctuation">,</span><span class="token number">0x8c</span><span class="token punctuation">,</span><span class="token number">0xb1</span><span class="token punctuation">,</span><span class="token number">0xe3</span><span class="token punctuation">}</span><span class="token punctuation">,</span></pre><tr><td data-num=40><td><pre>	<span class="token punctuation">{</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0xf6</span><span class="token punctuation">,</span><span class="token number">0xe2</span><span class="token punctuation">,</span><span class="token number">0x2e</span><span class="token punctuation">,</span><span class="token number">0x82</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0xca</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0xc0</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0x0d</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0x4e</span><span class="token punctuation">,</span><span class="token number">0x6f</span><span class="token punctuation">}</span><span class="token punctuation">,</span></pre><tr><td data-num=41><td><pre>	<span class="token punctuation">{</span><span class="token number">0xd5</span><span class="token punctuation">,</span><span class="token number">0xdb</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0xde</span><span class="token punctuation">,</span><span class="token number">0xfd</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0xff</span><span class="token punctuation">,</span><span class="token number">0x6a</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span><span class="token number">0x6d</span><span class="token punctuation">,</span><span class="token number">0x6c</span><span class="token punctuation">,</span><span class="token number">0x5b</span><span class="token punctuation">,</span><span class="token number">0x51</span><span class="token punctuation">}</span><span class="token punctuation">,</span></pre><tr><td data-num=42><td><pre>	<span class="token punctuation">{</span><span class="token number">0x8d</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0x92</span><span class="token punctuation">,</span><span class="token number">0xbb</span><span class="token punctuation">,</span><span class="token number">0xdd</span><span class="token punctuation">,</span><span class="token number">0xbc</span><span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0xd9</span><span class="token punctuation">,</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x41</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x5a</span><span class="token punctuation">,</span><span class="token number">0xd8</span><span class="token punctuation">}</span><span class="token punctuation">,</span></pre><tr><td data-num=43><td><pre>	<span class="token punctuation">{</span><span class="token number">0x0a</span><span class="token punctuation">,</span><span class="token number">0xc1</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">,</span><span class="token number">0xa5</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0x7b</span><span class="token punctuation">,</span><span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span><span class="token number">0xd0</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0xb8</span><span class="token punctuation">,</span><span class="token number">0xe5</span><span class="token punctuation">,</span><span class="token number">0xb4</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">}</span><span class="token punctuation">,</span></pre><tr><td data-num=44><td><pre>	<span class="token punctuation">{</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x97</span><span class="token punctuation">,</span><span class="token number">0x4a</span><span class="token punctuation">,</span><span class="token number">0x0c</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0x77</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0xb9</span><span class="token punctuation">,</span><span class="token number">0xf1</span><span class="token punctuation">,</span><span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0xc5</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">}</span><span class="token punctuation">,</span></pre><tr><td data-num=45><td><pre>	<span class="token punctuation">{</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0xec</span><span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0x4d</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x79</span><span class="token punctuation">,</span><span class="token number">0xee</span><span class="token punctuation">,</span><span class="token number">0x5f</span><span class="token punctuation">,</span><span class="token number">0x3e</span><span class="token punctuation">,</span><span class="token number">0xd7</span><span class="token punctuation">,</span><span class="token number">0xcb</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x48</span><span class="token punctuation">}</span></pre><tr><td data-num=46><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=47><td><pre></pre><tr><td data-num=48><td><pre><span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> FK<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0xa3b1bac6</span><span class="token punctuation">,</span><span class="token number">0x56aa3350</span><span class="token punctuation">,</span><span class="token number">0x677d9197</span><span class="token punctuation">,</span><span class="token number">0xb27022dc</span><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=49><td><pre></pre><tr><td data-num=50><td><pre><span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> CK<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=51><td><pre>	<span class="token number">0x00070e15</span><span class="token punctuation">,</span><span class="token number">0x1c232a31</span><span class="token punctuation">,</span><span class="token number">0x383f464d</span><span class="token punctuation">,</span><span class="token number">0x545b6269</span><span class="token punctuation">,</span></pre><tr><td data-num=52><td><pre>	<span class="token number">0x70777e85</span><span class="token punctuation">,</span><span class="token number">0x8c939aa1</span><span class="token punctuation">,</span><span class="token number">0xa8afb6bd</span><span class="token punctuation">,</span><span class="token number">0xc4cbd2d9</span><span class="token punctuation">,</span></pre><tr><td data-num=53><td><pre>	<span class="token number">0xe0e7eef5</span><span class="token punctuation">,</span><span class="token number">0xfc030a11</span><span class="token punctuation">,</span><span class="token number">0x181f262d</span><span class="token punctuation">,</span><span class="token number">0x343b4249</span><span class="token punctuation">,</span></pre><tr><td data-num=54><td><pre>	<span class="token number">0x50575e65</span><span class="token punctuation">,</span><span class="token number">0x6c737a81</span><span class="token punctuation">,</span><span class="token number">0x888f969d</span><span class="token punctuation">,</span><span class="token number">0xa4abb2b9</span><span class="token punctuation">,</span></pre><tr><td data-num=55><td><pre>	<span class="token number">0xc0c7ced5</span><span class="token punctuation">,</span><span class="token number">0xdce3eaf1</span><span class="token punctuation">,</span><span class="token number">0xf8ff060d</span><span class="token punctuation">,</span><span class="token number">0x141b2229</span><span class="token punctuation">,</span></pre><tr><td data-num=56><td><pre>	<span class="token number">0x30373e45</span><span class="token punctuation">,</span><span class="token number">0x4c535a61</span><span class="token punctuation">,</span><span class="token number">0x686f767d</span><span class="token punctuation">,</span><span class="token number">0x848b9299</span><span class="token punctuation">,</span></pre><tr><td data-num=57><td><pre>	<span class="token number">0xa0a7aeb5</span><span class="token punctuation">,</span><span class="token number">0xbcc3cad1</span><span class="token punctuation">,</span><span class="token number">0xd8dfe6ed</span><span class="token punctuation">,</span><span class="token number">0xf4fb0209</span><span class="token punctuation">,</span></pre><tr><td data-num=58><td><pre>	<span class="token number">0x10171e25</span><span class="token punctuation">,</span><span class="token number">0x2c333a41</span><span class="token punctuation">,</span><span class="token number">0x484f565d</span><span class="token punctuation">,</span><span class="token number">0x646b7279</span></pre><tr><td data-num=59><td><pre><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=60><td><pre></pre><tr><td data-num=61><td><pre><span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token function">sm4Sbox</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> inch<span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=62><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pTable <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>SboxTable<span class="token punctuation">;</span></pre><tr><td data-num=63><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> retVal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pTable<span class="token punctuation">[</span>inch<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=64><td><pre>	<span class="token keyword">return</span> retVal<span class="token punctuation">;</span></pre><tr><td data-num=65><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=66><td><pre></pre><tr><td data-num=67><td><pre><span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">sm4Lt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> ka<span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=68><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> bb <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=69><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=70><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=71><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=72><td><pre>	<span class="token function">PUT_ULONG_BE</span><span class="token punctuation">(</span>ka<span class="token punctuation">,</span>a<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></pre><tr><td data-num=73><td><pre>	b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sm4Sbox</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=74><td><pre>	b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sm4Sbox</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=75><td><pre>	b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sm4Sbox</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=76><td><pre>	b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sm4Sbox</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=77><td><pre>	<span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span>b<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></pre><tr><td data-num=78><td><pre>	c <span class="token operator">=</span>bb<span class="token operator">^</span><span class="token punctuation">(</span><span class="token function">ROTL</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token function">ROTL</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token function">ROTL</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token function">ROTL</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=79><td><pre>	<span class="token keyword">return</span> c<span class="token punctuation">;</span></pre><tr><td data-num=80><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=81><td><pre></pre><tr><td data-num=82><td><pre><span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">sm4F</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> x0<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> x1<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> x2<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> x3<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> rk<span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=83><td><pre>	<span class="token keyword">return</span> <span class="token punctuation">(</span>x0<span class="token operator">^</span><span class="token function">sm4Lt</span><span class="token punctuation">(</span>x1<span class="token operator">^</span>x2<span class="token operator">^</span>x3<span class="token operator">^</span>rk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=84><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=85><td><pre></pre><tr><td data-num=86><td><pre></pre><tr><td data-num=87><td><pre></pre><tr><td data-num=88><td><pre><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">sm4_one_round</span><span class="token punctuation">(</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> sk<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre><tr><td data-num=89><td><pre>                           <span class="token keyword">unsigned</span> <span class="token keyword">char</span> input<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre><tr><td data-num=90><td><pre>                           <span class="token keyword">unsigned</span> <span class="token keyword">char</span> output<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=91><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=92><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> ulbuf<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=93><td><pre></pre><tr><td data-num=94><td><pre>	<span class="token function">memset</span><span class="token punctuation">(</span>ulbuf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ulbuf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=95><td><pre>	<span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span> ulbuf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> input<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span></pre><tr><td data-num=96><td><pre>	<span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span> ulbuf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> input<span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">)</span></pre><tr><td data-num=97><td><pre>	<span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span> ulbuf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> input<span class="token punctuation">,</span> <span class="token number">8</span> <span class="token punctuation">)</span></pre><tr><td data-num=98><td><pre>	<span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span> ulbuf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> input<span class="token punctuation">,</span> <span class="token number">12</span> <span class="token punctuation">)</span></pre><tr><td data-num=99><td><pre>	<span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator"><</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=100><td><pre>		ulbuf<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sm4F</span><span class="token punctuation">(</span>ulbuf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> ulbuf<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ulbuf<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ulbuf<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sk<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=101><td><pre>		i<span class="token operator">++</span><span class="token punctuation">;</span></pre><tr><td data-num=102><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=103><td><pre>	<span class="token function">PUT_ULONG_BE</span><span class="token punctuation">(</span>ulbuf<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">,</span>output<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=104><td><pre>	<span class="token function">PUT_ULONG_BE</span><span class="token punctuation">(</span>ulbuf<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">,</span>output<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=105><td><pre>	<span class="token function">PUT_ULONG_BE</span><span class="token punctuation">(</span>ulbuf<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">,</span>output<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=106><td><pre>	<span class="token function">PUT_ULONG_BE</span><span class="token punctuation">(</span>ulbuf<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span>output<span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=107><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=108><td><pre></pre><tr><td data-num=109><td><pre><span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">sm4CalciRK</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> ka<span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=110><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> bb <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=111><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> rk <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=112><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=113><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=114><td><pre>	<span class="token function">PUT_ULONG_BE</span><span class="token punctuation">(</span>ka<span class="token punctuation">,</span>a<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></pre><tr><td data-num=115><td><pre>	b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sm4Sbox</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=116><td><pre>	b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sm4Sbox</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=117><td><pre>	b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sm4Sbox</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=118><td><pre>	b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sm4Sbox</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=119><td><pre>	<span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span>b<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></pre><tr><td data-num=120><td><pre>	rk <span class="token operator">=</span> bb<span class="token operator">^</span><span class="token punctuation">(</span><span class="token function">ROTL</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token function">ROTL</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=121><td><pre>	<span class="token keyword">return</span> rk<span class="token punctuation">;</span></pre><tr><td data-num=122><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=123><td><pre></pre><tr><td data-num=124><td><pre><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">sm4_setkey</span><span class="token punctuation">(</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> sk<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=125><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> MK<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=126><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> k<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=127><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=128><td><pre></pre><tr><td data-num=129><td><pre>	<span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span> MK<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=130><td><pre>	<span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span> MK<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=131><td><pre>	<span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span> MK<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token number">8</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=132><td><pre>	<span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span> MK<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token number">12</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=133><td><pre>	k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> MK<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">^</span>FK<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=134><td><pre>	k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> MK<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span>FK<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=135><td><pre>	k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> MK<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span>FK<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=136><td><pre>	k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> MK<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span>FK<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=137><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span> i<span class="token operator"><</span><span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=138><td><pre>		k<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> k<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token function">sm4CalciRK</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span>k<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span>k<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span>CK<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=139><td><pre>		sk<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> k<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=140><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=141><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=142><td><pre></pre><tr><td data-num=143><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=144><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=145><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> input<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=146><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> output<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=147><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> sk<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre><tr><td data-num=148><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> i<span class="token punctuation">;</span></pre><tr><td data-num=149><td><pre></pre><tr><td data-num=150><td><pre>	<span class="token function">sm4_setkey</span><span class="token punctuation">(</span>sk<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=151><td><pre></pre><tr><td data-num=152><td><pre>	<span class="token function">sm4_one_round</span><span class="token punctuation">(</span>sk<span class="token punctuation">,</span> input<span class="token punctuation">,</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=153><td><pre></pre><tr><td data-num=154><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator"><</span><span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre><tr><td data-num=155><td><pre>		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%02x "</span><span class="token punctuation">,</span> output<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=156><td><pre>	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=157><td><pre></pre><tr><td data-num=158><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre><tr><td data-num=159><td><pre><span class="token punctuation">}</span></pre></table></figure><h4 id=blowfish><a class=anchor href=#blowfish>#</a> Blowfish</h4><h4 id=twofish><a class=anchor href=#twofish>#</a> Twofish</h4><h4 id=serpent><a class=anchor href=#serpent>#</a> Serpent</h4><p>在线工具请：<br> <a href=http://serpent.online-domain-tools.com/ rel=noopener target=_blank>http://serpent.online-domain-tools.com/</a><h4 id=present><a class=anchor href=#present>#</a> PRESENT</h4><figure class="highlight python"><figcaption data-lang=python></figcaption><table><tr><td data-num=1><td><pre>Sbox <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span></pre><tr><td data-num=2><td><pre></pre><tr><td data-num=3><td><pre>Sbox_inv <span class="token operator">=</span> <span class="token punctuation">[</span>Sbox<span class="token punctuation">.</span>index<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=4><td><pre></pre><tr><td data-num=5><td><pre>PBox <span class="token operator">=</span> <span class="token punctuation">[</span></pre><tr><td data-num=6><td><pre>    <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span></pre><tr><td data-num=7><td><pre>    <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span></pre><tr><td data-num=8><td><pre>    <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span></pre><tr><td data-num=9><td><pre>    <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">63</span></pre><tr><td data-num=10><td><pre><span class="token punctuation">]</span></pre><tr><td data-num=11><td><pre></pre><tr><td data-num=12><td><pre>PBox_inv <span class="token operator">=</span> <span class="token punctuation">[</span>PBox<span class="token punctuation">.</span>index<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=13><td><pre></pre><tr><td data-num=14><td><pre></pre><tr><td data-num=15><td><pre><span class="token keyword">def</span> <span class="token function">addRoundKey</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> roundkey<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=16><td><pre>    <span class="token keyword">return</span> state <span class="token operator">^</span> roundkey</pre><tr><td data-num=17><td><pre></pre><tr><td data-num=18><td><pre></pre><tr><td data-num=19><td><pre><span class="token keyword">def</span> <span class="token function">sBoxLayer</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=20><td><pre>    output <span class="token operator">=</span> <span class="token number">0</span></pre><tr><td data-num=21><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=22><td><pre>        output <span class="token operator">+=</span> Sbox<span class="token punctuation">[</span><span class="token punctuation">(</span>state <span class="token operator">>></span> <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator"><<</span> <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span></pre><tr><td data-num=23><td><pre>    <span class="token keyword">return</span> output</pre><tr><td data-num=24><td><pre></pre><tr><td data-num=25><td><pre></pre><tr><td data-num=26><td><pre><span class="token keyword">def</span> <span class="token function">pLayer</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=27><td><pre>    output <span class="token operator">=</span> <span class="token number">0</span></pre><tr><td data-num=28><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=29><td><pre>        output <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>state <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator"><<</span> PBox<span class="token punctuation">[</span>i<span class="token punctuation">]</span></pre><tr><td data-num=30><td><pre>    <span class="token keyword">return</span> output</pre><tr><td data-num=31><td><pre></pre><tr><td data-num=32><td><pre></pre><tr><td data-num=33><td><pre><span class="token keyword">def</span> <span class="token function">string2number</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=34><td><pre>    <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">*</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=35><td><pre></pre><tr><td data-num=36><td><pre></pre><tr><td data-num=37><td><pre><span class="token keyword">def</span> <span class="token function">generateRoundkeys80</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> rounds<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=38><td><pre>    roundkeys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre><tr><td data-num=39><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> rounds <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=40><td><pre>        roundkeys<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span></pre><tr><td data-num=41><td><pre></pre><tr><td data-num=42><td><pre>        key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>key <span class="token operator">&</span> <span class="token number">524287</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">61</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>key <span class="token operator">>></span> <span class="token number">19</span><span class="token punctuation">)</span></pre><tr><td data-num=43><td><pre></pre><tr><td data-num=44><td><pre>        key <span class="token operator">=</span> <span class="token punctuation">(</span>Sbox<span class="token punctuation">[</span>key <span class="token operator">>></span> <span class="token number">76</span><span class="token punctuation">]</span> <span class="token operator"><<</span> <span class="token number">76</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>key <span class="token operator">&</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">**</span> <span class="token number">76</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=45><td><pre></pre><tr><td data-num=46><td><pre>        key <span class="token operator">^</span><span class="token operator">=</span> i <span class="token operator"><<</span> <span class="token number">15</span></pre><tr><td data-num=47><td><pre>    <span class="token keyword">return</span> roundkeys</pre><tr><td data-num=48><td><pre></pre><tr><td data-num=49><td><pre></pre><tr><td data-num=50><td><pre><span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>blocks<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=51><td><pre>    rounds <span class="token operator">=</span> <span class="token number">32</span></pre><tr><td data-num=52><td><pre>    roundkeys <span class="token operator">=</span> generateRoundkeys80<span class="token punctuation">(</span><span class="token number">85354531916197809168417</span><span class="token punctuation">,</span> rounds<span class="token punctuation">)</span></pre><tr><td data-num=53><td><pre>    out <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre><tr><td data-num=54><td><pre></pre><tr><td data-num=55><td><pre>    <span class="token keyword">for</span> block <span class="token keyword">in</span> blocks<span class="token punctuation">:</span></pre><tr><td data-num=56><td><pre>        state <span class="token operator">=</span> string2number<span class="token punctuation">(</span>block<span class="token punctuation">)</span></pre><tr><td data-num=57><td><pre></pre><tr><td data-num=58><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>rounds <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=59><td><pre>            state <span class="token operator">=</span> addRoundKey<span class="token punctuation">(</span>state<span class="token punctuation">,</span> roundkeys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=60><td><pre>            state <span class="token operator">=</span> sBoxLayer<span class="token punctuation">(</span>state<span class="token punctuation">)</span></pre><tr><td data-num=61><td><pre>            state <span class="token operator">=</span> pLayer<span class="token punctuation">(</span>state<span class="token punctuation">)</span></pre><tr><td data-num=62><td><pre></pre><tr><td data-num=63><td><pre>        cipher <span class="token operator">=</span> addRoundKey<span class="token punctuation">(</span>state<span class="token punctuation">,</span> roundkeys<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=64><td><pre>        out<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span></pre><tr><td data-num=65><td><pre></pre><tr><td data-num=66><td><pre>    <span class="token keyword">return</span> out</pre><tr><td data-num=67><td><pre></pre><tr><td data-num=68><td><pre></pre><tr><td data-num=69><td><pre>inp <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'pls input ur flag:'</span><span class="token punctuation">)</span></pre><tr><td data-num=70><td><pre></pre><tr><td data-num=71><td><pre><span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>inp<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span></pre><tr><td data-num=72><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'wrong!'</span><span class="token punctuation">)</span></pre><tr><td data-num=73><td><pre>    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></pre><tr><td data-num=74><td><pre></pre><tr><td data-num=75><td><pre>blocks <span class="token operator">=</span> <span class="token punctuation">[</span>inp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> inp<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> inp<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span> inp<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">]</span></pre><tr><td data-num=76><td><pre></pre><tr><td data-num=77><td><pre>out_blocks <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>blocks<span class="token punctuation">)</span></pre><tr><td data-num=78><td><pre></pre><tr><td data-num=79><td><pre>解密脚本直接逆着写就行，这里的输入是<span class="token number">32</span>位的，然后分块。</pre><tr><td data-num=80><td><pre>```python</pre><tr><td data-num=81><td><pre>Sbox <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span></pre><tr><td data-num=82><td><pre></pre><tr><td data-num=83><td><pre>Sbox_inv <span class="token operator">=</span> <span class="token punctuation">[</span>Sbox<span class="token punctuation">.</span>index<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=84><td><pre></pre><tr><td data-num=85><td><pre>PBox <span class="token operator">=</span> <span class="token punctuation">[</span></pre><tr><td data-num=86><td><pre>    <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span></pre><tr><td data-num=87><td><pre>    <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span></pre><tr><td data-num=88><td><pre>    <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span></pre><tr><td data-num=89><td><pre>    <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">63</span></pre><tr><td data-num=90><td><pre><span class="token punctuation">]</span></pre><tr><td data-num=91><td><pre></pre><tr><td data-num=92><td><pre>PBox_inv <span class="token operator">=</span> <span class="token punctuation">[</span>PBox<span class="token punctuation">.</span>index<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=93><td><pre></pre><tr><td data-num=94><td><pre></pre><tr><td data-num=95><td><pre><span class="token keyword">def</span> <span class="token function">addRoundKey</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> roundkey<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=96><td><pre>    <span class="token keyword">return</span> state <span class="token operator">^</span> roundkey</pre><tr><td data-num=97><td><pre></pre><tr><td data-num=98><td><pre></pre><tr><td data-num=99><td><pre><span class="token keyword">def</span> <span class="token function">generateRoundkeys80</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> rounds<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=100><td><pre>    roundkeys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre><tr><td data-num=101><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> rounds <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=102><td><pre>        roundkeys<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span></pre><tr><td data-num=103><td><pre></pre><tr><td data-num=104><td><pre>        key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>key <span class="token operator">&</span> <span class="token number">524287</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">61</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>key <span class="token operator">>></span> <span class="token number">19</span><span class="token punctuation">)</span></pre><tr><td data-num=105><td><pre></pre><tr><td data-num=106><td><pre>        key <span class="token operator">=</span> <span class="token punctuation">(</span>Sbox<span class="token punctuation">[</span>key <span class="token operator">>></span> <span class="token number">76</span><span class="token punctuation">]</span> <span class="token operator"><<</span> <span class="token number">76</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>key <span class="token operator">&</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">**</span> <span class="token number">76</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=107><td><pre></pre><tr><td data-num=108><td><pre>        key <span class="token operator">^</span><span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator"><<</span> <span class="token number">15</span><span class="token punctuation">)</span></pre><tr><td data-num=109><td><pre>    <span class="token keyword">return</span> roundkeys</pre><tr><td data-num=110><td><pre></pre><tr><td data-num=111><td><pre></pre><tr><td data-num=112><td><pre><span class="token keyword">def</span> <span class="token function">inv_sBoxLayer</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=113><td><pre>    output <span class="token operator">=</span> <span class="token number">0</span></pre><tr><td data-num=114><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=115><td><pre>        output <span class="token operator">+=</span> Sbox_inv<span class="token punctuation">[</span><span class="token punctuation">(</span>state <span class="token operator">>></span> <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator"><<</span> <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span></pre><tr><td data-num=116><td><pre>    <span class="token keyword">return</span> output</pre><tr><td data-num=117><td><pre></pre><tr><td data-num=118><td><pre></pre><tr><td data-num=119><td><pre><span class="token keyword">def</span> <span class="token function">inv_pLayer</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=120><td><pre>    output <span class="token operator">=</span> <span class="token number">0</span></pre><tr><td data-num=121><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=122><td><pre>        output <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>state <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator"><<</span> PBox_inv<span class="token punctuation">[</span>i<span class="token punctuation">]</span></pre><tr><td data-num=123><td><pre>    <span class="token keyword">return</span> output</pre><tr><td data-num=124><td><pre></pre><tr><td data-num=125><td><pre></pre><tr><td data-num=126><td><pre><span class="token keyword">def</span> <span class="token function">number2string</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=127><td><pre>    chars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre><tr><td data-num=128><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=129><td><pre>        chars<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">>></span> <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=130><td><pre>    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>chars<span class="token punctuation">)</span></pre><tr><td data-num=131><td><pre></pre><tr><td data-num=132><td><pre></pre><tr><td data-num=133><td><pre><span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>ciphers<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=134><td><pre>    rounds <span class="token operator">=</span> <span class="token number">32</span></pre><tr><td data-num=135><td><pre>    roundkeys <span class="token operator">=</span> generateRoundkeys80<span class="token punctuation">(</span><span class="token number">85354531916197809168417</span><span class="token punctuation">,</span> rounds<span class="token punctuation">)</span></pre><tr><td data-num=136><td><pre>    out <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre><tr><td data-num=137><td><pre></pre><tr><td data-num=138><td><pre>    <span class="token keyword">for</span> cipher <span class="token keyword">in</span> ciphers<span class="token punctuation">:</span></pre><tr><td data-num=139><td><pre>        state <span class="token operator">=</span> cipher</pre><tr><td data-num=140><td><pre></pre><tr><td data-num=141><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>rounds <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=142><td><pre>            state <span class="token operator">=</span> addRoundKey<span class="token punctuation">(</span>state<span class="token punctuation">,</span> roundkeys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=143><td><pre>            state <span class="token operator">=</span> inv_pLayer<span class="token punctuation">(</span>state<span class="token punctuation">)</span></pre><tr><td data-num=144><td><pre>            state <span class="token operator">=</span> inv_sBoxLayer<span class="token punctuation">(</span>state<span class="token punctuation">)</span></pre><tr><td data-num=145><td><pre></pre><tr><td data-num=146><td><pre>        block <span class="token operator">=</span> addRoundKey<span class="token punctuation">(</span>state<span class="token punctuation">,</span> roundkeys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=147><td><pre>        out<span class="token punctuation">.</span>append<span class="token punctuation">(</span>number2string<span class="token punctuation">(</span>block<span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=148><td><pre></pre><tr><td data-num=149><td><pre>    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>out<span class="token punctuation">)</span></pre><tr><td data-num=150><td><pre></pre><tr><td data-num=151><td><pre></pre><tr><td data-num=152><td><pre>cmps <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">120617461261311902</span><span class="token punctuation">,</span> <span class="token number">16357837616839286114</span><span class="token punctuation">,</span> <span class="token number">312508749794633008</span><span class="token punctuation">,</span> <span class="token number">1843701600916795272</span><span class="token punctuation">]</span></pre><tr><td data-num=153><td><pre></pre><tr><td data-num=154><td><pre>decrypted_flag <span class="token operator">=</span> decrypt<span class="token punctuation">(</span>cmps<span class="token punctuation">)</span></pre><tr><td data-num=155><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>decrypted_flag<span class="token punctuation">)</span></pre><tr><td data-num=156><td><pre></pre><tr><td data-num=157><td><pre><span class="token comment">## 非对称</span></pre><tr><td data-num=158><td><pre></pre><tr><td data-num=159><td><pre><span class="token comment">#### RSA</span></pre><tr><td data-num=160><td><pre></pre><tr><td data-num=161><td><pre>```python</pre><tr><td data-num=162><td><pre><span class="token keyword">import</span> gmpy2</pre><tr><td data-num=163><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes</pre><tr><td data-num=164><td><pre>e <span class="token operator">=</span> <span class="token number">65537</span></pre><tr><td data-num=165><td><pre>n <span class="token operator">=</span> <span class="token number">36618139579386063246087882054063631367923586826293230665209915187491823328978276724908066032487515386697740611819366867179565337532194305783987450587518624526250530134446397</span></pre><tr><td data-num=166><td><pre>c <span class="token operator">=</span> <span class="token number">3053043969587277731075013823380664207370991627277672374256662715889363487017560381573682876563907215099359894935326265406537547932246927604121814198201993671878573628633125</span></pre><tr><td data-num=167><td><pre>p<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">521</span><span class="token punctuation">,</span><span class="token number">521</span><span class="token punctuation">,</span><span class="token number">521</span><span class="token punctuation">,</span><span class="token number">541</span><span class="token punctuation">,</span><span class="token number">547</span><span class="token punctuation">,</span><span class="token number">557</span><span class="token punctuation">,</span><span class="token number">557</span><span class="token punctuation">,</span><span class="token number">577</span><span class="token punctuation">,</span><span class="token number">587</span><span class="token punctuation">,</span><span class="token number">593</span><span class="token punctuation">,</span><span class="token number">601</span><span class="token punctuation">,</span><span class="token number">607</span><span class="token punctuation">,</span><span class="token number">631</span><span class="token punctuation">,</span><span class="token number">631</span><span class="token punctuation">,</span><span class="token number">631</span><span class="token punctuation">,</span><span class="token number">631</span><span class="token punctuation">,</span><span class="token number">641</span><span class="token punctuation">,</span><span class="token number">643</span><span class="token punctuation">,</span><span class="token number">683</span><span class="token punctuation">,</span><span class="token number">701</span><span class="token punctuation">,</span><span class="token number">701</span><span class="token punctuation">,</span><span class="token number">719</span><span class="token punctuation">,</span><span class="token number">727</span><span class="token punctuation">,</span><span class="token number">727</span><span class="token punctuation">,</span><span class="token number">727</span><span class="token punctuation">,</span><span class="token number">733</span><span class="token punctuation">,</span><span class="token number">739</span><span class="token punctuation">,</span><span class="token number">739</span><span class="token punctuation">,</span><span class="token number">743</span><span class="token punctuation">,</span><span class="token number">757</span><span class="token punctuation">,</span><span class="token number">761</span><span class="token punctuation">,</span><span class="token number">769</span><span class="token punctuation">,</span><span class="token number">773</span><span class="token punctuation">,</span><span class="token number">787</span><span class="token punctuation">,</span><span class="token number">787</span><span class="token punctuation">,</span><span class="token number">809</span><span class="token punctuation">,</span><span class="token number">821</span><span class="token punctuation">,</span><span class="token number">821</span><span class="token punctuation">,</span><span class="token number">821</span><span class="token punctuation">,</span><span class="token number">863</span><span class="token punctuation">,</span><span class="token number">877</span><span class="token punctuation">,</span><span class="token number">877</span><span class="token punctuation">,</span><span class="token number">881</span><span class="token punctuation">,</span><span class="token number">907</span><span class="token punctuation">,</span><span class="token number">907</span><span class="token punctuation">,</span><span class="token number">907</span><span class="token punctuation">,</span><span class="token number">907</span><span class="token punctuation">,</span><span class="token number">907</span><span class="token punctuation">,</span><span class="token number">919</span><span class="token punctuation">,</span><span class="token number">919</span><span class="token punctuation">,</span><span class="token number">929</span><span class="token punctuation">,</span><span class="token number">937</span><span class="token punctuation">,</span><span class="token number">953</span><span class="token punctuation">,</span><span class="token number">953</span><span class="token punctuation">,</span><span class="token number">967</span><span class="token punctuation">,</span><span class="token number">967</span><span class="token punctuation">,</span><span class="token number">991</span><span class="token punctuation">,</span><span class="token number">997</span><span class="token punctuation">,</span><span class="token number">997</span><span class="token punctuation">,</span><span class="token number">1019</span><span class="token punctuation">]</span></pre><tr><td data-num=168><td><pre></pre><tr><td data-num=169><td><pre>p<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">521</span><span class="token punctuation">)</span></pre><tr><td data-num=170><td><pre>phi<span class="token operator">=</span><span class="token number">1</span></pre><tr><td data-num=171><td><pre>a<span class="token operator">=</span><span class="token number">0</span></pre><tr><td data-num=172><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> p<span class="token punctuation">:</span></pre><tr><td data-num=173><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token operator">==</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=174><td><pre>        phi<span class="token operator">*=</span>i</pre><tr><td data-num=175><td><pre>    phi<span class="token operator">*=</span>i<span class="token operator">-</span><span class="token number">1</span></pre><tr><td data-num=176><td><pre>    a<span class="token operator">=</span>i</pre><tr><td data-num=177><td><pre></pre><tr><td data-num=178><td><pre><span class="token comment"># phi = (p - 1) * (q - 1)</span></pre><tr><td data-num=179><td><pre><span class="token comment"># n = p * q</span></pre><tr><td data-num=180><td><pre>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span></pre><tr><td data-num=181><td><pre>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre><tr><td data-num=182><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></table></figure><h2 id=校验><a class=anchor href=#校验>#</a> 校验</h2><h4 id=sha系列><a class=anchor href=#sha系列>#</a> sha 系列</h4><p>cyberchef 本地请<figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&LTstdio.h></span></span></pre><tr><td data-num=2><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&LTstdlib.h></span></span></pre><tr><td data-num=3><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&LTstring.h></span></span></pre><tr><td data-num=4><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&LTmath.h></span></span></pre><tr><td data-num=5><td><pre></pre><tr><td data-num=6><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">GROUP_SIZE</span> <span class="token expression"><span class="token number">64</span> </span></span></pre><tr><td data-num=7><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_SIZE</span> <span class="token expression"><span class="token number">1024</span></span></span></pre><tr><td data-num=8><td><pre></pre><tr><td data-num=9><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token keyword">const</span> K<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token punctuation">{</span></pre><tr><td data-num=10><td><pre>        <span class="token number">0x428a2f98</span><span class="token punctuation">,</span> <span class="token number">0x71374491</span><span class="token punctuation">,</span> <span class="token number">0xb5c0fbcf</span><span class="token punctuation">,</span> <span class="token number">0xe9b5dba5</span><span class="token punctuation">,</span> <span class="token number">0x3956c25b</span><span class="token punctuation">,</span> <span class="token number">0x59f111f1</span><span class="token punctuation">,</span> <span class="token number">0x923f82a4</span><span class="token punctuation">,</span> <span class="token number">0xab1c5ed5</span><span class="token punctuation">,</span>  </pre><tr><td data-num=11><td><pre>        <span class="token number">0xd807aa98</span><span class="token punctuation">,</span> <span class="token number">0x12835b01</span><span class="token punctuation">,</span> <span class="token number">0x243185be</span><span class="token punctuation">,</span> <span class="token number">0x550c7dc3</span><span class="token punctuation">,</span> <span class="token number">0x72be5d74</span><span class="token punctuation">,</span> <span class="token number">0x80deb1fe</span><span class="token punctuation">,</span> <span class="token number">0x9bdc06a7</span><span class="token punctuation">,</span> <span class="token number">0xc19bf174</span><span class="token punctuation">,</span>  </pre><tr><td data-num=12><td><pre>        <span class="token number">0xe49b69c1</span><span class="token punctuation">,</span> <span class="token number">0xefbe4786</span><span class="token punctuation">,</span> <span class="token number">0x0fc19dc6</span><span class="token punctuation">,</span> <span class="token number">0x240ca1cc</span><span class="token punctuation">,</span> <span class="token number">0x2de92c6f</span><span class="token punctuation">,</span> <span class="token number">0x4a7484aa</span><span class="token punctuation">,</span> <span class="token number">0x5cb0a9dc</span><span class="token punctuation">,</span> <span class="token number">0x76f988da</span><span class="token punctuation">,</span>  </pre><tr><td data-num=13><td><pre>        <span class="token number">0x983e5152</span><span class="token punctuation">,</span> <span class="token number">0xa831c66d</span><span class="token punctuation">,</span> <span class="token number">0xb00327c8</span><span class="token punctuation">,</span> <span class="token number">0xbf597fc7</span><span class="token punctuation">,</span> <span class="token number">0xc6e00bf3</span><span class="token punctuation">,</span> <span class="token number">0xd5a79147</span><span class="token punctuation">,</span> <span class="token number">0x06ca6351</span><span class="token punctuation">,</span> <span class="token number">0x14292967</span><span class="token punctuation">,</span>  </pre><tr><td data-num=14><td><pre>        <span class="token number">0x27b70a85</span><span class="token punctuation">,</span> <span class="token number">0x2e1b2138</span><span class="token punctuation">,</span> <span class="token number">0x4d2c6dfc</span><span class="token punctuation">,</span> <span class="token number">0x53380d13</span><span class="token punctuation">,</span> <span class="token number">0x650a7354</span><span class="token punctuation">,</span> <span class="token number">0x766a0abb</span><span class="token punctuation">,</span> <span class="token number">0x81c2c92e</span><span class="token punctuation">,</span> <span class="token number">0x92722c85</span><span class="token punctuation">,</span>  </pre><tr><td data-num=15><td><pre>        <span class="token number">0xa2bfe8a1</span><span class="token punctuation">,</span> <span class="token number">0xa81a664b</span><span class="token punctuation">,</span> <span class="token number">0xc24b8b70</span><span class="token punctuation">,</span> <span class="token number">0xc76c51a3</span><span class="token punctuation">,</span> <span class="token number">0xd192e819</span><span class="token punctuation">,</span> <span class="token number">0xd6990624</span><span class="token punctuation">,</span> <span class="token number">0xf40e3585</span><span class="token punctuation">,</span> <span class="token number">0x106aa070</span><span class="token punctuation">,</span>  </pre><tr><td data-num=16><td><pre>        <span class="token number">0x19a4c116</span><span class="token punctuation">,</span> <span class="token number">0x1e376c08</span><span class="token punctuation">,</span> <span class="token number">0x2748774c</span><span class="token punctuation">,</span> <span class="token number">0x34b0bcb5</span><span class="token punctuation">,</span> <span class="token number">0x391c0cb3</span><span class="token punctuation">,</span> <span class="token number">0x4ed8aa4a</span><span class="token punctuation">,</span> <span class="token number">0x5b9cca4f</span><span class="token punctuation">,</span> <span class="token number">0x682e6ff3</span><span class="token punctuation">,</span>  </pre><tr><td data-num=17><td><pre>        <span class="token number">0x748f82ee</span><span class="token punctuation">,</span> <span class="token number">0x78a5636f</span><span class="token punctuation">,</span> <span class="token number">0x84c87814</span><span class="token punctuation">,</span> <span class="token number">0x8cc70208</span><span class="token punctuation">,</span> <span class="token number">0x90befffa</span><span class="token punctuation">,</span> <span class="token number">0xa4506ceb</span><span class="token punctuation">,</span> <span class="token number">0xbef9a3f7</span><span class="token punctuation">,</span> <span class="token number">0xc67178f2</span>  </pre><tr><td data-num=18><td><pre>   <span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=19><td><pre></pre><tr><td data-num=20><td><pre></pre><tr><td data-num=21><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">ROR</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=22><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">SHR</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=23><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">Ch</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> E<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> F<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> G<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=24><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">Maj</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> A<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> B<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> C<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=25><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">Lsigma_0</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> A<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=26><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">Lsigma_1</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> E<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=27><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">Ssigma_0</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=28><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">Ssigma_1</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=29><td><pre></pre><tr><td data-num=30><td><pre><span class="token keyword">void</span> <span class="token function">sha_init</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>A<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>B<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>C<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>D<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>E<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>F<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>G<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=31><td><pre>size_t <span class="token function">sha_update</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>out<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>input<span class="token punctuation">,</span> size_t inLen<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=32><td><pre><span class="token keyword">void</span> <span class="token function">sha_transform</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>out<span class="token punctuation">,</span>  <span class="token keyword">char</span> <span class="token operator">*</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=33><td><pre><span class="token keyword">void</span> <span class="token function">data_round</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>A<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>B<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>C<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>D<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>E<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>F<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>G<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>H<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token keyword">const</span> <span class="token operator">*</span>M<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=34><td><pre><span class="token keyword">void</span> <span class="token function">sha_calc</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>out<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>input<span class="token punctuation">,</span> size_t inLen<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></table></figure><h4 id=crc32><a class=anchor href=#crc32>#</a> CRC32</h4><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1><td><pre><span class="token keyword">uint32_t</span> <span class="token function">crc32</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span><span class="token operator">*</span> buf<span class="token punctuation">,</span> size_t size<span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=2><td><pre>	<span class="token keyword">const</span> <span class="token keyword">uint8_t</span><span class="token operator">*</span> p <span class="token operator">=</span> buf<span class="token punctuation">;</span></pre><tr><td data-num=3><td><pre>	<span class="token keyword">uint32_t</span> crc <span class="token operator">=</span> <span class="token operator">~</span><span class="token number">0U</span><span class="token punctuation">;</span></pre><tr><td data-num=4><td><pre>	<span class="token keyword">while</span> <span class="token punctuation">(</span>size<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=5><td><pre>		crc <span class="token operator">=</span> crc32_tab<span class="token punctuation">[</span><span class="token punctuation">(</span>crc <span class="token operator">^</span> <span class="token operator">*</span>p<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span>crc <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=6><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=7><td><pre>	<span class="token keyword">return</span> <span class="token operator">~</span>crc<span class="token punctuation">;</span></pre><tr><td data-num=8><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=9><td><pre>uint <span class="token function">crc32</span><span class="token punctuation">(</span>byte <span class="token operator">*</span>data<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">)</span></pre><tr><td data-num=10><td><pre><span class="token punctuation">{</span></pre><tr><td data-num=11><td><pre>	uint r <span class="token operator">=</span> <span class="token operator">~</span><span class="token number">0</span><span class="token punctuation">;</span> byte <span class="token operator">*</span>end <span class="token operator">=</span> data <span class="token operator">+</span> size<span class="token punctuation">;</span></pre><tr><td data-num=12><td><pre>	<span class="token keyword">while</span><span class="token punctuation">(</span>data <span class="token operator"><</span> end<span class="token punctuation">)</span></pre><tr><td data-num=13><td><pre>	<span class="token punctuation">{</span></pre><tr><td data-num=14><td><pre>		r <span class="token operator">^=</span> <span class="token operator">*</span>data<span class="token operator">++</span><span class="token punctuation">;</span></pre><tr><td data-num=15><td><pre>		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre><tr><td data-num=16><td><pre>		<span class="token punctuation">{</span></pre><tr><td data-num=17><td><pre>			uint t <span class="token operator">=</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r<span class="token operator">&</span><span class="token number">1</span><span class="token punctuation">)</span> — <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> r <span class="token operator">=</span> <span class="token punctuation">(</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token number">0xEDB88320</span> <span class="token operator">&</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=18><td><pre>		<span class="token punctuation">}</span></pre><tr><td data-num=19><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=20><td><pre>	<span class="token keyword">return</span> <span class="token operator">~</span>r<span class="token punctuation">;</span></pre><tr><td data-num=21><td><pre><span class="token punctuation">}</span></pre></table></figure><h4 id=md5><a class=anchor href=#md5>#</a> md5</h4><p>cyberchef 本地请<figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"md5.h"</span></span></pre><tr><td data-num=2><td><pre></pre><tr><td data-num=3><td><pre></pre><tr><td data-num=4><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">ROTATE_LEFT</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=5><td><pre>	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">x</span> <span class="token generic class-name"><span class="token operator"><<</span> n<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>x <span class="token operator">>></span></span></span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=6><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=7><td><pre></pre><tr><td data-num=8><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">F</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> X<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> Y<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> Z<span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=9><td><pre>	<span class="token keyword">return</span> <span class="token punctuation">(</span>X <span class="token operator">&</span> Y<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>X<span class="token punctuation">)</span> <span class="token operator">&</span> Z<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=10><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=11><td><pre></pre><tr><td data-num=12><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">G</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> X<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> Y<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> Z<span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=13><td><pre>	<span class="token keyword">return</span> <span class="token punctuation">(</span>X <span class="token operator">&</span> Z<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>Y <span class="token operator">&</span> <span class="token punctuation">(</span><span class="token operator">~</span>Z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=14><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=15><td><pre></pre><tr><td data-num=16><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">H</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> X<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> Y<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> Z<span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=17><td><pre>	<span class="token keyword">return</span> <span class="token punctuation">(</span>X <span class="token operator">^</span> Y <span class="token operator">^</span> Z<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=18><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=19><td><pre></pre><tr><td data-num=20><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">I</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> X<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> Y<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> Z<span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=21><td><pre>	<span class="token keyword">return</span> <span class="token punctuation">(</span>Y <span class="token operator">^</span> <span class="token punctuation">(</span>X <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token operator">~</span>Z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=22><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=23><td><pre></pre><tr><td data-num=24><td><pre><span class="token keyword">void</span> <span class="token function">FF</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>a<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> c<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> d<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> m<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token keyword">const</span> t<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> s<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=25><td><pre>	<span class="token operator">*</span>a <span class="token operator">+=</span> <span class="token function">F</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">)</span> <span class="token operator">+</span> m <span class="token operator">+</span> t<span class="token punctuation">;</span></pre><tr><td data-num=26><td><pre>	<span class="token operator">*</span>a <span class="token operator">=</span> <span class="token function">ROTATE_LEFT</span><span class="token punctuation">(</span><span class="token operator">*</span>a<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=27><td><pre>	<span class="token operator">*</span>a <span class="token operator">+=</span> b<span class="token punctuation">;</span></pre><tr><td data-num=28><td><pre>	</pre><tr><td data-num=29><td><pre>	<span class="token keyword">return</span><span class="token punctuation">;</span></pre><tr><td data-num=30><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=31><td><pre></pre><tr><td data-num=32><td><pre><span class="token keyword">void</span> <span class="token function">GG</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>a<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> c<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> d<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> m<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token keyword">const</span> t<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> s<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=33><td><pre>	<span class="token operator">*</span>a <span class="token operator">+=</span> <span class="token function">G</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">)</span> <span class="token operator">+</span> m <span class="token operator">+</span> t<span class="token punctuation">;</span></pre><tr><td data-num=34><td><pre>	<span class="token operator">*</span>a <span class="token operator">=</span> <span class="token function">ROTATE_LEFT</span><span class="token punctuation">(</span><span class="token operator">*</span>a<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=35><td><pre>	<span class="token operator">*</span>a <span class="token operator">+=</span> b<span class="token punctuation">;</span></pre><tr><td data-num=36><td><pre>	</pre><tr><td data-num=37><td><pre>	<span class="token keyword">return</span><span class="token punctuation">;</span></pre><tr><td data-num=38><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=39><td><pre></pre><tr><td data-num=40><td><pre><span class="token keyword">void</span> <span class="token function">HH</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>a<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> c<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> d<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> m<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token keyword">const</span> t<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> s<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=41><td><pre>	<span class="token operator">*</span>a <span class="token operator">+=</span> <span class="token function">H</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">)</span> <span class="token operator">+</span> m <span class="token operator">+</span> t<span class="token punctuation">;</span></pre><tr><td data-num=42><td><pre>	<span class="token operator">*</span>a <span class="token operator">=</span> <span class="token function">ROTATE_LEFT</span><span class="token punctuation">(</span><span class="token operator">*</span>a<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=43><td><pre>	<span class="token operator">*</span>a <span class="token operator">+=</span> b<span class="token punctuation">;</span></pre><tr><td data-num=44><td><pre>	</pre><tr><td data-num=45><td><pre>	<span class="token keyword">return</span><span class="token punctuation">;</span></pre><tr><td data-num=46><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=47><td><pre></pre><tr><td data-num=48><td><pre><span class="token keyword">void</span> <span class="token function">II</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>a<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> c<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> d<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> m<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token keyword">const</span> t<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> s<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=49><td><pre>	<span class="token operator">*</span>a <span class="token operator">+=</span> <span class="token function">I</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">)</span> <span class="token operator">+</span> m <span class="token operator">+</span> t<span class="token punctuation">;</span></pre><tr><td data-num=50><td><pre>	<span class="token operator">*</span>a <span class="token operator">=</span> <span class="token function">ROTATE_LEFT</span><span class="token punctuation">(</span><span class="token operator">*</span>a<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=51><td><pre>	<span class="token operator">*</span>a <span class="token operator">+=</span> b<span class="token punctuation">;</span></pre><tr><td data-num=52><td><pre>	</pre><tr><td data-num=53><td><pre>	<span class="token keyword">return</span><span class="token punctuation">;</span></pre><tr><td data-num=54><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=55><td><pre></pre><tr><td data-num=56><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">shift</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=57><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> t1<span class="token punctuation">,</span>t2<span class="token punctuation">,</span>t3<span class="token punctuation">,</span>t4<span class="token punctuation">;</span></pre><tr><td data-num=58><td><pre>	t1 <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">24</span><span class="token punctuation">;</span></pre><tr><td data-num=59><td><pre>	t2 <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">&</span> <span class="token number">0xFF00</span><span class="token punctuation">)</span> <span class="token operator"><<</span> <span class="token number">8</span><span class="token punctuation">;</span></pre><tr><td data-num=60><td><pre>	t3 <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xFF00</span><span class="token punctuation">;</span></pre><tr><td data-num=61><td><pre>	t4 <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">;</span></pre><tr><td data-num=62><td><pre>	<span class="token comment">//printf("%x\n",t1 + t2 + t3 + t4);</span></pre><tr><td data-num=63><td><pre>	<span class="token keyword">return</span> <span class="token punctuation">(</span>t1 <span class="token operator">+</span> t2 <span class="token operator">+</span> t3 <span class="token operator">+</span> t4<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=64><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=65><td><pre>	</pre><tr><td data-num=66><td><pre></pre><tr><td data-num=67><td><pre></pre><tr><td data-num=68><td><pre><span class="token comment">/* MD5 initialization */</span></pre><tr><td data-num=69><td><pre><span class="token keyword">void</span> <span class="token function">md5_init</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>A<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>B<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>C<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>D<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=70><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> data<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></pre><tr><td data-num=71><td><pre>		<span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span></pre><tr><td data-num=72><td><pre>		<span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0xAB</span><span class="token punctuation">,</span> <span class="token number">0xCD</span><span class="token punctuation">,</span> <span class="token number">0xEF</span><span class="token punctuation">,</span></pre><tr><td data-num=73><td><pre>		<span class="token number">0xFE</span><span class="token punctuation">,</span> <span class="token number">0xDC</span><span class="token punctuation">,</span> <span class="token number">0xBA</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span></pre><tr><td data-num=74><td><pre>		<span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x10</span></pre><tr><td data-num=75><td><pre>	<span class="token punctuation">}</span><span class="token punctuation">;</span></pre><tr><td data-num=76><td><pre></pre><tr><td data-num=77><td><pre>	<span class="token function">memcpy</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=78><td><pre>	<span class="token function">memcpy</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> data <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=79><td><pre>	<span class="token function">memcpy</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> data <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=80><td><pre>	<span class="token function">memcpy</span><span class="token punctuation">(</span>D<span class="token punctuation">,</span> data <span class="token operator">+</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=81><td><pre>	<span class="token keyword">return</span><span class="token punctuation">;</span></pre><tr><td data-num=82><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=83><td><pre></pre><tr><td data-num=84><td><pre>size_t <span class="token function">md5_update</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>out<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>input<span class="token punctuation">,</span> size_t inLen<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=85><td><pre>	<span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=86><td><pre>	<span class="token keyword">int</span> j<span class="token punctuation">;</span></pre><tr><td data-num=87><td><pre></pre><tr><td data-num=88><td><pre>	size_t bitLen <span class="token operator">=</span> inLen <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">// the bit length of input</span></pre><tr><td data-num=89><td><pre>	<span class="token comment">//size_t fillLen = 64 - (inLen - 56) % 64;  // the length of padding </span></pre><tr><td data-num=90><td><pre>	<span class="token comment">//printf("len:%d\n",fillLen);</span></pre><tr><td data-num=91><td><pre>	size_t fillLen <span class="token operator">=</span> <span class="token number">56</span> <span class="token operator">-</span> <span class="token punctuation">(</span>inLen <span class="token operator">%</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=92><td><pre>	<span class="token comment">//printf("temp:%d\n",temp);</span></pre><tr><td data-num=93><td><pre>	size_t filledLen <span class="token operator">=</span> inLen <span class="token operator">+</span> fillLen <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">// the length after padding</span></pre><tr><td data-num=94><td><pre></pre><tr><td data-num=95><td><pre>	<span class="token keyword">char</span> <span class="token operator">*</span>outBuf <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">calloc</span><span class="token punctuation">(</span>filledLen<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=96><td><pre>	<span class="token function">memcpy</span><span class="token punctuation">(</span>outBuf<span class="token punctuation">,</span> input<span class="token punctuation">,</span> inLen<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=97><td><pre>	outBuf<span class="token punctuation">[</span>inLen<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x80</span><span class="token punctuation">;</span><span class="token comment">// padding 1</span></pre><tr><td data-num=98><td><pre>	</pre><tr><td data-num=99><td><pre></pre><tr><td data-num=100><td><pre>	j <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>inLen<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// the length of input_lengh</span></pre><tr><td data-num=101><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> j<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre><tr><td data-num=102><td><pre>		<span class="token function">memcpy</span><span class="token punctuation">(</span>outBuf <span class="token operator">+</span> filledLen <span class="token operator">-</span> <span class="token number">8</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&</span>bitLen<span class="token punctuation">)</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// LittleEndian</span></pre><tr><td data-num=103><td><pre>		<span class="token comment">//memcpy(outBuf + filledLen - 4 + i, (char*)(&bitLen) + j - 1 - i, 1);</span></pre><tr><td data-num=104><td><pre>		</pre><tr><td data-num=105><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=106><td><pre></pre><tr><td data-num=107><td><pre>	<span class="token operator">*</span>out <span class="token operator">=</span> outBuf<span class="token punctuation">;</span>  <span class="token comment">// the data after padding</span></pre><tr><td data-num=108><td><pre>	<span class="token keyword">return</span> filledLen<span class="token punctuation">;</span> </pre><tr><td data-num=109><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=110><td><pre></pre><tr><td data-num=111><td><pre></pre><tr><td data-num=112><td><pre><span class="token keyword">void</span> <span class="token function">md5_transform</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>out<span class="token punctuation">,</span>  <span class="token keyword">char</span> <span class="token operator">*</span>input<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=113><td><pre>	<span class="token function">memcpy</span><span class="token punctuation">(</span>out<span class="token punctuation">,</span>input<span class="token punctuation">,</span>GROUP_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=114><td><pre>	<span class="token keyword">return</span><span class="token punctuation">;</span></pre><tr><td data-num=115><td><pre></pre><tr><td data-num=116><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=117><td><pre></pre><tr><td data-num=118><td><pre></pre><tr><td data-num=119><td><pre></pre><tr><td data-num=120><td><pre></pre><tr><td data-num=121><td><pre><span class="token keyword">void</span> <span class="token function">data_round</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>A<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>B<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>C<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>D<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token keyword">const</span> <span class="token operator">*</span>m<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=122><td><pre>	<span class="token comment">//int k;</span></pre><tr><td data-num=123><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token operator">*</span>A<span class="token punctuation">;</span></pre><tr><td data-num=124><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token operator">*</span>B<span class="token punctuation">;</span></pre><tr><td data-num=125><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token operator">*</span>C<span class="token punctuation">;</span></pre><tr><td data-num=126><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> d <span class="token operator">=</span> <span class="token operator">*</span>D<span class="token punctuation">;</span></pre><tr><td data-num=127><td><pre></pre><tr><td data-num=128><td><pre>	<span class="token comment">/* round 1 */</span></pre><tr><td data-num=129><td><pre>	<span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=130><td><pre>	<span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=131><td><pre>	<span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=132><td><pre>    <span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=133><td><pre>	<span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=134><td><pre>	<span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=135><td><pre>	<span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=136><td><pre>	<span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	</pre><tr><td data-num=137><td><pre>	<span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=138><td><pre>	<span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=139><td><pre>	<span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=140><td><pre>	<span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=141><td><pre>	<span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=142><td><pre>	<span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=143><td><pre>	<span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=144><td><pre>	<span class="token function">FF</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=145><td><pre>    </pre><tr><td data-num=146><td><pre>	<span class="token comment">/* round 2 */</span></pre><tr><td data-num=147><td><pre>    <span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=148><td><pre>    <span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=149><td><pre>	<span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=150><td><pre>	<span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=151><td><pre>	<span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=152><td><pre>	<span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=153><td><pre>	<span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=154><td><pre>	<span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=155><td><pre>	<span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=156><td><pre>	<span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=157><td><pre>	<span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=158><td><pre>	<span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=159><td><pre>	<span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=160><td><pre>	<span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=161><td><pre>	<span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=162><td><pre>	<span class="token function">GG</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=163><td><pre></pre><tr><td data-num=164><td><pre>    <span class="token comment">/* round 3 */</span></pre><tr><td data-num=165><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=166><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=167><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=168><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=169><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=170><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=171><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=172><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=173><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=174><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=175><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=176><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=177><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=178><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=179><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">46</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=180><td><pre> 	<span class="token function">HH</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=181><td><pre>  </pre><tr><td data-num=182><td><pre>	<span class="token comment">/* round 4 */</span></pre><tr><td data-num=183><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=184><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=185><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=186><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">51</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=187><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=188><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=189><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">54</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=190><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=191><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=192><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">57</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=193><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">58</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=194><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=195><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=196><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">61</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=197><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=198><td><pre>	<span class="token function">II</span><span class="token punctuation">(</span><span class="token operator">&</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>T<span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">]</span><span class="token punctuation">,</span>S<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=199><td><pre></pre><tr><td data-num=200><td><pre>	<span class="token operator">*</span>A <span class="token operator">+=</span> a<span class="token punctuation">;</span></pre><tr><td data-num=201><td><pre>	<span class="token operator">*</span>B <span class="token operator">+=</span> b<span class="token punctuation">;</span></pre><tr><td data-num=202><td><pre>	<span class="token operator">*</span>C <span class="token operator">+=</span> c<span class="token punctuation">;</span></pre><tr><td data-num=203><td><pre>	<span class="token operator">*</span>D <span class="token operator">+=</span> d<span class="token punctuation">;</span></pre><tr><td data-num=204><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=205><td><pre></pre><tr><td data-num=206><td><pre></pre><tr><td data-num=207><td><pre><span class="token keyword">void</span> <span class="token function">md5_calc</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>out<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>input<span class="token punctuation">,</span> size_t inLen<span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=208><td><pre>	<span class="token keyword">int</span> i<span class="token punctuation">;</span></pre><tr><td data-num=209><td><pre>    size_t filledLen<span class="token punctuation">;</span></pre><tr><td data-num=210><td><pre>	<span class="token keyword">char</span> <span class="token operator">*</span>filledData<span class="token punctuation">;</span> </pre><tr><td data-num=211><td><pre>	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> A<span class="token punctuation">,</span>B<span class="token punctuation">,</span>C<span class="token punctuation">,</span>D<span class="token punctuation">;</span></pre><tr><td data-num=212><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>M <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>GROUP_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=213><td><pre></pre><tr><td data-num=214><td><pre>	filledLen <span class="token operator">=</span> <span class="token function">md5_update</span><span class="token punctuation">(</span><span class="token operator">&</span>filledData<span class="token punctuation">,</span>input<span class="token punctuation">,</span>inLen<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre><tr><td data-num=215><td><pre></pre><tr><td data-num=216><td><pre>	<span class="token comment">//printf("input:%s\n",input);</span></pre><tr><td data-num=217><td><pre>    </pre><tr><td data-num=218><td><pre>    <span class="token function">md5_init</span><span class="token punctuation">(</span><span class="token operator">&</span>A<span class="token punctuation">,</span><span class="token operator">&</span>B<span class="token punctuation">,</span><span class="token operator">&</span>C<span class="token punctuation">,</span><span class="token operator">&</span>D<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=219><td><pre>    <span class="token comment">//printf("%x\n%x\n%x\n%x\n",A,B,C,D);</span></pre><tr><td data-num=220><td><pre></pre><tr><td data-num=221><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator"><</span> filledLen <span class="token operator">/</span> GROUP_SIZE<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span></pre><tr><td data-num=222><td><pre>		<span class="token function">md5_transform</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span> filledData <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//char to int </span></pre><tr><td data-num=223><td><pre>		<span class="token function">data_round</span><span class="token punctuation">(</span><span class="token operator">&</span>A<span class="token punctuation">,</span><span class="token operator">&</span>B<span class="token punctuation">,</span><span class="token operator">&</span>C<span class="token punctuation">,</span><span class="token operator">&</span>D<span class="token punctuation">,</span>M<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=224><td><pre>	<span class="token punctuation">}</span></pre><tr><td data-num=225><td><pre></pre><tr><td data-num=226><td><pre>	<span class="token comment">//printf("%x\n%x\n%x\n%x\n",A,B,C,D); </span></pre><tr><td data-num=227><td><pre></pre><tr><td data-num=228><td><pre>	<span class="token function">sprintf</span><span class="token punctuation">(</span>out<span class="token punctuation">,</span><span class="token string">"%08x%08x%08x%08x"</span><span class="token punctuation">,</span><span class="token function">shift</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">shift</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">shift</span><span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">shift</span><span class="token punctuation">(</span>D<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=229><td><pre></pre><tr><td data-num=230><td><pre>    <span class="token function">free</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=231><td><pre>	M <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></pre><tr><td data-num=232><td><pre>	<span class="token function">free</span><span class="token punctuation">(</span>filledData<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><tr><td data-num=233><td><pre>	filledData <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></pre><tr><td data-num=234><td><pre></pre><tr><td data-num=235><td><pre>	<span class="token keyword">return</span><span class="token punctuation">;</span></pre><tr><td data-num=236><td><pre></pre><tr><td data-num=237><td><pre><span class="token punctuation">}</span></pre></table></figure><h2 id=其他-2><a class=anchor href=#其他-2>#</a> 其他</h2><h3 id=大数计算><a class=anchor href=#大数计算>#</a> 大数计算</h3><h3 id=base系列><a class=anchor href=#base系列>#</a> base 系列</h3><h4 id=base64换表><a class=anchor href=#base64换表>#</a> base64 换表</h4><figure class="highlight python"><figcaption data-lang=python></figcaption><table><tr><td data-num=1><td><pre><span class="token triple-quoted-string string">"""</span></pre><tr><td data-num=2><td><pre>Customized base64 algorithm</pre><tr><td data-num=3><td><pre>You can set you own indexing string using the config() method.</pre><tr><td data-num=4><td><pre>Usage:</pre><tr><td data-num=5><td><pre>    b = CusBase64()</pre><tr><td data-num=6><td><pre>    b.encode('binary\x00string')  # Output: YmluYXJ5AHN0cmluZw==</pre><tr><td data-num=7><td><pre>    b.decode('YmluYXJ5AHN0cmluZw==') # Output: binary\x00string</pre><tr><td data-num=8><td><pre>    b.config('aABCDEFGHIJKLMNOPQRSTUVWXYZbcdefghijklmnopqrstuvwxyz0123456789+/')</pre><tr><td data-num=9><td><pre>    b.decode('c2UsYi1kYWM0cnUjdFlvbiAjb21wbFU0YP==') # Output: self-destruction complete</pre><tr><td data-num=10><td><pre>"""</pre><tr><td data-num=11><td><pre><span class="token keyword">class</span> <span class="token class-name">CusBase64</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=12><td><pre>    DEFAULT <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span></pre><tr><td data-num=13><td><pre></pre><tr><td data-num=14><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=15><td><pre>        self<span class="token punctuation">.</span>idx_str <span class="token operator">=</span> CusBase64<span class="token punctuation">.</span>DEFAULT</pre><tr><td data-num=16><td><pre></pre><tr><td data-num=17><td><pre>    <span class="token keyword">def</span> <span class="token function">encode</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=18><td><pre>        <span class="token triple-quoted-string string">"""</span></pre><tr><td data-num=19><td><pre>        Encode string using the customized indexing string.</pre><tr><td data-num=20><td><pre>        - args:</pre><tr><td data-num=21><td><pre>            str: String to be encoded</pre><tr><td data-num=22><td><pre>        """</pre><tr><td data-num=23><td><pre>        <span class="token comment"># Get the binary string</span></pre><tr><td data-num=24><td><pre>        binary <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'0>8b'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=25><td><pre>        <span class="token comment"># Add additional zero</span></pre><tr><td data-num=26><td><pre>        binary <span class="token operator">=</span> self<span class="token punctuation">.</span>padding<span class="token punctuation">(</span>binary<span class="token punctuation">)</span></pre><tr><td data-num=27><td><pre>        <span class="token comment"># Get the index in indexing string</span></pre><tr><td data-num=28><td><pre>        idxs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>binary<span class="token punctuation">[</span><span class="token number">6</span><span class="token operator">*</span>i<span class="token punctuation">:</span><span class="token number">6</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>binary<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=29><td><pre></pre><tr><td data-num=30><td><pre>        result <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>self<span class="token punctuation">.</span>idx_str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> idxs<span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=31><td><pre>        <span class="token comment"># add '='</span></pre><tr><td data-num=32><td><pre>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">3</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span></pre><tr><td data-num=33><td><pre>            result <span class="token operator">=</span> result <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token string">'='</span></pre><tr><td data-num=34><td><pre></pre><tr><td data-num=35><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"%r"</span> <span class="token operator">%</span> result<span class="token punctuation">)</span></pre><tr><td data-num=36><td><pre></pre><tr><td data-num=37><td><pre></pre><tr><td data-num=38><td><pre>    <span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=39><td><pre>        <span class="token triple-quoted-string string">"""</span></pre><tr><td data-num=40><td><pre>        Decode string using the customized indexing string.</pre><tr><td data-num=41><td><pre>        - args:</pre><tr><td data-num=42><td><pre>            str: String to be decoded</pre><tr><td data-num=43><td><pre>        """</pre><tr><td data-num=44><td><pre>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></pre><tr><td data-num=45><td><pre>            <span class="token keyword">return</span></pre><tr><td data-num=46><td><pre></pre><tr><td data-num=47><td><pre>        <span class="token comment"># remove '='</span></pre><tr><td data-num=48><td><pre>        <span class="token keyword">while</span> <span class="token builtin">str</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'='</span><span class="token punctuation">:</span></pre><tr><td data-num=49><td><pre>            <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></pre><tr><td data-num=50><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre><tr><td data-num=51><td><pre>            <span class="token comment"># Get the binary string</span></pre><tr><td data-num=52><td><pre>            binary <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>idx_str<span class="token punctuation">.</span>index<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'0>6b'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=53><td><pre></pre><tr><td data-num=54><td><pre>            <span class="token comment"># Remove additional zero</span></pre><tr><td data-num=55><td><pre>            binary <span class="token operator">=</span> self<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>binary<span class="token punctuation">)</span></pre><tr><td data-num=56><td><pre></pre><tr><td data-num=57><td><pre>            result <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>binary<span class="token punctuation">[</span><span class="token number">8</span><span class="token operator">*</span>i<span class="token punctuation">:</span><span class="token number">8</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>binary<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=58><td><pre>        <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span></pre><tr><td data-num=59><td><pre>            result <span class="token operator">=</span> <span class="token string">"Please check again!"</span></pre><tr><td data-num=60><td><pre></pre><tr><td data-num=61><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"%r"</span> <span class="token operator">%</span> result<span class="token punctuation">)</span></pre><tr><td data-num=62><td><pre></pre><tr><td data-num=63><td><pre>    <span class="token keyword">def</span> <span class="token function">remove</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> binary<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=64><td><pre>        <span class="token triple-quoted-string string">"""</span></pre><tr><td data-num=65><td><pre>        Remove additional zero while decoding string.</pre><tr><td data-num=66><td><pre>        - args:</pre><tr><td data-num=67><td><pre>            binary: Binary format of the index.</pre><tr><td data-num=68><td><pre>        - returns:</pre><tr><td data-num=69><td><pre>            Binary string without additional zero.</pre><tr><td data-num=70><td><pre>        """</pre><tr><td data-num=71><td><pre>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>binary<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">8</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></pre><tr><td data-num=72><td><pre>            <span class="token keyword">return</span> binary</pre><tr><td data-num=73><td><pre>        <span class="token keyword">else</span><span class="token punctuation">:</span></pre><tr><td data-num=74><td><pre>            <span class="token keyword">return</span> binary<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>binary<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre><tr><td data-num=75><td><pre></pre><tr><td data-num=76><td><pre>    <span class="token keyword">def</span> <span class="token function">padding</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> binary<span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=77><td><pre>        <span class="token triple-quoted-string string">"""</span></pre><tr><td data-num=78><td><pre>        Add additional zero while encoding string.</pre><tr><td data-num=79><td><pre>        - args:</pre><tr><td data-num=80><td><pre>            binary: Binary format of the string.</pre><tr><td data-num=81><td><pre>        - returns:</pre><tr><td data-num=82><td><pre>            Binary string with additional zero.</pre><tr><td data-num=83><td><pre>        """</pre><tr><td data-num=84><td><pre>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>binary<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">6</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></pre><tr><td data-num=85><td><pre>            <span class="token keyword">return</span> binary</pre><tr><td data-num=86><td><pre>        n <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>binary<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">6</span></pre><tr><td data-num=87><td><pre>        binary <span class="token operator">=</span> binary <span class="token operator">+</span> n <span class="token operator">*</span> <span class="token string">'0'</span></pre><tr><td data-num=88><td><pre>        <span class="token keyword">return</span> binary</pre><tr><td data-num=89><td><pre></pre><tr><td data-num=90><td><pre></pre><tr><td data-num=91><td><pre>    <span class="token keyword">def</span> <span class="token function">config</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre><tr><td data-num=92><td><pre>        <span class="token triple-quoted-string string">"""</span></pre><tr><td data-num=93><td><pre>        Set customized indexing string.</pre><tr><td data-num=94><td><pre>        """</pre><tr><td data-num=95><td><pre>        self<span class="token punctuation">.</span>idx_str <span class="token operator">=</span> <span class="token builtin">str</span></pre><tr><td data-num=96><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"New indexing string is %r"</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>idx_str<span class="token punctuation">)</span></pre><tr><td data-num=97><td><pre></pre><tr><td data-num=98><td><pre>b <span class="token operator">=</span> CusBase64<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=99><td><pre>b<span class="token punctuation">.</span>config<span class="token punctuation">(</span><span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span><span class="token punctuation">)</span></pre><tr><td data-num=100><td><pre>b<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'flag{this_is_a_sample_flag}'</span><span class="token punctuation">)</span></pre><tr><td data-num=101><td><pre>b<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'mg6CITV6GEaFDTYnObFmENOAVjKcQmGncF90WhqvCFyhhsyqq1s='</span><span class="token punctuation">)</span></pre></table></figure><h4 id=base58><a class=anchor href=#base58>#</a> base58</h4><figure class="highlight go"><figcaption data-lang=go></figcaption><table><tr><td data-num=1><td><pre><span class="token keyword">package</span> main</pre><tr><td data-num=2><td><pre></pre><tr><td data-num=3><td><pre><span class="token keyword">import</span> <span class="token punctuation">(</span></pre><tr><td data-num=4><td><pre>    <span class="token string">"bytes"</span></pre><tr><td data-num=5><td><pre>    <span class="token string">"math/big"</span></pre><tr><td data-num=6><td><pre><span class="token punctuation">)</span></pre><tr><td data-num=7><td><pre></pre><tr><td data-num=8><td><pre><span class="token keyword">var</span> b58Alphabet <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"</span><span class="token punctuation">)</span></pre><tr><td data-num=9><td><pre></pre><tr><td data-num=10><td><pre><span class="token keyword">func</span> <span class="token function">Base58Encode</span><span class="token punctuation">(</span>input <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span> <span class="token punctuation">{</span></pre><tr><td data-num=11><td><pre>    <span class="token keyword">var</span> result <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span></pre><tr><td data-num=12><td><pre></pre><tr><td data-num=13><td><pre>    x <span class="token operator">:=</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetBytes</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span></pre><tr><td data-num=14><td><pre></pre><tr><td data-num=15><td><pre>    base <span class="token operator">:=</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span><span class="token function">int64</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>b58Alphabet<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=16><td><pre>    zero <span class="token operator">:=</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></pre><tr><td data-num=17><td><pre>    mod <span class="token operator">:=</span> <span class="token operator">&</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">{</span><span class="token punctuation">}</span></pre><tr><td data-num=18><td><pre></pre><tr><td data-num=19><td><pre>    <span class="token keyword">for</span> x<span class="token punctuation">.</span><span class="token function">Cmp</span><span class="token punctuation">(</span>zero<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">{</span></pre><tr><td data-num=20><td><pre>        x<span class="token punctuation">.</span><span class="token function">DivMod</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> base<span class="token punctuation">,</span> mod<span class="token punctuation">)</span></pre><tr><td data-num=21><td><pre>        result <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> b58Alphabet<span class="token punctuation">[</span>mod<span class="token punctuation">.</span><span class="token function">Int64</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre><tr><td data-num=22><td><pre>    <span class="token punctuation">}</span></pre><tr><td data-num=23><td><pre></pre><tr><td data-num=24><td><pre>    <span class="token function">ReverseBytes</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span></pre><tr><td data-num=25><td><pre></pre><tr><td data-num=26><td><pre>    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> b <span class="token operator">:=</span> <span class="token keyword">range</span> input <span class="token punctuation">{</span></pre><tr><td data-num=27><td><pre>        <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0x00</span> <span class="token punctuation">{</span></pre><tr><td data-num=28><td><pre>            result <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">{</span>b58Alphabet<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> result<span class="token operator">...</span><span class="token punctuation">)</span></pre><tr><td data-num=29><td><pre></pre><tr><td data-num=30><td><pre>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></pre><tr><td data-num=31><td><pre>            <span class="token keyword">break</span></pre><tr><td data-num=32><td><pre>        <span class="token punctuation">}</span></pre><tr><td data-num=33><td><pre>    <span class="token punctuation">}</span></pre><tr><td data-num=34><td><pre></pre><tr><td data-num=35><td><pre>    <span class="token keyword">return</span> result</pre><tr><td data-num=36><td><pre></pre><tr><td data-num=37><td><pre><span class="token punctuation">}</span></pre><tr><td data-num=38><td><pre></pre><tr><td data-num=39><td><pre><span class="token keyword">func</span> <span class="token function">Base58Decode</span><span class="token punctuation">(</span>input <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span> <span class="token punctuation">{</span></pre><tr><td data-num=40><td><pre>    result <span class="token operator">:=</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></pre><tr><td data-num=41><td><pre>    zeroBytes <span class="token operator">:=</span> <span class="token number">0</span></pre><tr><td data-num=42><td><pre></pre><tr><td data-num=43><td><pre>    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> b <span class="token operator">:=</span> <span class="token keyword">range</span> input <span class="token punctuation">{</span></pre><tr><td data-num=44><td><pre>        <span class="token keyword">if</span> b <span class="token operator">!=</span> b58Alphabet<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">{</span></pre><tr><td data-num=45><td><pre>            <span class="token keyword">break</span></pre><tr><td data-num=46><td><pre>        <span class="token punctuation">}</span></pre><tr><td data-num=47><td><pre></pre><tr><td data-num=48><td><pre>        zeroBytes<span class="token operator">++</span></pre><tr><td data-num=49><td><pre>    <span class="token punctuation">}</span></pre><tr><td data-num=50><td><pre></pre><tr><td data-num=51><td><pre>    payload <span class="token operator">:=</span> input<span class="token punctuation">[</span>zeroBytes<span class="token punctuation">:</span><span class="token punctuation">]</span></pre><tr><td data-num=52><td><pre>    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> b <span class="token operator">:=</span> <span class="token keyword">range</span> payload <span class="token punctuation">{</span></pre><tr><td data-num=53><td><pre>        charIndex <span class="token operator">:=</span> bytes<span class="token punctuation">.</span><span class="token function">IndexByte</span><span class="token punctuation">(</span>b58Alphabet<span class="token punctuation">,</span> b<span class="token punctuation">)</span></pre><tr><td data-num=54><td><pre>        result<span class="token punctuation">.</span><span class="token function">Mul</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span><span class="token function">int64</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>b58Alphabet<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=55><td><pre>        result<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span><span class="token function">int64</span><span class="token punctuation">(</span>charIndex<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><tr><td data-num=56><td><pre>    <span class="token punctuation">}</span></pre><tr><td data-num=57><td><pre></pre><tr><td data-num=58><td><pre>    decoded <span class="token operator">:=</span> result<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre><tr><td data-num=59><td><pre>    decoded <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>bytes<span class="token punctuation">.</span><span class="token function">Repeat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">{</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token number">0x00</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> zeroBytes<span class="token punctuation">)</span><span class="token punctuation">,</span> decoded<span class="token operator">...</span><span class="token punctuation">)</span></pre><tr><td data-num=60><td><pre></pre><tr><td data-num=61><td><pre>    <span class="token keyword">return</span> decoded</pre><tr><td data-num=62><td><pre><span class="token punctuation">}</span></pre></table></figure><div class=tags><a href=/tags/re/ rel=tag><i class="ic i-tag"></i>re</a></div></div><footer><div class=meta><span class=item><span class=icon><i class="ic i-calendar-check"></i></span><span class=text>Edited on</span><time title="Modified: 2024-05-05 09:59:47" datetime=2024-05-05T09:59:47+08:00 itemprop=dateModified>2024-05-05</time></span></div><div class=reward><button><i class="ic i-heartbeat"></i>Donate</button><p>Give me a cup of [coffee]~(￣▽￣)~*<div id=qr><div><img alt="Moyao WeChat Pay" data-src=/assets/wechatpay.png loading=lazy><p>WeChat Pay</div><div><img alt="Moyao Alipay" data-src=/assets/alipay.png loading=lazy><p>Alipay</div></div></div><div id=copyright><ul><li class=author><strong>Post author: </strong>Moyao<i class="ic i-at"><em>@</em></i>rev@天枢<li class=link><strong>Post link: </strong><a href=https://demoyao100.github.io/2023/11/08/%E5%B8%B8%E8%A7%81%E9%80%86%E5%90%91%E5%8A%A0%E8%A7%A3%E5%AF%86%E6%95%B4%E5%90%88/ title=常见逆向加解密整合>https://demoyao100.github.io/2023/11/08/常见逆向加解密整合/</a><li class=license><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh rel=noopener target=_blank><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> unless stating additionally.</ul></div></footer></article></div><div class=post-nav><div class="item left"><a data-background-image=https://tva4.sinaimg.cn/mw690/6833939bly1gicis081o9j20zk0m8dmr.jpg href=/2023/10/25/das202310/ itemprop=url rel=prev title=das202310><span class=type>Previous Post</span><h3>das202310</h3></a></div><div class="item right"><a data-background-image=https://tva4.sinaimg.cn/mw690/6833939bly1giciryrr3rj20zk0m8nhk.jpg href=/2023/11/08/ACTF2023/ itemprop=url rel=next title=ACTF2023><span class=type>Next Post</span><h3>ACTF2023</h3></a></div></div></div><div id=sidebar><div class=inner><div class=panels><div class=inner><div class="contents panel pjax" data-title=Contents><ol class=toc><li class="toc-item toc-level-6"><a class=toc-link href=#preface%E5%B0%8F%E5%81%9A%E4%B8%80%E7%82%B9%E6%95%B4%E7%90%86><span class=toc-number>1.</span> <span class=toc-text> preface：小做一点整理</span></a></ol><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%B5%81%E5%AF%86%E7%A0%81><span class=toc-number></span> <span class=toc-text> 流密码</span></a><ol class=toc-child><li class="toc-item toc-level-4"><a class=toc-link href=#rc4><span class=toc-number></span> <span class=toc-text> RC4</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#salsa20><span class=toc-number></span> <span class=toc-text> Salsa20</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#chacha20><span class=toc-number></span> <span class=toc-text> chacha20</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#zuc><span class=toc-number></span> <span class=toc-text> ZUC</span></a></ol><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%88%86%E7%BB%84><span class=toc-number></span> <span class=toc-text> 分组</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#tea><span class=toc-number></span> <span class=toc-text> TEA</span></a><ol class=toc-child><li class="toc-item toc-level-4"><a class=toc-link href=#tea-2><span class=toc-number></span> <span class=toc-text> TEA</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#xtea><span class=toc-number></span> <span class=toc-text> XTEA</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#xxtea><span class=toc-number></span> <span class=toc-text> XXTEA</span></a></ol><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%85%B6%E4%BB%96><span class=toc-number></span> <span class=toc-text> 其他</span></a><ol class=toc-child><li class="toc-item toc-level-4"><a class=toc-link href=#des><span class=toc-number></span> <span class=toc-text> DES</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#aes><span class=toc-number></span> <span class=toc-text> AES</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#rc5><span class=toc-number></span> <span class=toc-text> RC5</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#rc6><span class=toc-number></span> <span class=toc-text> RC6</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#sm4><span class=toc-number></span> <span class=toc-text> SM4</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#blowfish><span class=toc-number></span> <span class=toc-text> Blowfish</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#twofish><span class=toc-number></span> <span class=toc-text> Twofish</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#serpent><span class=toc-number></span> <span class=toc-text> Serpent</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#present><span class=toc-number></span> <span class=toc-text> PRESENT</span></a></ol></ol><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%A0%A1%E9%AA%8C><span class=toc-number></span> <span class=toc-text> 校验</span></a><ol class=toc-child><li class="toc-item toc-level-4"><a class=toc-link href=#sha%E7%B3%BB%E5%88%97><span class=toc-number></span> <span class=toc-text> sha 系列</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#crc32><span class=toc-number></span> <span class=toc-text> CRC32</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#md5><span class=toc-number></span> <span class=toc-text> md5</span></a></ol><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%85%B6%E4%BB%96-2><span class=toc-number></span> <span class=toc-text> 其他</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%A4%A7%E6%95%B0%E8%AE%A1%E7%AE%97><span class=toc-number></span> <span class=toc-text> 大数计算</span></a><li class="toc-item toc-level-3"><a class=toc-link href=#base%E7%B3%BB%E5%88%97><span class=toc-number></span> <span class=toc-text> base 系列</span></a><ol class=toc-child><li class="toc-item toc-level-4"><a class=toc-link href=#base64%E6%8D%A2%E8%A1%A8><span class=toc-number></span> <span class=toc-text> base64 换表</span></a><li class="toc-item toc-level-4"><a class=toc-link href=#base58><span class=toc-number></span> <span class=toc-text> base58</span></a><div class="related panel pjax" data-title=Related></div><div class="overview panel" data-title=Overview><div class=author itemprop=author itemscope itemtype=http://schema.org/Person><img alt=Moyao class=image data-src=/assets/avatar.jpg itemprop=image loading=lazy><p class=name itemprop=name>Moyao<div class=description itemprop=description>Write down something interesting I met<br> Feel free to mail me if you have something wanted to talk about, plz mail: &LTmoyaoxue@outlook.com></div></div><nav class=state><div class="item posts"><a href=/archives/><span class=count>74</span><span class=name>posts</span></a></div><div class="item tags"><a href=/tags/><span class=count>14</span><span class=name>tags</span></a></div></nav><div class=social><a class="item github" href=https://github.com/name rel=noopener target=_blank title=https://github.com/name><i class="ic i-github"></i></a></div><div class=menu><li class=item><a href=/ rel=section><i class="ic i-home"></i>Home</a></div></div><ul id=quick><li class="prev pjax"><a title="Previous Post" href=/2023/11/08/ACTF2023/ rel=prev><i class="ic i-chevron-left"></i></a><li class=up><i class="ic i-arrow-up"></i><li class=down><i class="ic i-arrow-down"></i><li class="next pjax"><a title="Next Post" href=/2023/10/25/das202310/ rel=next><i class="ic i-chevron-right"></i></a><li class=percent></ul><div class=dimmer></div><footer id=footer><div class=inner><div class=widgets><div class="rpost pjax"><h2>Random Posts</h2><ul><li class=item><div class=breadcrumb></div><span><a href=/2023/10/12/idapython%E5%88%9D%E6%8E%A2/>idapython初探</a></span><li class=item><div class=breadcrumb></div><span><a href=/2023/11/26/laurelAndYanny/>laurelAndYanny</a></span><li class=item><div class=breadcrumb></div><span><a href=/2023/08/26/%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E4%BB%A5%E5%8F%8A%E5%85%B6%E4%BB%96%E6%9E%B6%E6%9E%84%E9%80%86%E5%90%91%E5%88%9D%E6%8E%A2/>交叉编译以及其他架构逆向初探</a></span><li class=item><div class=breadcrumb></div><span><a href=/2023/10/01/mapleCTF2023/>mapleCTF2023</a></span><li class=item><div class=breadcrumb></div><span><a href=/2023/11/13/%E3%80%8A%E8%A2%AB%E8%AE%A8%E5%8E%8C%E7%9A%84%E5%8B%87%E6%B0%94%E3%80%8B/>《被讨厌的勇气》</a></span><li class=item><div class=breadcrumb></div><span><a href=/2022/09/25/Changes-of-Python-API-in-IDA/>Changes of Python API in IDA</a></span><li class=item><div class=breadcrumb></div><span><a href=/2023/08/23/%E5%88%9D%E6%8E%A2flutter/>初探flutter</a></span><li class=item><div class=breadcrumb></div><span><a href=/2023/09/13/%E9%95%BF%E5%9F%8E%E6%9D%AF2023/>长城杯2023</a></span><li class=item><div class=breadcrumb></div><span><a href=/2022/08/27/arknights-recruit-calculator/>arknights recruit calculator(1)</a></span><li class=item><div class=breadcrumb></div><span><a href=/2023/11/09/gdb-python%E5%88%9D%E6%8E%A2/>gdb_python初探</a></span></ul></div><div class="rpost pjax"><h2>Recent Comments</h2><ul class=leancloud-recent-comment id=new-comment></ul></div></div><div class=status><div class=copyright>© 2022 -<span itemprop=copyrightYear>2024</span><span class=with-love><i class="ic i-sakura rotate"></i></span><span class=author itemprop=copyrightHolder>Moyao @ Moyao の小屋</span></div><div class=count><span class=post-meta-item-icon><i class="ic i-chart-area"></i></span><span title="Symbols count total">649k words</span><span class=post-meta-divider>|</span><span class=post-meta-item-icon><i class="ic i-coffee"></i></span><span title="Reading time total">9:50</span></div><div class=powered-by>Powered by <a href=https://hexo.io/ rel=noopener target=_blank>Hexo</a> & Theme.<a href=https://github.com/theme-shoka-x/hexo-theme-shokaX/ rel=noopener target=_blank>ShokaX</a></div></div></div></footer><script data-config>var LOCAL = {
        path: `2023/11/08/常见逆向加解密整合/`,
        favicon: {
        show: `(●´3｀●) Here we go again.`,
        hide: `(´Д｀) It's a disaster!`
    },
    search: {
        placeholder: "Search for Posts",
        empty: "We didn't find any results for the search: ${query}",
        stats: "${hits} results found in ${time} ms"
    },
    copy_tex: false,
    katex: false,
    mermaid: false,
    audio: undefined,
    fancybox: true,
    nocopy: false,
    outime: true,
    template: `<div class="note warning"><p><span class="label warning">Article Timeliness Alert</span><br>This is an article published {{publish}} days ago and last updated {{updated}} days ago. Some information may have changed, so please be careful to screen it.</p></div>`,
    quiz: {
        choice: `Multiple Choice`,
        multiple: `Multiple Answer`,
        true_false: `True/False`,
        essay: `Questions`,
        gap_fill: `Gap Filling`,
        mistake: `Wrong Answer`
    },
    ignores: [
        (uri) => uri.includes('#'),
        (uri) => new RegExp(LOCAL.path + '$').test(uri),
            []
    ]
};</script><script src=https://cdn.bootcdn.net/ajax/libs/vue/3.3.4/vue.global.prod.min.js></script><script src=https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/pace/1.2.4/pace.min.js></script><script src=https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/algoliasearch/4.12.1/algoliasearch-lite.umd.min.js></script><script src=https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/instantsearch.js/4.39.0/instantsearch.production.min.js></script><script src=https://npm.webcache.cn/quicklink@2.3.0/dist/quicklink.umd.js></script><script src=/js/app.js?v=0.3.15></script>